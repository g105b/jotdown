;(function(undefined) {

var
	wysihtml5,
	wysihtml5ParserRules,
$$;

function init() {
	wysihtml5 = init_wysihtml();
	init_parser();
	init_jotdown();
}

function init_jotdown() {
	var
		el = document.getElementById("editor"),
		html = el.innerHTML,
		editor = new wysihtml5.Editor("editor", {
			"toolbar": "toolbar",
			"parserRules": wysihtml5ParserRules,
			"parser": wysihtml5.dom.parse,
			"useLineBreaks": false,
			"contentEditableMode": true,
		}),
	$$;

	editor.on("load", function() {
		this.editableElement.innerHTML = html;
	});
}

function init_parser() {
	var wysihtml5ParserRulesDefaults={blockLevelEl:{keep_styles:{textAlign:/^((left)|(right)|(center)|(justify))$/i,"float":1},add_style:{align:"align_text"},check_attributes:{id:"any"}},makeDiv:{rename_tag:"div",one_of_type:{alignment_object:1},remove_action:"unwrap",keep_styles:{textAlign:1,"float":1},add_style:{align:"align_text"},check_attributes:{id:"any"}}},wysihtml5ParserRules={classes:"any",classes_blacklist:{"Apple-interchange-newline":1,MsoNormal:1,MsoPlainText:1},type_definitions:{alignment_object:{classes:{"wysiwyg-text-align-center":1,
		"wysiwyg-text-align-justify":1,"wysiwyg-text-align-left":1,"wysiwyg-text-align-right":1,"wysiwyg-float-left":1,"wysiwyg-float-right":1},styles:{"float":["left","right"],"text-align":["left","right","center"]}},valid_image_src:{attrs:{src:/^[^data\:]/i}},text_color_object:{styles:{color:!0,"background-color":!0}},text_fontsize_object:{styles:{"font-size":!0}},text_formatting_object:{classes:{"wysiwyg-color-aqua":1,"wysiwyg-color-black":1,"wysiwyg-color-blue":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-gray":1,
		"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-maroon":1,"wysiwyg-color-navy":1,"wysiwyg-color-olive":1,"wysiwyg-color-purple":1,"wysiwyg-color-red":1,"wysiwyg-color-silver":1,"wysiwyg-color-teal":1,"wysiwyg-color-white":1,"wysiwyg-color-yellow":1,"wysiwyg-font-size-large":1,"wysiwyg-font-size-larger":1,"wysiwyg-font-size-medium":1,"wysiwyg-font-size-small":1,"wysiwyg-font-size-smaller":1,"wysiwyg-font-size-x-large":1,"wysiwyg-font-size-x-small":1,"wysiwyg-font-size-xx-large":1,"wysiwyg-font-size-xx-small":1}}},
		comments:1,tags:{tr:{add_style:{align:"align_text"},check_attributes:{id:"any"}},strike:{unwrap:1},form:{unwrap:1},rt:{rename_tag:"span"},code:{},acronym:{rename_tag:"span"},br:{add_class:{clear:"clear_br"}},details:{unwrap:1},h4:wysihtml5ParserRulesDefaults.blockLevelEl,em:{},title:{remove:1},multicol:{unwrap:1},figure:{unwrap:1},xmp:{unwrap:1},small:{rename_tag:"span",set_class:"wysiwyg-font-size-smaller"},area:{remove:1},time:{unwrap:1},dir:{rename_tag:"ul"},bdi:{unwrap:1},command:{unwrap:1},ul:{check_attributes:{id:"any"}},
			progress:{rename_tag:"span"},dfn:{unwrap:1},iframe:{check_attributes:{src:"any",width:"any",height:"any",frameborder:"any",style:"any",id:"any"}},figcaption:{unwrap:1},a:{check_attributes:{href:"href",rel:"any",target:"any",id:"any"}},img:{one_of_type:{valid_image_src:1},check_attributes:{width:"numbers",alt:"alt",src:"src",height:"numbers",id:"any"},add_class:{align:"align_img"}},rb:{unwrap:1},footer:wysihtml5ParserRulesDefaults.makeDiv,noframes:{remove:1},abbr:{unwrap:1},u:{},bgsound:{remove:1},
			sup:{unwrap:1},address:{unwrap:1},basefont:{remove:1},nav:{unwrap:1},h1:wysihtml5ParserRulesDefaults.blockLevelEl,head:{unwrap:1},tbody:wysihtml5ParserRulesDefaults.blockLevelEl,dd:{unwrap:1},s:{unwrap:1},li:{},td:{check_attributes:{rowspan:"numbers",colspan:"numbers",valign:"any",align:"any",id:"any","class":"any"},keep_styles:{backgroundColor:1,width:1,height:1},add_style:{align:"align_text"}},object:{remove:1},div:{one_of_type:{alignment_object:1},remove_action:"unwrap",keep_styles:{textAlign:1,
				"float":1},add_style:{align:"align_text"},check_attributes:{id:"any",contenteditable:"any"}},option:{remove:1},select:{remove:1},i:{},track:{remove:1},wbr:{remove:1},fieldset:{unwrap:1},big:{rename_tag:"span",set_class:"wysiwyg-font-size-larger"},button:{unwrap:1},noscript:{remove:1},svg:{remove:1},input:{remove:1},table:{keep_styles:{width:1,textAlign:1,"float":1},check_attributes:{id:"any"}},keygen:{remove:1},h5:wysihtml5ParserRulesDefaults.blockLevelEl,meta:{remove:1},map:{remove:1},isindex:{remove:1},
			mark:{unwrap:1},caption:wysihtml5ParserRulesDefaults.blockLevelEl,tfoot:wysihtml5ParserRulesDefaults.blockLevelEl,base:{remove:1},video:{remove:1},strong:{},canvas:{remove:1},output:{unwrap:1},marquee:{unwrap:1},b:{},q:{check_attributes:{cite:"url",id:"any"}},applet:{remove:1},span:{one_of_type:{text_formatting_object:1,text_color_object:1,text_fontsize_object:1},keep_styles:{color:1,backgroundColor:1,fontSize:1},remove_action:"unwrap",check_attributes:{id:"any"}},rp:{unwrap:1},spacer:{remove:1},
			source:{remove:1},aside:wysihtml5ParserRulesDefaults.makeDiv,frame:{remove:1},section:wysihtml5ParserRulesDefaults.makeDiv,body:{unwrap:1},ol:{},nobr:{unwrap:1},html:{unwrap:1},summary:{unwrap:1},"var":{unwrap:1},del:{unwrap:1},blockquote:{keep_styles:{textAlign:1,"float":1},add_style:{align:"align_text"},check_attributes:{cite:"url",id:"any"}},style:{check_attributes:{type:"any",src:"any",charset:"any"}},device:{remove:1},meter:{unwrap:1},h3:wysihtml5ParserRulesDefaults.blockLevelEl,textarea:{unwrap:1},
			embed:{remove:1},hgroup:{unwrap:1},font:{rename_tag:"span",add_class:{size:"size_font"}},tt:{unwrap:1},noembed:{remove:1},thead:{add_style:{align:"align_text"},check_attributes:{id:"any"}},blink:{unwrap:1},plaintext:{unwrap:1},xml:{remove:1},h6:wysihtml5ParserRulesDefaults.blockLevelEl,param:{remove:1},th:{check_attributes:{rowspan:"numbers",colspan:"numbers",valign:"any",align:"any",id:"any"},keep_styles:{backgroundColor:1,width:1,height:1},add_style:{align:"align_text"}},legend:{unwrap:1},hr:{},
			label:{unwrap:1},dl:{unwrap:1},kbd:{unwrap:1},listing:{unwrap:1},dt:{unwrap:1},nextid:{remove:1},pre:{},center:wysihtml5ParserRulesDefaults.makeDiv,audio:{remove:1},datalist:{unwrap:1},samp:{unwrap:1},col:{remove:1},article:wysihtml5ParserRulesDefaults.makeDiv,cite:{},link:{remove:1},script:{check_attributes:{type:"any",src:"any",charset:"any"}},bdo:{unwrap:1},menu:{rename_tag:"ul"},colgroup:{remove:1},ruby:{unwrap:1},h2:wysihtml5ParserRulesDefaults.blockLevelEl,ins:{unwrap:1},p:wysihtml5ParserRulesDefaults.blockLevelEl,
			sub:{unwrap:1},comment:{remove:1},frameset:{remove:1},optgroup:{unwrap:1},header:wysihtml5ParserRulesDefaults.makeDiv}};
	(function(){var a=wysihtml5.lang.object(wysihtml5ParserRules).clone(!0);a.comments=!1;a.selectors={"a u":"unwrap"};a.tags.style={remove:1};a.tags.script={remove:1};a.tags.head={remove:1};var b=wysihtml5.lang.object(a).clone(!0);b.tags.div.one_of_type.alignment_object=1;b.tags.div.remove_action="unwrap";b.tags.div.check_attributes.style=!1;b.tags.div.keep_styles={textAlign:/^((left)|(right)|(center)|(justify))$/i,"float":1};b.tags.span.keep_styles=!1;var c=wysihtml5.lang.object(b).clone(!0);c.classes=
	{};window.wysihtml5ParserPasteRulesets=[{condition:/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument|class="OutlineElement|id="?docs\-internal\-guid\-/i,set:c},{condition:/<meta name="copied-from" content="wysihtml5">/i,set:a},{set:b}]})();

	return wysihtml5ParserRules;
}

function init_wysihtml() {
	/*
	 wysihtml v0.5.0-beta12
	 https://github.com/Voog/wysihtml

	 Author: Christopher Blum (https://github.com/tiff)
	 Secondary author of extended features: Oliver Pulges (https://github.com/pulges)

	 Copyright (C) 2012 XING AG
	 Licensed under the MIT license (MIT)

	 */
	var wysihtml5={version:"0.5.0-beta12",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\ufeff",INVISIBLE_SPACE_REG_EXP:/\uFEFF/g,EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,TAB_KEY:9,DELETE_KEY:46,polyfills:function(a,f){String.prototype.trim||function(){var d=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(d,"")}}();(function(){f.addEventListener||(a.Element.prototype.addEventListener=
		a.addEventListener=f.addEventListener=function(d,f,b){return(b=this).attachEvent("on"+d,function(e){e=e||a.event;e.target=e.target||e.srcElement;e.preventDefault=e.preventDefault||function(){e.returnValue=!1};e.stopPropagation=e.stopPropagation||function(){e.cancelBubble=!0};e.which=e.button?2===e.button?3:4===e.button?2:e.button:e.keyCode;f.call(b,e)})},a.Element.prototype.removeEventListener=a.removeEventListener=f.removeEventListener=function(d,a){return this.detachEvent("on"+d,a)})})();Object.defineProperty&&
	Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(a.Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(a.Element.prototype,"textContent").get&&function(){var d=Object.getOwnPropertyDescriptor(a.Element.prototype,"innerText");Object.defineProperty(a.Element.prototype,"textContent",{get:function(){return d.get.call(this)},set:function(a){return d.set.call(this,a)}})}();Array.isArray||(Array.isArray=function(d){return"[object Array]"===Object.prototype.toString.call(d)});
		Array.prototype.indexOf||(Array.prototype.indexOf=function(d,a){for(var b=this.length,e=-1,f=a>>>0;~(b-f);e=this[--b]===d?b:e);return e});Function.prototype.bind||(Function.prototype.bind=function(d){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var a=Array.prototype.slice.call(arguments,1),b=this,e=function(){},f=function(){return b.apply(this instanceof e&&d?this:d,a.concat(Array.prototype.slice.call(arguments)))};e.prototype=
			this.prototype;f.prototype=new e;return f});a.Element&&function(d){d.matches=d.matches||d.matchesSelector||d.mozMatchesSelector||d.msMatchesSelector||d.oMatchesSelector||d.webkitMatchesSelector||function(d){d=(this.parentNode||this.document).querySelectorAll(d);for(var a=-1;d[++a]&&d[a]!=this;);return!!d[a]}}(a.Element.prototype);"document"in a&&("classList"in f.createElement("_")?"DOMTokenList"in a&&function(){var d=f.createElement("_");d.classList.add("c1","c2");if(!d.classList.contains("c2")){var b=
			function(d){var b=a.DOMTokenList.prototype[d];a.DOMTokenList.prototype[d]=function(d){var e,a=arguments.length;for(e=0;e<a;e++)d=arguments[e],b.call(this,d)}};b("add");b("remove")}d.classList.toggle("c3",!1);if(d.classList.contains("c3")){var g=a.DOMTokenList.prototype.toggle;a.DOMTokenList.prototype.toggle=function(d,a){return 1 in arguments&&!this.contains(d)===!a?a:g.call(this,d)}}d=null}():function(d){if("Element"in d){d=d.Element.prototype;var a=Object,b=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,
				"")},e=Array.prototype.indexOf||function(d){for(var a=0,e=this.length;a<e;a++)if(a in this&&this[a]===d)return a;return-1},f=function(d,a){this.name=d;this.code=DOMException[d];this.message=a},g=function(d,a){if(""===a)throw new f("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(a))throw new f("INVALID_CHARACTER_ERR","String contains an invalid character");return e.call(d,a)},n=function(d){for(var a=b.call(d.getAttribute("class")||""),a=a?a.split(/\s+/):[],e=0,f=a.length;e<
		f;e++)this.push(a[e]);this._updateClassName=function(){d.setAttribute("class",this.toString())}},p=n.prototype=[],q=function(){return new n(this)};f.prototype=Error.prototype;p.item=function(a){return this[a]||null};p.contains=function(a){return-1!==g(this,a+"")};p.add=function(){var a=arguments,d=0,e=a.length,b,f=!1;do b=a[d]+"",-1===g(this,b)&&(this.push(b),f=!0);while(++d<e);f&&this._updateClassName()};p.remove=function(){var a=arguments,d=0,e=a.length,b,f=!1,h;do for(b=a[d]+"",h=g(this,b);-1!==
		h;)this.splice(h,1),f=!0,h=g(this,b);while(++d<e);f&&this._updateClassName()};p.toggle=function(a,d){a+="";var e=this.contains(a),b=e?!0!==d&&"remove":!1!==d&&"add";if(b)this[b](a);return!0===d||!1===d?d:!e};p.toString=function(){return this.join(" ")};if(a.defineProperty){p={get:q,enumerable:!0,configurable:!0};try{a.defineProperty(d,"classList",p)}catch(r){-2146823252===r.number&&(p.enumerable=!1,a.defineProperty(d,"classList",p))}}else a.prototype.__defineGetter__&&d.__defineGetter__("classList",
			q)}}(a));var g=function(a){var b=[];for(a=a.firstChild;a;a=a.nextSibling)3==a.nodeType?b.push(a):b=b.concat(g(a));return b},b=function(){Node.prototype.normalize=function(){var a=g(this),b=this.ownerDocument.defaultView.getSelection(),f=b.anchorNode,e=b.anchorOffset,m=b.focusNode,l=b.focusOffset,n=this.ownerDocument.createRange(),p=a.shift(),q=p?a.shift():null;if(f===m&&l<e||f!==m&&f.compareDocumentPosition(m)&Node.DOCUMENT_POSITION_PRECEDING)m=[f,f=m][0],l=[e,e=l][0];for(;p&&q;)q.previousSibling&&
		q.previousSibling===p?(f===q&&(f=p,e=p.nodeValue.length+e),m===q&&(m=p,l=p.nodeValue.length+l),p.nodeValue+=q.nodeValue,q.parentNode.removeChild(q)):p=q,q=a.shift();f&&f.parentNode&&m&&m.parentNode&&(n.setStart(f,e),n.setEnd(m,l),b.removeAllRanges(),b.addRange(n))}};"Node"in window&&"normalize"in Node.prototype&&function(){if("createRange"in document&&"getSelection"in window){var a=document.createElement("div"),b=document.createTextNode("a"),f=document.createTextNode("a"),e=document.createTextNode("a"),
			g=document.createRange();a.setAttribute("contenteditable","true");a.appendChild(b);a.appendChild(f);a.appendChild(e);document.body.appendChild(a);g.setStart(f,1);g.setEnd(f,1);b=window.getSelection();b.removeAllRanges();b.addRange(g);a.normalize();b=window.getSelection();g=1!==a.childNodes.length||b.anchorNode!==a.firstChild||2!==b.anchorOffset;a.parentNode.removeChild(a);b.removeAllRanges();return g}}()&&b()}};wysihtml5.polyfills(window,document);
	(function(a,f){"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a():f.rangy=a()})(function(){function a(a,e){var d=typeof a[e];return"function"==d||!("object"!=d||!a[e])||"unknown"==d}function f(a,e){return!("object"!=typeof a[e]||!a[e])}function g(a,e){return"undefined"!=typeof a[e]}function b(a){return function(e,d){for(var b=d.length;b--;)if(!a(e,d[b]))return!1;return!0}}function d(a){return a&&M(a,A)&&B(a,w)}function k(a){return f(a,
		"body")?a.body:a.getElementsByTagName("body")[0]}function h(e){"undefined"!=typeof console&&a(console,"log")&&console.log(e)}function e(a){y.initialized=!0;y.supported=!1;a="Rangy is not supported in this environment. Reason: "+a;D&&y.config.alertOnFail?alert(a):h(a)}function m(){if(D&&!y.initialized){var b,f=!1,g=!1;a(document,"createRange")&&(b=document.createRange(),M(b,t)&&B(b,u)&&(f=!0));if((b=k(document))&&"body"==b.nodeName.toLowerCase())if(b&&a(b,"createTextRange")&&(b=b.createTextRange(),
		d(b)&&(g=!0)),f||g){y.initialized=!0;y.features={implementsDomRange:f,implementsTextRange:g};var m,l;for(l in z)(m=z[l])instanceof q&&m.init(m,y);g=0;for(m=N.length;g<m;++g)try{N[g](y)}catch(p){f="Rangy init listener threw an exception. Continuing. Detail: "+(p.message||p.description||String(p)),h(f)}}else e("Neither Range nor TextRange are available");else e("No body element found")}}function l(a,e,d){d&&(a+=" in module "+d.name);y.warn("DEPRECATED: "+a+" is deprecated. Please use "+e+" instead.")}
		function n(a,e,d,b){a[e]=function(){l(e,d,b);return a[d].apply(a,G.toArray(arguments))}}function p(a){a=a||window;m();for(var e=0,d=H.length;e<d;++e)H[e](a)}function q(a,e,d){this.name=a;this.dependencies=e;this.supported=this.initialized=!1;this.initializer=d}function r(a,e,d){e=new q(a,e,function(e){if(!e.initialized){e.initialized=!0;try{d(y,e),e.supported=!0}catch(b){h("Module '"+a+"' failed to load: "+(b.message||b.description||String(b))),b.stack&&h(b.stack)}}});return z[a]=e}function v(){}
		var u="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),t="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),w="boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),A="collapse compareEndPoints duplicate moveToElementText parentElement select setEndPoint getBoundingClientRect".split(" "),
			M=b(a),J=b(f),B=b(g),z={},D="undefined"!=typeof window&&"undefined"!=typeof document,G={isHostMethod:a,isHostObject:f,isHostProperty:g,areHostMethods:M,areHostObjects:J,areHostProperties:B,isTextRange:d,getBody:k,forEach:[].forEach?function(a,e){a.forEach(e)}:function(a,e){for(var d=0,b=a.length;d<b;++d)e(a[d],d)}},y={version:"1.3.0",initialized:!1,isBrowser:D,supported:!0,util:G,features:{},modules:z,config:{alertOnFail:!1,alertOnWarn:!1,preferTextRange:!1,autoInitialize:"undefined"==typeof rangyAutoInitialize?
				!0:rangyAutoInitialize}};y.fail=e;y.warn=function(a){a="Rangy warning: "+a;D&&y.config.alertOnWarn?alert(a):h(a)};var S;({}).hasOwnProperty?(G.extend=S=function(a,e,d){var b,f,g;for(g in e)e.hasOwnProperty(g)&&(b=a[g],f=e[g],d&&null!==b&&"object"==typeof b&&null!==f&&"object"==typeof f&&S(b,f,!0),a[g]=f);e.hasOwnProperty("toString")&&(a.toString=e.toString);return a},G.createOptions=function(a,e){var d={};S(d,e);a&&S(d,a);return d}):e("hasOwnProperty not supported");D||e("Rangy can only run in a browser");
		(function(){var a;if(D){var e=document.createElement("div");e.appendChild(document.createElement("span"));var d=[].slice;try{1==d.call(e.childNodes,0)[0].nodeType&&(a=function(a){return d.call(a,0)})}catch(b){}}a||(a=function(a){for(var e=[],d=0,b=a.length;d<b;++d)e[d]=a[d];return e});G.toArray=a})();var R;D&&(a(document,"addEventListener")?R=function(a,e,d){a.addEventListener(e,d,!1)}:a(document,"attachEvent")?R=function(a,e,d){a.attachEvent("on"+e,d)}:e("Document does not have required addEventListener or attachEvent method"),
			G.addListener=R);var N=[];G.deprecationNotice=l;G.createAliasForDeprecatedMethod=n;y.init=m;y.addInitListener=function(a){y.initialized?a(y):N.push(a)};var H=[];y.addShimListener=function(a){H.push(a)};D&&(y.shim=y.createMissingNativeApi=p,n(y,"createMissingNativeApi","shim"));q.prototype={init:function(){for(var a=this.dependencies||[],e=0,d=a.length,b,f;e<d;++e){f=a[e];b=z[f];if(!(b&&b instanceof q))throw Error("required module '"+f+"' not found");b.init();if(!b.supported)throw Error("required module '"+
			f+"' not supported");}this.initializer(this)},fail:function(a){this.initialized=!0;this.supported=!1;throw Error(a);},warn:function(a){y.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,e){y.warn("DEPRECATED: "+a+" in module "+this.name+" is deprecated. Please use "+e+" instead")},createError:function(a){return Error("Error in Rangy "+this.name+" module: "+a)}};y.createModule=function(a){var e,d;2==arguments.length?(e=arguments[1],d=[]):(e=arguments[2],d=arguments[1]);e=r(a,d,e);y.initialized&&
		y.supported&&e.init()};y.createCoreModule=function(a,e,d){r(a,e,d)};y.RangePrototype=v;y.rangePrototype=new v;y.selectionPrototype=new function(){};y.createCoreModule("DomUtil",[],function(a,e){function d(a){for(var e=0;a=a.previousSibling;)++e;return e}function b(a,e){var d=[],f;for(f=a;f;f=f.parentNode)d.push(f);for(f=e;f;f=f.parentNode)if(v(d,f))return f;return null}function f(a,e,d){for(e=d?e:e.parentNode;e;){if(e===a)return!0;e=e.parentNode}return!1}function g(a,e,d){for(d=d?a:a.parentNode;d;){a=
			d.parentNode;if(a===e)return d;d=a}return null}function h(a){a=a.nodeType;return 3==a||4==a||8==a}function k(a,e){var d=e.nextSibling,b=e.parentNode;d?b.insertBefore(a,d):b.appendChild(a);return a}function m(a){if(9==a.nodeType)return a;if("undefined"!=typeof a.ownerDocument)return a.ownerDocument;if("undefined"!=typeof a.document)return a.document;if(a.parentNode)return m(a.parentNode);throw e.createError("getDocument: no document found for node");}function l(a){a=m(a);if("undefined"!=typeof a.defaultView)return a.defaultView;
			if("undefined"!=typeof a.parentWindow)return a.parentWindow;throw e.createError("Cannot get a window object for node");}function p(a){if("undefined"!=typeof a.contentDocument)return a.contentDocument;if("undefined"!=typeof a.contentWindow)return a.contentWindow.document;throw e.createError("getIframeDocument: No Document object found for iframe element");}function n(a){return a&&w.isHostMethod(a,"setTimeout")&&w.isHostObject(a,"document")}function q(a){return a?h(a)?'"'+a.data+'"':1==a.nodeType?"<"+
		a.nodeName+(a.id?' id="'+a.id+'"':"")+">[index:"+d(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]":a.nodeName:"[No node]"}function z(a){this._next=this.root=a}function r(a,e){this.node=a;this.offset=e}function B(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var w=a.util,D=w.getBody;w.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||e.fail("document missing a Node creation method");
			w.isHostMethod(document,"getElementsByTagName")||e.fail("document missing getElementsByTagName method");var J=document.createElement("div");w.areHostMethods(J,["insertBefore","appendChild","cloneNode"])||e.fail("Incomplete Element implementation");w.isHostProperty(J,"innerHTML")||e.fail("Element is missing innerHTML property");J=document.createTextNode("test");w.areHostMethods(J,["splitText","deleteData","insertData","appendData","cloneNode"])||e.fail("Incomplete Text Node implementation");var v=
				function(a,e){for(var d=a.length;d--;)if(a[d]===e)return!0;return!1},u=!1;(function(){var e=document.createElement("b");e.innerHTML="1";e.innerHTML="<br />";u=!1;a.features.crashyTextNodes=u})();var G;"undefined"!=typeof window.getComputedStyle?G=function(a,e){return l(a).getComputedStyle(a,null)[e]}:"undefined"!=typeof document.documentElement.currentStyle?G=function(a,e){return a.currentStyle?a.currentStyle[e]:""}:e.fail("No means of obtaining computed style properties found");z.prototype={_current:null,
				hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next,e;if(this._current){e=a.firstChild;if(!e)for(e=null;a!==this.root&&!(e=a.nextSibling);)a=a.parentNode;this._next=e}return this._current},detach:function(){this._current=this._next=this.root=null}};r.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+q(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};B.prototype=
			{INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};B.prototype.toString=function(){return this.message};a.dom={arrayContains:v,isHtmlNamespace:function(a){var e;return"undefined"==typeof a.namespaceURI||null===(e=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==e},parentElement:function(a){a=a.parentNode;return 1==a.nodeType?a:null},getNodeIndex:d,getNodeLength:function(a){switch(a.nodeType){case 7:case 10:return 0;
				case 3:case 8:return a.length;default:return a.childNodes.length}},getCommonAncestor:b,isAncestorOf:f,isOrIsAncestorOf:function(a,e){return f(a,e,!0)},getClosestAncestorIn:g,isCharacterDataNode:h,isTextOrCommentNode:function(a){if(!a)return!1;a=a.nodeType;return 3==a||8==a},insertAfter:k,splitDataNode:function(a,e,b){var f=a.cloneNode(!1);f.deleteData(0,e);a.deleteData(e,a.length-e);k(f,a);if(b)for(var g=0,h;h=b[g++];)h.node==a&&h.offset>e?(h.node=f,h.offset-=e):h.node==a.parentNode&&h.offset>d(a)&&
			++h.offset;return f},getDocument:m,getWindow:l,getIframeWindow:function(a){if("undefined"!=typeof a.contentWindow)return a.contentWindow;if("undefined"!=typeof a.contentDocument)return a.contentDocument.defaultView;throw e.createError("getIframeWindow: No Window object found for iframe element");},getIframeDocument:p,getBody:D,isWindow:n,getContentDocument:function(a,e,d){var b;a?w.isHostProperty(a,"nodeType")?b=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?p(a):m(a):n(a)&&(b=a.document):b=document;
				if(!b)throw e.createError(d+"(): Parameter must be a Window object or DOM node");return b},getRootContainer:function(a){for(var e;e=a.parentNode;)a=e;return a},comparePoints:function(a,f,h,k){var m;if(a==h)return f===k?0:f<k?-1:1;if(m=g(h,a,!0))return f<=d(m)?-1:1;if(m=g(a,h,!0))return d(m)<k?-1:1;f=b(a,h);if(!f)throw Error("comparePoints error: nodes have no common ancestor");a=a===f?f:g(a,f,!0);h=h===f?f:g(h,f,!0);if(a===h)throw e.createError("comparePoints got to case 4 and childA and childB are the same!");
				for(f=f.firstChild;f;){if(f===a)return-1;if(f===h)return 1;f=f.nextSibling}},isBrokenNode:function(a){return!1},inspectNode:q,getComputedStyleProperty:G,createTestElement:function(a,e,d){var b=D(a);a=a.createElement("div");a.contentEditable=""+!!d;e&&(a.innerHTML=e);(e=b.firstChild)?b.insertBefore(a,e):b.appendChild(a);return a},removeNode:function(a){return a.parentNode.removeChild(a)},fragmentFromNodeChildren:function(a){for(var e=m(a).createDocumentFragment(),d;d=a.firstChild;)e.appendChild(d);
				return e},createIterator:function(a){return new z(a)},DomPosition:r};a.DOMException=B});y.createCoreModule("DomRange",["DomUtil"],function(a,e){function d(a,e){return 3!=a.nodeType&&(x(a,e.startContainer)||x(a,e.endContainer))}function b(a){return a.document||V(a.startContainer)}function f(a){return new K(a.parentNode,X(a))}function g(a){return new K(a.parentNode,X(a)+1)}function h(a,e,d){var b=11==a.nodeType?a.firstChild:a;E(e)?d==e.length?C.insertAfter(a,e):e.parentNode.insertBefore(a,0==d?e:da(e,
			d)):d>=e.childNodes.length?e.appendChild(a):e.insertBefore(a,e.childNodes[d]);return b}function k(a,e,d){A(a);A(e);if(b(e)!=b(a))throw new F("WRONG_DOCUMENT_ERR");var f=I(a.startContainer,a.startOffset,e.endContainer,e.endOffset);a=I(a.endContainer,a.endOffset,e.startContainer,e.startOffset);return d?0>=f&&0<=a:0>f&&0<a}function m(a){for(var e,d,f=b(a.range).createDocumentFragment();d=a.next();){e=a.isPartiallySelectedSubtree();d=d.cloneNode(!e);e&&(e=a.getSubtreeIterator(),d.appendChild(m(e)),e.detach());
			if(10==d.nodeType)throw new F("HIERARCHY_REQUEST_ERR");f.appendChild(d)}return f}function l(a,e,d){var b,f;for(d=d||{stop:!1};b=a.next();)if(a.isPartiallySelectedSubtree())if(!1===e(b)){d.stop=!0;break}else{if(b=a.getSubtreeIterator(),l(b,e,d),b.detach(),d.stop)break}else for(b=C.createIterator(b);f=b.next();)if(!1===e(f)){d.stop=!0;return}}function p(a){for(var e;a.next();)a.isPartiallySelectedSubtree()?(e=a.getSubtreeIterator(),p(e),e.detach()):a.remove()}function n(a){for(var e,d=b(a.range).createDocumentFragment(),
																																																																																																																												f;e=a.next();){a.isPartiallySelectedSubtree()?(e=e.cloneNode(!1),f=a.getSubtreeIterator(),e.appendChild(n(f)),f.detach()):a.remove();if(10==e.nodeType)throw new F("HIERARCHY_REQUEST_ERR");d.appendChild(e)}return d}function q(a,e,d){var b=!(!e||!e.length),f,g=!!d;b&&(f=new RegExp("^("+e.join("|")+")$"));var h=[];l(new r(a,!1),function(e){if(!b||f.test(e.nodeType))if(!g||d(e)){var k=a.startContainer;e==k&&E(k)&&a.startOffset==k.length||(k=a.endContainer,e==k&&E(k)&&0==a.endOffset||h.push(e))}});return h}
			function z(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+C.inspectNode(a.startContainer)+":"+a.startOffset+", "+C.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function r(a,e){this.range=a;this.clonePartiallySelectedTextNodes=e;if(!a.collapsed){this.sc=a.startContainer;this.so=a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;var d=a.commonAncestorContainer;this.sc===this.ec&&E(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):
				(this._first=this._next=this.sc!==d||E(this.sc)?Y(this.sc,d,!0):this.sc.childNodes[this.so],this._last=this.ec!==d||E(this.ec)?Y(this.ec,d,!0):this.ec.childNodes[this.eo-1])}}function B(a){return function(e,d){for(var b,f=d?e:e.parentNode;f;){b=f.nodeType;if(Z(a,b))return f;f=f.parentNode}return null}}function w(a,e){if(pa(a,e))throw new F("INVALID_NODE_TYPE_ERR");}function D(a,e){if(!Z(e,a.nodeType))throw new F("INVALID_NODE_TYPE_ERR");}function J(a,e){if(0>e||e>(E(a)?a.length:a.childNodes.length))throw new F("INDEX_SIZE_ERR");
			}function v(a,e){if(la(a,!0)!==la(e,!0))throw new F("WRONG_DOCUMENT_ERR");}function u(a){if(qa(a,!0))throw new F("NO_MODIFICATION_ALLOWED_ERR");}function G(a,e){return e<=(E(a)?a.length:a.childNodes.length)}function t(a){return!!a.startContainer&&!!a.endContainer&&!(ea&&(C.isBrokenNode(a.startContainer)||C.isBrokenNode(a.endContainer)))&&L(a.startContainer)==L(a.endContainer)&&G(a.startContainer,a.startOffset)&&G(a.endContainer,a.endOffset)}function A(a){if(!t(a))throw Error("Range error: Range is not valid. This usually happens after DOM mutation. Range: ("+
				a.inspect()+")");}function y(a,e){A(a);var d=a.startContainer,b=a.startOffset,f=a.endContainer,g=a.endOffset,h=d===f;E(f)&&0<g&&g<f.length&&da(f,g,e);E(d)&&0<b&&b<d.length&&(d=da(d,b,e),h?(g-=b,f=d):f==d.parentNode&&g>=X(d)&&g++,b=0);a.setStartAndEnd(d,b,f,g)}function M(a){A(a);var e=a.commonAncestorContainer.parentNode.cloneNode(!1);e.appendChild(a.cloneContents());return e.innerHTML}function S(a){a.START_TO_START=0;a.START_TO_END=1;a.END_TO_END=2;a.END_TO_START=3;a.NODE_BEFORE=0;a.NODE_AFTER=1;
				a.NODE_BEFORE_AND_AFTER=2;a.NODE_INSIDE=3}function R(a){S(a);S(a.prototype)}function N(a,e){return function(){A(this);var d=this.startContainer,b=this.startOffset,f=this.commonAncestorContainer,h=new r(this,!0);d!==f&&(d=Y(d,f,!0),b=g(d),d=b.node,b=b.offset);l(h,u);h.reset();f=a(h);h.detach();e(this,d,b,d,b);return f}}function H(e,b){function h(a,e){return function(d){D(d,fa);D(L(d),ga);d=(a?f:g)(d);(e?k:m)(this,d.node,d.offset)}}function k(a,e,d){var f=a.endContainer,g=a.endOffset;if(e!==a.startContainer||
				d!==a.startOffset){if(L(e)!=L(f)||1==I(e,d,f,g))f=e,g=d;b(a,e,d,f,g)}}function m(a,e,d){var f=a.startContainer,g=a.startOffset;if(e!==a.endContainer||d!==a.endOffset){if(L(e)!=L(f)||-1==I(e,d,f,g))f=e,g=d;b(a,f,g,e,d)}}var l=function(){};l.prototype=a.rangePrototype;e.prototype=new l;aa.extend(e.prototype,{setStart:function(a,e){w(a,!0);J(a,e);k(this,a,e)},setEnd:function(a,e){w(a,!0);J(a,e);m(this,a,e)},setStartAndEnd:function(){var a=arguments,e=a[0],d=a[1],f=e,g=d;switch(a.length){case 3:g=a[2];
				break;case 4:f=a[2],g=a[3]}b(this,e,d,f,g)},setBoundary:function(a,e,d){this["set"+(d?"Start":"End")](a,e)},setStartBefore:h(!0,!0),setStartAfter:h(!1,!0),setEndBefore:h(!0,!1),setEndAfter:h(!1,!1),collapse:function(a){A(this);a?b(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):b(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){w(a,!0);b(this,a,0,a,ha(a))},selectNode:function(a){w(a,!1);D(a,fa);var e=f(a);a=g(a);
				b(this,e.node,e.offset,a.node,a.offset)},extractContents:N(n,b),deleteContents:N(p,b),canSurroundContents:function(){A(this);u(this.startContainer);u(this.endContainer);var a=new r(this,!0),e=a._first&&d(a._first,this)||a._last&&d(a._last,this);a.detach();return!e},splitBoundaries:function(){y(this)},splitBoundariesPreservingPositions:function(a){y(this,a)},normalizeBoundaries:function(){A(this);var a=this.startContainer,e=this.startOffset,d=this.endContainer,f=this.endOffset,g=function(a){var e=
				a.nextSibling;e&&e.nodeType==a.nodeType&&(d=a,f=a.length,a.appendData(e.data),U(e))},h=function(b){var g=b.previousSibling;if(g&&g.nodeType==b.nodeType){a=b;var h=b.length;e=g.length;b.insertData(0,g.data);U(g);a==d?(f+=e,d=a):d==b.parentNode&&(g=X(b),f==g?(d=b,f=h):f>g&&f--)}},k=!0;E(d)?f==d.length?g(d):0==f&&(g=d.previousSibling)&&g.nodeType==d.nodeType&&(f=g.length,a==d&&(k=!1),g.appendData(d.data),U(d),d=g):(0<f&&(k=d.childNodes[f-1])&&E(k)&&g(k),k=!this.collapsed);k?E(a)?0==e?h(a):e==a.length&&
			(g=a.nextSibling)&&g.nodeType==a.nodeType&&(d==g&&(d=a,f+=a.length),a.appendData(g.data),U(g)):e<a.childNodes.length&&(g=a.childNodes[e])&&E(g)&&h(g):(a=d,e=f);b(this,a,e,d,f)},collapseToPoint:function(a,e){w(a,!0);J(a,e);this.setStartAndEnd(a,e)}});R(e)}function ma(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=a.collapsed?a.startContainer:C.getCommonAncestor(a.startContainer,a.endContainer)}function P(a,e,d,b,f){a.startContainer=e;a.startOffset=
				d;a.endContainer=b;a.endOffset=f;a.document=C.getDocument(e);ma(a)}function Q(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this.document=a;ma(this)}var C=a.dom,aa=a.util,K=C.DomPosition,F=a.DOMException,E=C.isCharacterDataNode,X=C.getNodeIndex,x=C.isOrIsAncestorOf,V=C.getDocument,I=C.comparePoints,da=C.splitDataNode,Y=C.getClosestAncestorIn,ha=C.getNodeLength,Z=C.arrayContains,L=C.getRootContainer,ea=a.features.crashyTextNodes,U=C.removeNode;r.prototype={_current:null,
				_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=a!==this._last?a.nextSibling:null,E(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));return a},remove:function(){var a=this._current,e,d;!E(a)||
				a!==this.sc&&a!==this.ec?a.parentNode&&U(a):(e=a===this.sc?this.so:0,d=a===this.ec?this.eo:a.length,e!=d&&a.deleteData(e,d-e))},isPartiallySelectedSubtree:function(){return d(this._current,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new Q(b(this.range));var e=this._current,d=e,f=0,g=e,h=ha(e);x(e,this.sc)&&(d=this.sc,f=this.so);x(e,this.ec)&&(g=this.ec,h=this.eo);P(a,d,f,g,h)}return new r(a,this.clonePartiallySelectedTextNodes)},
				detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var fa=[1,3,4,5,7,8,10],ga=[2,9,11],T=[1,3,4,5,7,8,10,11],ba=[1,3,4,5,7,8],la=B([9,11]),qa=B([5,6,10,12]),pa=B([6,10,12]),oa=document.createElement("style"),ja=!1;try{oa.innerHTML="<b>x</b>",ja=3==oa.firstChild.nodeType}catch(sa){}a.features.htmlParsingConforms=ja;var ka="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" ");aa.extend(a.rangePrototype,
				{compareBoundaryPoints:function(a,e){A(this);v(this.startContainer,e.startContainer);var d=3==a||0==a?"start":"end",b=1==a||0==a?"start":"end";return I(this[d+"Container"],this[d+"Offset"],e[b+"Container"],e[b+"Offset"])},insertNode:function(a){A(this);D(a,T);u(this.startContainer);if(x(a,this.startContainer))throw new F("HIERARCHY_REQUEST_ERR");a=h(a,this.startContainer,this.startOffset);this.setStartBefore(a)},cloneContents:function(){A(this);var a,e;if(this.collapsed)return b(this).createDocumentFragment();
					if(this.startContainer===this.endContainer&&E(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),e=b(this).createDocumentFragment(),e.appendChild(a),e;e=new r(this,!0);a=m(e);e.detach();return a},canSurroundContents:function(){A(this);u(this.startContainer);u(this.endContainer);var a=new r(this,!0),e=a._first&&d(a._first,this)||a._last&&d(a._last,this);a.detach();return!e},surroundContents:function(a){D(a,ba);if(!this.canSurroundContents())throw new F("INVALID_STATE_ERR");
					var e=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);h(a,this.startContainer,this.startOffset);a.appendChild(e);this.selectNode(a)},cloneRange:function(){A(this);for(var a=new Q(b(this)),e=ka.length,d;e--;)d=ka[e],a[d]=this[d];return a},toString:function(){A(this);var a=this.startContainer;if(a===this.endContainer&&E(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var e=[],a=new r(this,!0);l(a,function(a){3!=a.nodeType&&
				4!=a.nodeType||e.push(a.data)});a.detach();return e.join("")},compareNode:function(a){A(this);var e=a.parentNode,d=X(a);if(!e)throw new F("NOT_FOUND_ERR");a=this.comparePoint(e,d);e=this.comparePoint(e,d+1);return 0>a?0<e?2:0:0<e?1:3},comparePoint:function(a,e){A(this);if(!a)throw new F("HIERARCHY_REQUEST_ERR");v(a,this.startContainer);return 0>I(a,e,this.startContainer,this.startOffset)?-1:0<I(a,e,this.endContainer,this.endOffset)?1:0},createContextualFragment:ja?function(a){var e=this.startContainer,
					d=V(e);if(!e)throw new F("INVALID_STATE_ERR");var b=null;1==e.nodeType?b=e:E(e)&&(b=C.parentElement(e));b=null===b||"HTML"==b.nodeName&&C.isHtmlNamespace(V(b).documentElement)&&C.isHtmlNamespace(b)?d.createElement("body"):b.cloneNode(!1);b.innerHTML=a;return C.fragmentFromNodeChildren(b)}:function(a){var e=b(this).createElement("body");e.innerHTML=a;return C.fragmentFromNodeChildren(e)},toHtml:function(){return M(this)},intersectsNode:function(a,e){A(this);if(L(a)!=L(this.startContainer))return!1;
					var d=a.parentNode,b=X(a);if(!d)return!0;var f=I(d,b,this.endContainer,this.endOffset),d=I(d,b+1,this.startContainer,this.startOffset);return e?0>=f&&0<=d:0>f&&0<d},isPointInRange:function(a,e){A(this);if(!a)throw new F("HIERARCHY_REQUEST_ERR");v(a,this.startContainer);return 0<=I(a,e,this.startContainer,this.startOffset)&&0>=I(a,e,this.endContainer,this.endOffset)},intersectsRange:function(a){return k(this,a,!1)},intersectsOrTouchesRange:function(a){return k(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var e=
					I(this.startContainer,this.startOffset,a.startContainer,a.startOffset),d=I(this.endContainer,this.endOffset,a.endContainer,a.endOffset),b=this.cloneRange();-1==e&&b.setStart(a.startContainer,a.startOffset);1==d&&b.setEnd(a.endContainer,a.endOffset);return b}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var e=this.cloneRange();-1==I(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&e.setStart(a.startContainer,a.startOffset);1==I(a.endContainer,a.endOffset,
					this.endContainer,this.endOffset)&&e.setEnd(a.endContainer,a.endOffset);return e}throw new F("Ranges do not intersect");},containsNode:function(a,e){return e?this.intersectsNode(a,!1):3==this.compareNode(a)},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,ha(a))},containsRange:function(a){var e=this.intersection(a);return null!==e&&a.equals(e)},containsNodeText:function(a){var e=this.cloneRange();e.selectNode(a);var d=e.getNodes([3]);return 0<d.length?(e.setStart(d[0],
					0),a=d.pop(),e.setEnd(a,a.length),this.containsRange(e)):this.containsNodeContents(a)},getNodes:function(a,e){A(this);return q(this,a,e)},getDocument:function(){return b(this)},collapseBefore:function(a){this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a);this.collapse(!0)},getBookmark:function(e){var d=b(this),f=a.createRange(d);e=e||C.getBody(d);f.selectNodeContents(e);var d=this.intersection(f),g=0,h=0;d&&(f.setEnd(d.startContainer,d.startOffset),g=f.toString().length,
					h=g+d.toString().length);return{start:g,end:h,containerNode:e}},moveToBookmark:function(a){var e=a.containerNode,d=0;this.setStart(e,0);this.collapse(!0);for(var e=[e],b,f=!1,g=!1,h,k;!g&&(b=e.pop());)if(3==b.nodeType)h=d+b.length,!f&&a.start>=d&&a.start<=h&&(this.setStart(b,a.start-d),f=!0),f&&a.end>=d&&a.end<=h&&(this.setEnd(b,a.end-d),g=!0),d=h;else for(k=b.childNodes,h=k.length;h--;)e.push(k[h])},getName:function(){return"DomRange"},equals:function(a){return Q.rangesEqual(this,a)},isValid:function(){return t(this)},
					inspect:function(){return z(this)},detach:function(){}});H(Q,P);aa.extend(Q,{rangeProperties:ka,RangeIterator:r,copyComparisonConstants:R,createPrototypeRange:H,inspect:z,toHtml:M,getRangeDocument:b,rangesEqual:function(a,e){return a.startContainer===e.startContainer&&a.startOffset===e.startOffset&&a.endContainer===e.endContainer&&a.endOffset===e.endOffset}});a.DomRange=Q});y.createCoreModule("WrappedRange",["DomRange"],function(a,e){var d,b,f=a.dom,g=a.util,h=f.DomPosition,k=a.DomRange,m=f.getBody,
			l=f.getContentDocument,p=f.isCharacterDataNode;a.features.implementsDomRange&&function(){function b(a){for(var e=p.length,d;e--;)d=p[e],a[d]=a.nativeRange[d];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}var h,p=k.rangeProperties,n;d=function(a){if(!a)throw e.createError("WrappedRange: Range must be specified");this.nativeRange=a;b(this)};k.createPrototypeRange(d,function(a,e,d,b,f){var g=a.startContainer!==e||a.startOffset!=d,h=a.endContainer!==b||a.endOffset!=f,k=!a.equals(a.nativeRange);
			if(g||h||k)a.setEnd(b,f),a.setStart(e,d)});h=d.prototype;h.selectNode=function(a){this.nativeRange.selectNode(a);b(this)};h.cloneContents=function(){return this.nativeRange.cloneContents()};h.surroundContents=function(a){this.nativeRange.surroundContents(a);b(this)};h.collapse=function(a){this.nativeRange.collapse(a);b(this)};h.cloneRange=function(){return new d(this.nativeRange.cloneRange())};h.refresh=function(){b(this)};h.toString=function(){return this.nativeRange.toString()};var q=document.createTextNode("test");
			m(document).appendChild(q);var z=document.createRange();z.setStart(q,0);z.setEnd(q,0);try{z.setStart(q,1),h.setStart=function(a,e){this.nativeRange.setStart(a,e);b(this)},h.setEnd=function(a,e){this.nativeRange.setEnd(a,e);b(this)},n=function(a){return function(e){this.nativeRange[a](e);b(this)}}}catch(r){h.setStart=function(a,e){try{this.nativeRange.setStart(a,e)}catch(d){this.nativeRange.setEnd(a,e),this.nativeRange.setStart(a,e)}b(this)},h.setEnd=function(a,e){try{this.nativeRange.setEnd(a,e)}catch(d){this.nativeRange.setStart(a,
				e),this.nativeRange.setEnd(a,e)}b(this)},n=function(a,e){return function(d){try{this.nativeRange[a](d)}catch(f){this.nativeRange[e](d),this.nativeRange[a](d)}b(this)}}}h.setStartBefore=n("setStartBefore","setEndBefore");h.setStartAfter=n("setStartAfter","setEndAfter");h.setEndBefore=n("setEndBefore","setStartBefore");h.setEndAfter=n("setEndAfter","setStartAfter");h.selectNodeContents=function(a){this.setStartAndEnd(a,0,f.getNodeLength(a))};z.selectNodeContents(q);z.setEnd(q,3);n=document.createRange();
			n.selectNodeContents(q);n.setEnd(q,4);n.setStart(q,2);-1==z.compareBoundaryPoints(z.START_TO_END,n)&&1==z.compareBoundaryPoints(z.END_TO_START,n)?h.compareBoundaryPoints=function(a,e){e=e.nativeRange||e;a==e.START_TO_END?a=e.END_TO_START:a==e.END_TO_START&&(a=e.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,e)}:h.compareBoundaryPoints=function(a,e){return this.nativeRange.compareBoundaryPoints(a,e.nativeRange||e)};n=document.createElement("div");n.innerHTML="123";var B=n.firstChild,
				w=m(document);w.appendChild(n);z.setStart(B,1);z.setEnd(B,2);z.deleteContents();"13"==B.data&&(h.deleteContents=function(){this.nativeRange.deleteContents();b(this)},h.extractContents=function(){var a=this.nativeRange.extractContents();b(this);return a});w.removeChild(n);w=null;g.isHostMethod(z,"createContextualFragment")&&(h.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});m(document).removeChild(q);h.getName=function(){return"WrappedRange"};a.WrappedRange=
				d;a.createNativeRange=function(a){a=l(a,e,"createNativeRange");return a.createRange()}}();if(a.features.implementsTextRange){var n=function(a,e,d,b,g){var k=a.duplicate();k.collapse(d);var m=k.parentElement();f.isOrIsAncestorOf(e,m)||(m=e);if(!m.canHaveHTML)return m=new h(m.parentNode,f.getNodeIndex(m)),{boundaryPosition:m,nodeInfo:{nodeIndex:m.offset,containerElement:m.node}};e=f.getDocument(m).createElement("span");e.parentNode&&f.removeNode(e);var l,n=d?"StartToStart":"StartToEnd",q=g&&g.containerElement==
		m?g.nodeIndex:0,z=m.childNodes.length,r=z;for(g=r;;){g==z?m.appendChild(e):m.insertBefore(e,m.childNodes[g]);k.moveToElementText(e);l=k.compareEndPoints(n,a);if(0==l||q==r)break;else if(-1==l)if(r==q+1)break;else q=g;else r=r==q+1?q:g;g=Math.floor((q+r)/2);m.removeChild(e)}n=e.nextSibling;if(-1==l&&n&&p(n)){k.setEndPoint(d?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(n.data))for(d=k.duplicate(),b=d.text.replace(/\r\n/g,"\r").length,b=d.moveStart("character",b);-1==d.compareEndPoints("StartToEnd",d);)b++,
			d.moveStart("character",1);else b=k.text.length;d=new h(n,b)}else a=(b||!d)&&e.previousSibling,d=(d=(b||d)&&e.nextSibling)&&p(d)?new h(d,0):a&&p(a)?new h(a,a.data.length):new h(m,f.getNodeIndex(e));f.removeNode(e);return{boundaryPosition:d,nodeInfo:{nodeIndex:g,containerElement:m}}},q=function(a,e){var d,b,g=a.offset,h=f.getDocument(a.node),k=m(h).createTextRange(),l=p(a.node);l?(d=a.node,b=d.parentNode):(d=a.node.childNodes,d=g<d.length?d[g]:null,b=a.node);h=h.createElement("span");h.innerHTML="&#feff;";
			d?b.insertBefore(h,d):b.appendChild(h);k.moveToElementText(h);k.collapse(!e);b.removeChild(h);if(l)k[e?"moveStart":"moveEnd"]("character",g);return k};b=function(a){this.textRange=a;this.refresh()};b.prototype=new k(document);b.prototype.refresh=function(){var a,e,d;d=this.textRange;a=d.parentElement();var b=d.duplicate();b.collapse(!0);e=b.parentElement();b=d.duplicate();b.collapse(!1);d=b.parentElement();e=e==d?e:f.getCommonAncestor(e,d);e=e==a?e:f.getCommonAncestor(a,e);a=this.textRange;0==a.compareEndPoints("StartToEnd",
			a)?e=a=n(this.textRange,e,!0,!0).boundaryPosition:(d=n(this.textRange,e,!0,!1),a=d.boundaryPosition,e=n(this.textRange,e,!1,!1,d.nodeInfo).boundaryPosition);this.setStart(a.node,a.offset);this.setEnd(e.node,e.offset)};b.prototype.getName=function(){return"WrappedTextRange"};k.copyComparisonConstants(b);var z=function(a){if(a.collapsed)return q(new h(a.startContainer,a.startOffset),!0);var e=q(new h(a.startContainer,a.startOffset),!0),d=q(new h(a.endContainer,a.endOffset),!1);a=m(k.getRangeDocument(a)).createTextRange();
			a.setEndPoint("StartToStart",e);a.setEndPoint("EndToEnd",d);return a};b.rangeToTextRange=z;b.prototype.toTextRange=function(){return z(this)};a.WrappedTextRange=b;if(!a.features.implementsDomRange||a.config.preferTextRange){var r=Function("return this;")();"undefined"==typeof r.Range&&(r.Range=b);a.createNativeRange=function(a){a=l(a,e,"createNativeRange");return m(a).createTextRange()};a.WrappedRange=b}}a.createRange=function(d){d=l(d,e,"createRange");return new a.WrappedRange(a.createNativeRange(d))};
			a.createRangyRange=function(a){a=l(a,e,"createRangyRange");return new k(a)};g.createAliasForDeprecatedMethod(a,"createIframeRange","createRange");g.createAliasForDeprecatedMethod(a,"createIframeRangyRange","createRangyRange");a.addShimListener(function(e){var d=e.document;"undefined"==typeof d.createRange&&(d.createRange=function(){return a.createRange(d)});d=e=null})});y.createCoreModule("WrappedSelection",["DomRange","WrappedRange"],function(a,e){function d(a){return"string"==typeof a?/^backward(s)?$/i.test(a):
			!!a}function b(a,d){if(a){if(t.isWindow(a))return a;if(a instanceof B)return a.win;var f=t.getContentDocument(a,e,d);return t.getWindow(f)}return window}function f(a){return b(a,"getWinSelection").getSelection()}function g(a){return b(a,"getDocSelection").document.selection}function h(a){var e=!1;a.anchorNode&&(e=1==t.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset));return e}function k(a,e,d){var b=d?"end":"start";d=d?"start":"end";a.anchorNode=e[b+"Container"];a.anchorOffset=
			e[b+"Offset"];a.focusNode=e[d+"Container"];a.focusOffset=e[d+"Offset"]}function m(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function l(e){var d;e instanceof M?(d=a.createNativeRange(e.getDocument()),d.setEnd(e.endContainer,e.endOffset),d.setStart(e.startContainer,e.startOffset)):e instanceof S?d=e.nativeRange:P.implementsDomRange&&e instanceof t.getWindow(e.startContainer).Range&&(d=e);return d}function p(a){var d=a.getNodes(),
			b;a:if(d.length&&1==d[0].nodeType){b=1;for(var f=d.length;b<f;++b)if(!t.isAncestorOf(d[0],d[b])){b=!1;break a}b=!0}else b=!1;if(!b)throw e.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return d[0]}function n(a){return!!a&&"undefined"!=typeof a.text}function q(a,e){var d=new S(e);a._ranges=[d];k(a,d,!1);a.rangeCount=1;a.isCollapsed=d.collapsed}function z(e){e._ranges.length=0;if("None"==e.docSelection.type)m(e);else{var d=e.docSelection.createRange();
			if(n(d))q(e,d);else{e.rangeCount=d.length;for(var b,f=Q(d.item(0)),g=0;g<e.rangeCount;++g)b=a.createRange(f),b.selectNode(d.item(g)),e._ranges.push(b);e.isCollapsed=1==e.rangeCount&&e._ranges[0].collapsed;k(e,e._ranges[e.rangeCount-1],!1)}}}function r(a,d){for(var b=a.docSelection.createRange(),f=p(d),g=Q(b.item(0)),g=C(g).createControlRange(),h=0,k=b.length;h<k;++h)g.add(b.item(h));try{g.add(f)}catch(m){throw e.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");
		}g.select();z(a)}function B(a,e,d){this.nativeSelection=a;this.docSelection=e;this._ranges=[];this.win=d;this.refresh()}function w(a){a.win=a.anchorNode=a.focusNode=a._ranges=null;a.rangeCount=a.anchorOffset=a.focusOffset=0;a.detached=!0}function D(a,e){for(var d=U.length,b,f;d--;)if(b=U[d],f=b.selection,"deleteAll"==e)w(f);else if(b.win==a)return"delete"==e?(U.splice(d,1),!0):f;"deleteAll"==e&&(U.length=0);return null}function J(a,d){for(var b=Q(d[0].startContainer),b=C(b).createControlRange(),f=
			0,g,h=d.length;f<h;++f){g=p(d[f]);try{b.add(g)}catch(k){throw e.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");}}b.select();z(a)}function v(a,e){if(a.win.document!=Q(e))throw new R("WRONG_DOCUMENT_ERR");}function u(e){return function(d,b){var f;this.rangeCount?(f=this.getRangeAt(0),f["set"+(e?"Start":"End")](d,b)):(f=a.createRange(this.win.document),f.setStartAndEnd(d,b));this.setSingleRange(f,this.isBackward())}}
			function G(a){var e=[],d=new N(a.anchorNode,a.anchorOffset),b=new N(a.focusNode,a.focusOffset),f="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var g=0,h=a.rangeCount;g<h;++g)e[g]=M.inspect(a.getRangeAt(g));return"["+f+"(Ranges: "+e.join(", ")+")(anchor: "+d.inspect()+", focus: "+b.inspect()+"]"}a.config.checkSelectionRanges=!0;var t=a.dom,A=a.util,y=A.isHostMethod,M=a.DomRange,S=a.WrappedRange,R=a.DOMException,N=t.DomPosition,H,T,P=a.features,Q=t.getDocument,
				C=t.getBody,aa=M.rangesEqual,K=y(window,"getSelection"),F=A.isHostObject(document,"selection");P.implementsWinGetSelection=K;var E=(P.implementsDocSelection=F)&&(!K||a.config.preferTextRange);if(E)H=g,a.isSelectionValid=function(a){a=b(a,"isSelectionValid").document;var e=a.selection;return"None"!=e.type||Q(e.createRange().parentElement())==a};else if(K)H=f,a.isSelectionValid=function(){return!0};else return e.fail("Neither document.selection or window.getSelection() detected."),!1;a.getNativeSelection=
				H;K=H();if(!K)return e.fail("Native selection was null (possibly issue 138?)"),!1;var X=a.createNativeRange(document),x=C(document),V=A.areHostProperties(K,["anchorNode","focusNode","anchorOffset","focusOffset"]);P.selectionHasAnchorAndFocus=V;var I=y(K,"extend");P.selectionHasExtend=I;var da="number"==typeof K.rangeCount;P.selectionHasRangeCount=da;var Y=!1,ha=!0,Z=I?function(e,d){var b=M.getRangeDocument(d),b=a.createRange(b);b.collapseToPoint(d.endContainer,d.endOffset);e.addRange(l(b));e.extend(d.startContainer,
				d.startOffset)}:null;A.areHostMethods(K,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof K.rangeCount&&P.implementsDomRange&&function(){var e=window.getSelection();if(e){for(var d=e.rangeCount,b=1<d,f=[],g=h(e),k=0;k<d;++k)f[k]=e.getRangeAt(k);var k=t.createTestElement(document,"",!1),m=k.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")),l=document.createRange();l.setStart(m,1);l.collapse(!0);e.removeAllRanges();e.addRange(l);ha=1==e.rangeCount;e.removeAllRanges();b||((b=window.navigator.appVersion.match(/Chrome\/(.*?) /))&&
			36<=parseInt(b[1])?Y=!1:(b=l.cloneRange(),l.setStart(m,0),b.setEnd(m,3),b.setStart(m,2),e.addRange(l),e.addRange(b),Y=2==e.rangeCount));t.removeNode(k);e.removeAllRanges();for(k=0;k<d;++k)0==k&&g?Z?Z(e,f[k]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),e.addRange(f[k])):e.addRange(f[k])}}();P.selectionSupportsMultipleRanges=Y;P.collapsedNonEditableSelectionsSupported=ha;var L=!1;x&&
			y(x,"createControlRange")&&(x=x.createControlRange(),A.areHostProperties(x,["item","add"])&&(L=!0));P.implementsControlRange=L;T=V?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var ea;y(K,"getRangeAt")?ea=function(a,e){try{return a.getRangeAt(e)}catch(d){return null}}:V&&(ea=function(e){var d=Q(e.anchorNode),d=a.createRange(d);d.setStartAndEnd(e.anchorNode,e.anchorOffset,e.focusNode,e.focusOffset);
				d.collapsed!==this.isCollapsed&&d.setStartAndEnd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset);return d});B.prototype=a.selectionPrototype;var U=[],fa=function(a){if(a&&a instanceof B)return a.refresh(),a;a=b(a,"getNativeSelection");var e=D(a),d=H(a),f=F?g(a):null;e?(e.nativeSelection=d,e.docSelection=f,e.refresh()):(e=new B(d,f,a),U.push({win:a,selection:e}));return e};a.getSelection=fa;A.createAliasForDeprecatedMethod(a,"getIframeSelection","getSelection");x=B.prototype;if(!E&&V&&A.areHostMethods(K,
					["removeAllRanges","addRange"]))x.removeAllRanges=function(){this.nativeSelection.removeAllRanges();m(this)},x.addRange=da?function(e,b){if(L&&F&&"Control"==this.docSelection.type)r(this,e);else if(d(b)&&I)Z(this.nativeSelection,e),this.refresh();else{var f;Y?f=this.rangeCount:(this.removeAllRanges(),f=0);var g=l(e).cloneRange();try{this.nativeSelection.addRange(g)}catch(h){}this.rangeCount=this.nativeSelection.rangeCount;this.rangeCount==f+1?(a.config.checkSelectionRanges&&(f=ea(this.nativeSelection,
				this.rangeCount-1))&&!aa(f,e)&&(e=new S(f)),this._ranges[this.rangeCount-1]=e,k(this,e,ba(this.nativeSelection)),this.isCollapsed=T(this)):this.refresh()}}:function(a,e){d(e)&&I?Z(this.nativeSelection,a):this.nativeSelection.addRange(l(a));this.refresh()},x.setRanges=function(a){if(L&&F&&1<a.length)J(this,a);else{this.removeAllRanges();for(var e=0,d=a.length;e<d;++e)this.addRange(a[e])}};else if(y(K,"empty")&&y(X,"select")&&L&&E)x.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=
				this.docSelection.type){var a;if(this.anchorNode)a=Q(this.anchorNode);else if("Control"==this.docSelection.type){var e=this.docSelection.createRange();e.length&&(a=Q(e.item(0)))}a&&(C(a).createTextRange().select(),this.docSelection.empty())}}catch(d){}m(this)},x.addRange=function(e){"Control"==this.docSelection.type?r(this,e):(a.WrappedTextRange.rangeToTextRange(e).select(),this._ranges[0]=e,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,k(this,e,!1))},x.setRanges=function(a){this.removeAllRanges();
				var e=a.length;1<e?J(this,a):e&&this.addRange(a[0])};else return e.fail("No means of selecting a Range or TextRange was found"),!1;x.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new R("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var ga;if(E)ga=function(e){var d;a.isSelectionValid(e.win)?d=e.docSelection.createRange():(d=C(e.win.document).createTextRange(),d.collapse(!0));"Control"==e.docSelection.type?z(e):n(d)?q(e,d):m(e)};else if(y(K,"getRangeAt")&&"number"==typeof K.rangeCount)ga=
				function(e){if(L&&F&&"Control"==e.docSelection.type)z(e);else if(e._ranges.length=e.rangeCount=e.nativeSelection.rangeCount,e.rangeCount){for(var d=0,b=e.rangeCount;d<b;++d)e._ranges[d]=new a.WrappedRange(e.nativeSelection.getRangeAt(d));k(e,e._ranges[e.rangeCount-1],ba(e.nativeSelection));e.isCollapsed=T(e)}else m(e)};else if(V&&"boolean"==typeof K.isCollapsed&&"boolean"==typeof X.collapsed&&P.implementsDomRange)ga=function(a){var e;e=a.nativeSelection;e.anchorNode?(e=ea(e,0),a._ranges=[e],a.rangeCount=
				1,e=a.nativeSelection,a.anchorNode=e.anchorNode,a.anchorOffset=e.anchorOffset,a.focusNode=e.focusNode,a.focusOffset=e.focusOffset,a.isCollapsed=T(a)):m(a)};else return e.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;x.refresh=function(a){var e=a?this._ranges.slice(0):null,d=this.anchorNode,b=this.anchorOffset;ga(this);if(a){a=e.length;if(a!=this._ranges.length||this.anchorNode!=d||this.anchorOffset!=b)return!0;for(;a--;)if(!aa(e[a],this._ranges[a]))return!0;
				return!1}};var na=function(a,e){var d=a.getAllRanges();a.removeAllRanges();for(var b=0,f=d.length;b<f;++b)aa(e,d[b])||a.addRange(d[b]);a.rangeCount||m(a)};x.removeRange=L&&F?function(a){if("Control"==this.docSelection.type){var e=this.docSelection.createRange();a=p(a);for(var d=Q(e.item(0)),d=C(d).createControlRange(),b,f=!1,g=0,h=e.length;g<h;++g)b=e.item(g),b!==a||f?d.add(e.item(g)):f=!0;d.select();z(this)}else na(this,a)}:function(a){na(this,a)};var ba;!E&&V&&P.implementsDomRange?(ba=h,x.isBackward=
				function(){return ba(this)}):ba=x.isBackward=function(){return!1};x.isBackwards=x.isBackward;x.toString=function(){for(var a=[],e=0,d=this.rangeCount;e<d;++e)a[e]=""+this._ranges[e];return a.join("")};x.collapse=function(e,d){v(this,e);var b=a.createRange(e);b.collapseToPoint(e,d);this.setSingleRange(b);this.isCollapsed=!0};x.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new R("INVALID_STATE_ERR");};x.collapseToEnd=function(){if(this.rangeCount){var a=
				this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new R("INVALID_STATE_ERR");};x.selectAllChildren=function(e){v(this,e);var d=a.createRange(e);d.selectNodeContents(e);this.setSingleRange(d)};x.deleteFromDocument=function(){if(L&&F&&"Control"==this.docSelection.type){for(var a=this.docSelection.createRange(),e;a.length;)e=a.item(0),a.remove(e),t.removeNode(e);this.refresh()}else if(this.rangeCount&&(a=this.getAllRanges(),a.length)){this.removeAllRanges();e=0;for(var d=
				a.length;e<d;++e)a[e].deleteContents();this.addRange(a[d-1])}};x.eachRange=function(a,e){for(var d=0,b=this._ranges.length;d<b;++d)if(a(this.getRangeAt(d)))return e};x.getAllRanges=function(){var a=[];this.eachRange(function(e){a.push(e)});return a};x.setSingleRange=function(a,e){this.removeAllRanges();this.addRange(a,e)};x.callMethodOnEachRange=function(a,e){var d=[];this.eachRange(function(b){d.push(b[a].apply(b,e||[]))});return d};x.setStart=u(!0);x.setEnd=u(!1);a.rangePrototype.select=function(a){fa(this.getDocument()).setSingleRange(this,
				a)};x.changeEachRange=function(a){var e=[],d=this.isBackward();this.eachRange(function(d){a(d);e.push(d)});this.removeAllRanges();d&&1==e.length?this.addRange(e[0],"backward"):this.setRanges(e)};x.containsNode=function(a,e){return this.eachRange(function(d){return d.containsNode(a,e)},!0)||!1};x.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}};x.moveToBookmark=function(e){for(var d=[],b=0,f,g;f=e.rangeBookmarks[b++];)g=a.createRange(this.win),
				g.moveToBookmark(f),d.push(g);e.backward?this.setSingleRange(d[0],"backward"):this.setRanges(d)};x.saveRanges=function(){return{backward:this.isBackward(),ranges:this.callMethodOnEachRange("cloneRange")}};x.restoreRanges=function(a){this.removeAllRanges();for(var e=0,d;d=a.ranges[e];++e)this.addRange(d,a.backward&&0==e)};x.toHtml=function(){var a=[];this.eachRange(function(e){a.push(M.toHtml(e))});return a.join("")};P.implementsTextRange&&(x.getNativeTextRange=function(){var d;if(d=this.docSelection){d=
				d.createRange();if(n(d))return d;throw e.createError("getNativeTextRange: selection is a control selection");}if(0<this.rangeCount)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));throw e.createError("getNativeTextRange: selection contains no range");});x.getName=function(){return"WrappedSelection"};x.inspect=function(){return G(this)};x.detach=function(){D(this.win,"delete");w(this)};B.detachAll=function(){D(null,"deleteAll")};B.inspect=G;B.isDirectionBackward=d;a.Selection=B;a.selectionPrototype=
				x;a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return fa(a)});a=null})});var T=!1,J=function(a){T||(T=!0,!y.initialized&&y.config.autoInitialize&&m())};D&&("complete"==document.readyState?J():(a(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",J,!1),R(window,"load",J)));return y},this);
	(function(a,f){"function"==typeof define&&define.amd?define(["./rangy-core"],a):"undefined"!=typeof module&&"object"==typeof exports?module.exports=a(require("rangy")):a(f.rangy)})(function(a){a.createModule("SaveRestore",["WrappedRange"],function(a,g){function b(a,e){var d="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),b,f=p.getDocument(a.startContainer),g=a.cloneRange();g.collapse(e);b=f.createElement("span");b.id=d;b.style.lineHeight="0";b.style.display="none";b.className="rangySelectionBoundary";
		b.appendChild(f.createTextNode("\ufeff"));g.insertNode(b);return b}function d(a,e,d,b){(a=(a||document).getElementById(d))?(e[b?"setStartBefore":"setEndBefore"](a),q(a)):g.warn("Marker element has been removed. Cannot restore selection.")}function k(a,e){return e.compareBoundaryPoints(a.START_TO_START,a)}function h(e,d){var g,h,k=a.DomRange.getRangeDocument(e),m=e.toString(),l=r(d);if(e.collapsed)return h=b(e,!1),{document:k,markerId:h.id,collapsed:!0};h=b(e,!1);g=b(e,!0);return{document:k,startMarkerId:g.id,
		endMarkerId:h.id,collapsed:!1,backward:l,toString:function(){return"original text: '"+m+"', new text: '"+e.toString()+"'"}}}function e(e,b){var h=e.document;"undefined"==typeof b&&(b=!0);var k=a.createRange(h);if(e.collapsed)if(h=(h||document).getElementById(e.markerId)){h.style.display="inline";var m=h.previousSibling;m&&3==m.nodeType?(q(h),k.collapseToPoint(m,m.length)):(k.collapseBefore(h),q(h))}else g.warn("Marker element has been removed. Cannot restore selection.");else d(h,k,e.startMarkerId,
		!0),d(h,k,e.endMarkerId,!1);b&&k.normalizeBoundaries();return k}function m(e,d){var b=[],g,m;g=r(d);e=e.slice(0);e.sort(k);var l=0;for(m=e.length;l<m;++l)b[l]=h(e[l],g);for(l=m-1;0<=l;--l)g=e[l],m=a.DomRange.getRangeDocument(g),g.collapsed?g.collapseAfter((m||document).getElementById(b[l].markerId)):(g.setEndBefore((m||document).getElementById(b[l].endMarkerId)),g.setStartAfter((m||document).getElementById(b[l].startMarkerId)));return b}function l(a){for(var d=[],b=a.length-1;0<=b;b--)d[b]=e(a[b],
		!0);return d}function n(a,e){var d=(a||document).getElementById(e);d&&q(d)}var p=a.dom,q=p.removeNode,r=a.Selection.isDirectionBackward;a.util.extend(a,{saveRange:h,restoreRange:e,saveRanges:m,restoreRanges:l,saveSelection:function(e){if(!a.isSelectionValid(e))return g.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var d=a.getSelection(e),b=d.getAllRanges(),h=1==b.length&&d.isBackward(),k=m(b,h);h?d.setSingleRange(b[0],
		h):d.setRanges(b);return{win:e,rangeInfos:k,restored:!1}},restoreSelection:function(e,d){if(!e.restored){var b=e.rangeInfos,g=a.getSelection(e.win),h=l(b);1==b.length&&d&&a.features.selectionHasExtend&&b[0].backward?(g.removeAllRanges(),g.addRange(h[0],!0)):g.setRanges(h);e.restored=!0}},removeMarkerElement:n,removeMarkers:function(a){for(var e=a.rangeInfos,d=0,b=e.length,f;d<b;++d)f=e[d],f.collapsed?n(a.doc,f.markerId):(n(a.doc,f.startMarkerId),n(a.doc,f.endMarkerId))}})});return a},this);
	var Base=function(){};
	Base.extend=function(a,f){var g=Base.prototype.extend;Base._prototyping=!0;var b=new this;g.call(b,a);b.base=function(){};delete Base._prototyping;var d=b.constructor,k=b.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==k)this._constructing=!0,d.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||g).call(arguments[0],b)};k.ancestor=this;k.extend=this.extend;k.forEach=this.forEach;k.implement=this.implement;k.prototype=
		b;k.toString=this.toString;k.valueOf=function(a){return"object"==a?k:d.valueOf()};g.call(k,f);"function"==typeof k.init&&k.init();return k};
	Base.prototype={extend:function(a,f){if(1<arguments.length){var g=this[a];if(g&&"function"==typeof f&&(!g.valueOf||g.valueOf()!=f.valueOf())&&/\bbase\b/.test(f)){var b=f.valueOf();f=function(){var a=this.base||Base.prototype.base;this.base=g;var e=b.apply(this,arguments);this.base=a;return e};f.valueOf=function(a){return"object"==a?f:b};f.toString=Base.toString}this[a]=f}else if(a){var d=Base.prototype.extend;Base._prototyping||"function"==typeof this||(d=this.extend||d);for(var k={toSource:null},
																																																																																																																										h=["constructor","toString","valueOf"],e=Base._prototyping?0:1;m=h[e++];)a[m]!=k[m]&&d.call(this,m,a[m]);for(var m in a)k[m]||d.call(this,m,a[m])}return this}};
	Base=Base.extend({constructor:function(a){this.extend(a)}},{ancestor:Object,version:"1.1",forEach:function(a,f,g){for(var b in a)void 0===this.prototype[b]&&f.call(g,a[b],b,a)},implement:function(){for(var a=0;a<arguments.length;a++)if("function"==typeof arguments[a])arguments[a](this.prototype);else this.prototype.extend(arguments[a]);return this},toString:function(){return String(this.valueOf())}});
	wysihtml5.browser=function(){function a(a,d){var b=-1,f;"Microsoft Internet Explorer"==navigator.appName?f=/MSIE ([0-9]{1,}[.0-9]{0,})/:"Netscape"==navigator.appName&&(f=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/);f&&null!=f.exec(navigator.userAgent)&&(b=parseFloat(RegExp.$1));if(-1===b)return!1;if(!a)return!0;if(!d)return a===b;if("<"===d)return a<b;if(">"===d)return a>b;if("<="===d)return a<=b;if(">="===d)return a>=b}var f=navigator.userAgent,g=document.createElement("div"),b=-1!==f.indexOf("Gecko")&&
		-1===f.indexOf("KHTML"),d=-1!==f.indexOf("AppleWebKit/"),k=-1!==f.indexOf("Chrome/"),h=-1!==f.indexOf("Opera/");return{USER_AGENT:f,supported:function(){var a=this.USER_AGENT.toLowerCase(),d="contentEditable"in g,b=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,f=document.querySelector&&document.querySelectorAll,h;if(h=this.isIos())h=5>+(/ipad|iphone|ipod/.test(a)&&a.match(/ os (\d+).+? like mac os x/)||[void 0,0])[1];a=h||this.isAndroid()&&4>+(a.match(/android (\d+)/)||
		[void 0,0])[1]||-1!==a.indexOf("opera mobi")||-1!==a.indexOf("hpwos/");return d&&b&&f&&!a},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return a()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return a()},hasCurrentStyleProperty:function(){return"currentStyle"in
		g},insertsLineBreaksOnReturn:function(){return b},supportsPlaceholderAttributeOn:function(a){return"placeholder"in a},supportsEvent:function(a){var d;(d="on"+a in g)||(g.setAttribute("on"+a,"return;"),d="function"===typeof g["on"+a]);return d},supportsEventsInIframeCorrectly:function(){return!h},supportsHTML5Tags:function(a){a=a.createElement("div");a.innerHTML="<article>foo</article>";return"<article>foo</article>"===a.innerHTML.toLowerCase()},supportsCommand:function(){var e={formatBlock:a(10,"<="),
		insertUnorderedList:a(9,">="),insertOrderedList:a(9,">=")},d={insertHTML:b};return function(a,b){if(!e[b]){try{return a.queryCommandSupported(b)}catch(f){}try{return a.queryCommandEnabled(b)}catch(g){return!!d[b]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return a()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return b||h||d},supportsGetAttributeCorrectly:function(){return"1"!=document.createElement("td").getAttribute("rowspan")},
		canSelectImagesInContentEditable:function(){return b||a()||h},autoScrollsToCaret:function(){return!d},autoClosesUnclosedTags:function(){var a=g.cloneNode(!1),d;a.innerHTML="<p><div></div>";a=a.innerHTML.toLowerCase();d="<p></p><div></div>"===a||"<p><div></div></p>"===a;this.autoClosesUnclosedTags=function(){return d};return d},supportsNativeGetElementsByClassName:function(){return-1!==String(document.getElementsByClassName).indexOf("[native code]")},supportsSelectionModify:function(){return"getSelection"in
			window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return h},supportsSpeechApiOn:function(a){return 11<=(f.match(/Chrome\/(\d+)/)||[void 0,0])[1]&&("onwebkitspeechchange"in a||"speech"in a)},crashesWhenDefineProperty:function(e){return a(9)&&("XMLHttpRequest"===e||"XDomainRequest"===e)},doesAsyncFocus:function(){return a()},hasProblemsSettingCaretAfterImg:function(){return a()},hasUndoInContextMenu:function(){return b||k||h},hasInsertNodeIssue:function(){return h},hasIframeFocusIssue:function(){return a()},
		createsNestedInvalidMarkupAfterPaste:function(){return d},supportsMutationEvents:function(){return"MutationEvent"in window},supportsModernPaste:function(){return!("clipboardData"in window)},fixStyleKey:function(a){return"cssFloat"===a?"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat":a}}}();
	wysihtml5.lang.array=function(a){return{contains:function(f){if(Array.isArray(f)){for(var g=f.length;g--;)if(-1!==wysihtml5.lang.array(a).indexOf(f[g]))return!0;return!1}return-1!==wysihtml5.lang.array(a).indexOf(f)},indexOf:function(f){if(a.indexOf)return a.indexOf(f);for(var g=0,b=a.length;g<b;g++)if(a[g]===f)return g;return-1},without:function(f){f=wysihtml5.lang.array(f);for(var g=[],b=0,d=a.length;b<d;b++)f.contains(a[b])||g.push(a[b]);return g},get:function(){for(var f=0,g=a.length,b=[];f<g;f++)b.push(a[f]);
		return b},map:function(f,g){if(Array.prototype.map)return a.map(f,g);for(var b=a.length>>>0,d=Array(b),k=0;k<b;k++)d[k]=f.call(g,a[k],k,a);return d},unique:function(){for(var f=[],g=a.length,b=0;b<g;)wysihtml5.lang.array(f).contains(a[b])||f.push(a[b]),b++;return f}}};
	wysihtml5.lang.Dispatcher=Base.extend({on:function(a,f){this.events=this.events||{};this.events[a]=this.events[a]||[];this.events[a].push(f);return this},off:function(a,f){this.events=this.events||{};var g=0,b,d;if(a){b=this.events[a]||[];for(d=[];g<b.length;g++)b[g]!==f&&f&&d.push(b[g]);this.events[a]=d}else this.events={};return this},fire:function(a,f){this.events=this.events||{};for(var g=this.events[a]||[],b=0;b<g.length;b++)g[b].call(this,f);return this},observe:function(){return this.on.apply(this,
		arguments)},stopObserving:function(){return this.off.apply(this,arguments)}});
	wysihtml5.lang.object=function(a){return{merge:function(f,g){for(var b in f)g&&wysihtml5.lang.object(f[b]).isPlainObject()&&("undefined"===typeof a[b]||wysihtml5.lang.object(a[b]).isPlainObject())?"undefined"===typeof a[b]?a[b]=wysihtml5.lang.object(f[b]).clone(!0):wysihtml5.lang.object(a[b]).merge(wysihtml5.lang.object(f[b]).clone(!0)):a[b]=wysihtml5.lang.object(f[b]).isPlainObject()?wysihtml5.lang.object(f[b]).clone(!0):f[b];return this},difference:function(f){var g={},b;for(b in a)a.hasOwnProperty(b)&&
	(f.hasOwnProperty(b)||(g[b]=a[b]));for(var d in f)f.hasOwnProperty(d)&&(a.hasOwnProperty(d)&&a[d]===f[d]||(g[0]=a[0]));return g},get:function(){return a},clone:function(f){var g={},b;if(null===a||!wysihtml5.lang.object(a).isPlainObject())return a;for(b in a)a.hasOwnProperty(b)&&(g[b]=f?wysihtml5.lang.object(a[b]).clone(f):a[b]);return g},isArray:function(){return"[object Array]"===Object.prototype.toString.call(a)},isFunction:function(){return"[object Function]"===Object.prototype.toString.call(a)},
		isPlainObject:function(){return a&&"[object Object]"===Object.prototype.toString.call(a)&&!("Node"in window?a instanceof Node:a instanceof Element||a instanceof Text)},isEmpty:function(){for(var f in a)if(a.hasOwnProperty(f))return!1;return!0}}};
	(function(){var a=/^\s+/,f=/\s+$/,g=/[&<>\t"]/g,b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&nbsp; "};wysihtml5.lang.string=function(d){d=String(d);return{trim:function(){return d.replace(a,"").replace(f,"")},interpolate:function(a){for(var b in a)d=this.replace("#{"+b+"}").by(a[b]);return d},replace:function(a){return{by:function(b){return d.split(a).join(b)}}},escapeHTML:function(a,f){var e=d.replace(g,function(a){return b[a]});a&&(e=e.replace(/(?:\r\n|\r|\n)/g,"<br />"));f&&(e=e.replace(/  /gi,
		"&nbsp; "));return e}}}})();
	(function(a){function f(a){return a.replace(d,function(a,e){var d=(e.match(k)||[])[1]||"",b=h[d];e=e.replace(k,"");e.split(b).length>e.split(d).length&&(e+=d,d="");var f=b=e;100<e.length&&(f=f.substr(0,100)+"...");"www."===b.substr(0,4)&&(b="http://"+b);return'<a href="'+b+'">'+f+"</a>"+d})}function g(e,h){if(!(b.contains(e.nodeName)||e.className&&a.lang.array(e.className.split(" ")).contains(h)))if(e.nodeType===a.TEXT_NODE&&e.data.match(d)){var k=e.parentNode,n=a.lang.string(e.data).escapeHTML(),p;
		p=k.ownerDocument;var q=p._wysihtml5_tempElement;q||(q=p._wysihtml5_tempElement=p.createElement("div"));p=q;p.innerHTML="<span></span>"+f(n);for(p.removeChild(p.firstChild);p.firstChild;)k.insertBefore(p.firstChild,e);k.removeChild(e)}else{k=a.lang.array(e.childNodes).get();n=k.length;for(p=0;p<n;p++)g(k[p],h);return e}}var b=a.lang.array("CODE PRE A SCRIPT HEAD TITLE STYLE".split(" ")),d=/((https?:\/\/|www\.)[^\s<]{3,})/gi,k=/([^\w\/\-](,?))$/i,h={")":"(","]":"[","}":"{"};a.dom.autoLink=function(e,
																																																																																																																															  d){var f;a:{f=e;for(var h;f.parentNode;){f=f.parentNode;h=f.nodeName;if(f.className&&a.lang.array(f.className.split(" ")).contains(d)||b.contains(h)){f=!0;break a}if("body"===h)break}f=!1}if(f)return e;e===e.ownerDocument.documentElement&&(e=e.ownerDocument.body);return g(e,d)};a.dom.autoLink.URL_REG_EXP=d})(wysihtml5);
	(function(a){var f=a.dom;f.addClass=function(a,b){var d=a.classList;if(d)return d.add(b);f.hasClass(a,b)||(a.className+=" "+b)};f.removeClass=function(a,b){var d=a.classList;if(d)return d.remove(b);a.className=a.className.replace(new RegExp("(^|\\s+)"+b+"(\\s+|$)")," ")};f.hasClass=function(a,b){var d=a.classList;if(d)return d.contains(b);d=a.className;return 0<d.length&&(d==b||(new RegExp("(^|\\s)"+b+"(\\s|$)")).test(d))}})(wysihtml5);
	wysihtml5.dom.contains=function(){var a=document.documentElement;if(a.contains)return function(a,g){if(g.nodeType!==wysihtml5.ELEMENT_NODE){if(g.parentNode===a)return!0;g=g.parentNode}return a!==g&&a.contains(g)};if(a.compareDocumentPosition)return function(a,g){return!!(a.compareDocumentPosition(g)&16)}}();
	wysihtml5.dom.convertToList=function(){function a(a,g){var b=a.createElement("li");g.appendChild(b);return b}return function(f,g,b){if("UL"===f.nodeName||"OL"===f.nodeName||"MENU"===f.nodeName)return f;var d=f.ownerDocument;g=d.createElement(g);var k=f.querySelectorAll("br"),h=k.length,e,m,l,n,p;for(p=0;p<h;p++)for(m=k[p];(e=m.parentNode)&&e!==f&&e.lastChild===m;){if("block"===wysihtml5.dom.getStyle("display").from(e)){e.removeChild(m);break}wysihtml5.dom.insert(m).after(m.parentNode)}e=wysihtml5.lang.array(f.childNodes).get();
		k=e.length;for(p=0;p<k;p++)n=n||a(d,g),h=e[p],m="block"===wysihtml5.dom.getStyle("display").from(h),l="BR"===h.nodeName,!m||b&&wysihtml5.dom.hasClass(h,b)?l?n=n.firstChild?null:n:n.appendChild(h):(n=n.firstChild?a(d,g):n,n.appendChild(h),n=null);0===e.length&&a(d,g);f.parentNode.replaceChild(g,f);return g}}();wysihtml5.dom.copyAttributes=function(a){return{from:function(f){return{to:function(g){for(var b,d=0,k=a.length;d<k;d++)b=a[d],"undefined"!==typeof f[b]&&""!==f[b]&&(g[b]=f[b]);return{andTo:arguments.callee}}}}}};
	(function(a){var f=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],g=function(b){var d;a:{d=0;for(var g=f.length;d<g;d++)if("border-box"===a.getStyle(f[d]).from(b)){d=f[d];break a}d=void 0}return d?parseInt(a.getStyle("width").from(b),10)<b.offsetWidth:!1};a.copyStyles=function(b){return{from:function(d){g(d)&&(b=wysihtml5.lang.array(b).without(f));for(var k="",h=b.length,e=0,m;e<h;e++)m=b[e],k+=m+":"+a.getStyle(m).from(d)+";";return{to:function(e){a.setStyles(k).on(e);return{andTo:arguments.callee}}}}}}})(wysihtml5.dom);
	(function(a){a.dom.delegate=function(a,g,b,d){var k=function(b){for(var e=b.target,e=3===e.nodeType?e.parentNode:e,k=a.querySelectorAll(g),l=0,n=k.length;l<n;l++)k[l].contains(e)&&d.call(k[l],b)};a.addEventListener(b,k,!1);return{stop:function(){a.removeEventListener(b,k,!1)}}}})(wysihtml5);
	(function(a){function f(a,b){for(var d=[a],f=a;b&&f&&f!==b||!b&&f;)d.unshift(f),f=f.parentNode;return d}a.dom.domNode=function(g){var b=[a.ELEMENT_NODE,a.TEXT_NODE];return{is:{emptyTextNode:function(d){d=d?/^\s*$/g:/^[\r\n]*$/g;return g.nodeType===a.TEXT_NODE&&d.test(g.data)},visible:function(){var d=!/^\s*$/g.test(a.dom.getTextContent(g));d||1===g.nodeType&&g.querySelector("img, br, hr, object, embed, canvas, input, textarea")&&(d=!0);return d}},prev:function(d){var f=g.previousSibling;return f?
		!a.lang.array(d&&d.nodeTypes?d.nodeTypes:b).contains(f.nodeType)||d&&d.ignoreBlankTexts&&a.dom.domNode(f).is.emptyTextNode(!0)?a.dom.domNode(f).prev(d):f:null},next:function(d){var f=g.nextSibling;return f?!a.lang.array(d&&d.nodeTypes?d.nodeTypes:b).contains(f.nodeType)||d&&d.ignoreBlankTexts&&a.dom.domNode(f).is.emptyTextNode(!0)?a.dom.domNode(f).next(d):f:null},commonAncestor:function(a,b){var h=f(g,b),e=f(a,b);if(h[0]!=e[0])return null;for(var m=0;m<h.length;m++)if(h[m]!=e[m])return h[m-1];return null},
		lastLeafNode:function(d){var b;if(1!==g.nodeType)return g;b=g.lastChild;if(!b)return g;if(d&&d.leafClasses)for(var f=d.leafClasses.length;f--;)if(a.dom.hasClass(g,d.leafClasses[f]))return g;return a.dom.domNode(b).lastLeafNode(d)},escapeParent:function(d,b){var f,e,m,l=g;if(!a.dom.contains(d,g))throw Error("Child is not a descendant of node.");do{f=l.parentNode;for(e=f.cloneNode(!1);f.lastChild&&f.lastChild!==l;)e.insertBefore(f.lastChild,e.firstChild);f!==d&&(m=f.cloneNode(!1),m.appendChild(l),l=
			m);f.parentNode.insertBefore(l,f.nextSibling);if(""!==e.innerHTML)if(/^\s+$/.test(e.innerHTML))for(;e.lastChild;)f.parentNode.insertBefore(e.lastChild,l.nextSibling);else f.parentNode.insertBefore(e,l.nextSibling);if(""===f.innerHTML)f.parentNode.removeChild(f);else if(/^\s+$/.test(f.innerHTML)){for(;f.firstChild;)f.parentNode.insertBefore(f.firstChild,f);f.parentNode.removeChild(f)}}while(f&&f!==d);b&&l&&(l.parentNode.insertBefore(b,l),b.appendChild(l))},test:function(d){var b;if(!d||1!==g.nodeType||
			d.query&&!g.matches(d.query)||d.nodeName&&g.nodeName!==d.nodeName||d.className&&!g.classList.contains(d.className)||d.classRegExp&&0===((g.className||"").match(d.classRegExp)||[]).length)return!1;if(d.styleProperty&&0<d.styleProperty.length){b=Array.isArray(d.styleProperty)?d.styleProperty:[d.styleProperty];for(var f=b.length;0<f;){b=a.browser.fixStyleKey(b[0]);if(g.style[b])if(d.styleValue)if(d.styleValue instanceof RegExp){if(0<g.style[b].trim().match(d.styleValue).length)break}else if(Array.isArray(d.styleValue)){if(d.styleValue.indexOf(g.style[b].trim()))break}else{if(d.styleValue===
			g.style[b].trim().replace(/, /g,","))break}else break;return!1}}if(d.attribute){b=a.dom.getAttributes(g);var f=[],e=!1;Array.isArray(d.attribute)?f=d.attribute:f[d.attribute]=d.attributeValue;for(var m in f)if(f.hasOwnProperty(m))if("undefined"===typeof f[m]){if("undefined"!==typeof b[m]){e=!0;break}}else if(b[m]===f[m]){e=!0;break}if(!e)return!1}return!0}}}})(wysihtml5);
	wysihtml5.dom.getAsDom=function(){var a="abbr article aside audio bdi canvas command datalist details figcaption figure footer header hgroup keygen mark meter nav output progress rp rt ruby svg section source summary time track video wbr".split(" ");return function(f,g){g=g||document;var b;if("object"===typeof f&&f.nodeType)b=g.createElement("div"),b.appendChild(f);else if(wysihtml5.browser.supportsHTML5Tags(g))b=g.createElement("div"),b.innerHTML=f;else{b=g;if(!b._wysihtml5_supportsHTML5Tags){for(var d=
		0,k=a.length;d<k;d++)b.createElement(a[d]);b._wysihtml5_supportsHTML5Tags=!0}b=g;d=b.createElement("div");d.style.display="none";b.body.appendChild(d);try{d.innerHTML=f}catch(h){}b.body.removeChild(d);b=d}return b}}();wysihtml5.dom.getParentElement=function(){return function(a,f,g,b){for(g=g||50;g--&&a&&"BODY"!==a.nodeName&&(!b||a!==b);){if(wysihtml5.dom.domNode(a).test(f))return a;a=a.parentNode}return null}}();
	wysihtml5.dom.getStyle=function(){function a(a){return a.replace(g,function(a){return a.charAt(1).toUpperCase()})}var f={"float":"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},g=/\-[a-z]/g;return function(b){return{from:function(d){if(d.nodeType===wysihtml5.ELEMENT_NODE){var g=d.ownerDocument,h=f[b]||a(b),e=d.style,m=d.currentStyle,l=e[h];if(l)return l;if(m)try{return m[h]}catch(n){}var h=g.defaultView||g.parentWindow,g=("height"===b||"width"===b)&&"TEXTAREA"===d.nodeName,
		p;if(h.getComputedStyle)return g&&(p=e.overflow,e.overflow="hidden"),d=h.getComputedStyle(d,null).getPropertyValue(b),g&&(e.overflow=p||""),d}}}}}();wysihtml5.dom.getTextNodes=function(a,f){var g=[];for(a=a.firstChild;a;a=a.nextSibling)3==a.nodeType?f&&/^\s*$/.test(a.innerText||a.textContent)||g.push(a):g=g.concat(wysihtml5.dom.getTextNodes(a,f));return g};
	wysihtml5.dom.hasElementWithTagName=function(){var a={},f=1;return function(g,b){var d=(g._wysihtml5_identifier||(g._wysihtml5_identifier=f++))+":"+b,k=a[d];k||(k=a[d]=g.getElementsByTagName(b));return 0<k.length}}();(function(a){var f={},g=1;a.dom.hasElementWithClassName=function(b,d){if(!a.browser.supportsNativeGetElementsByClassName())return!!b.querySelector("."+d);var k=(b._wysihtml5_identifier||(b._wysihtml5_identifier=g++))+":"+d,h=f[k];h||(h=f[k]=b.getElementsByClassName(d));return 0<h.length}})(wysihtml5);
	wysihtml5.dom.insert=function(a){return{after:function(f){f.parentNode.insertBefore(a,f.nextSibling)},before:function(f){f.parentNode.insertBefore(a,f)},into:function(f){f.appendChild(a)}}};wysihtml5.dom.insertCSS=function(a){a=a.join("\n");return{into:function(f){var g=f.createElement("style");g.type="text/css";g.styleSheet?g.styleSheet.cssText=a:g.appendChild(f.createTextNode(a));var b=f.querySelector("head link");b?b.parentNode.insertBefore(g,b):(f=f.querySelector("head"))&&f.appendChild(g)}}};
	(function(a){a.dom.lineBreaks=function(f){function g(b){return"BR"===b.nodeName||"block"===a.dom.getStyle("display").from(b)?!0:!1}return{add:function(b){b=f.ownerDocument;var d=a.dom.domNode(f).next({ignoreBlankTexts:!0}),k=a.dom.domNode(f).prev({ignoreBlankTexts:!0});d&&!g(d)&&a.dom.insert(b.createElement("br")).after(f);k&&!g(k)&&a.dom.insert(b.createElement("br")).before(f)},remove:function(b){b=a.dom.domNode(f).next({ignoreBlankTexts:!0});var d=a.dom.domNode(f).prev({ignoreBlankTexts:!0});b&&
	"BR"===b.nodeName&&b.parentNode.removeChild(b);d&&"BR"===d.nodeName&&d.parentNode.removeChild(d)}}}})(wysihtml5);
	wysihtml5.dom.observe=function(a,f,g){f="string"===typeof f?[f]:f;for(var b,d,k=0,h=f.length;k<h;k++)d=f[k],a.addEventListener?a.addEventListener(d,g,!1):(b=function(e){"target"in e||(e.target=e.srcElement);e.preventDefault=e.preventDefault||function(){this.returnValue=!1};e.stopPropagation=e.stopPropagation||function(){this.cancelBubble=!0};g.call(a,e)},a.attachEvent("on"+d,b));return{stop:function(){for(var e,d=0,h=f.length;d<h;d++)e=f[d],a.removeEventListener?a.removeEventListener(e,g,!1):a.detachEvent("on"+
		e,b)}}};
	wysihtml5.dom.parse=function(a,f){function g(a,d,b,f){var k=a.nodeType,m=a.childNodes,l=m.length,n=h[k],q=0,r;if(f&&1===k&&wysihtml5.dom.hasClass(a,f))return a;n=n&&n(a,b);if(!n){if(!1===n){k=a.ownerDocument.createDocumentFragment();for(q=l;q--;)m[q]&&(r=g(m[q],d,b,f))&&(m[q]===r&&q--,k.insertBefore(r,k.firstChild));d=wysihtml5.dom.getStyle("display").from(a);""===d&&(d=wysihtml5.lang.array(p).contains(a.tagName)?"block":"");wysihtml5.lang.array(["block","flex","table"]).contains(d)&&k.appendChild(a.ownerDocument.createElement("br"));wysihtml5.lang.array("div pre p table td th ul ol li dd dl footer header section h1 h2 h3 h4 h5 h6".split(" ")).contains(a.nodeName.toLowerCase())&&
	a.parentNode.lastChild!==a&&(a.nextSibling&&3===a.nextSibling.nodeType&&/^\s/.test(a.nextSibling.nodeValue)||k.appendChild(a.ownerDocument.createTextNode(" ")));k.normalize&&k.normalize();return k}return null}for(q=0;q<l;q++)m[q]&&(r=g(m[q],d,b,f))&&(m[q]===r&&q--,n.appendChild(r));if(d&&n.nodeName.toLowerCase()===e&&(!n.childNodes.length||/^\s*$/gi.test(n.innerHTML)&&(b||"_wysihtml5-temp-placeholder"!==a.className&&"rangySelectionBoundary"!==a.className)||!n.attributes.length)){for(k=n.ownerDocument.createDocumentFragment();n.firstChild;)k.appendChild(n.firstChild);
		k.normalize&&k.normalize();return k}n.normalize&&n.normalize();return n}function b(a,e){var d=a.getAttribute("class"),b=a.getAttribute("style"),f,g,h;if(e.methods)for(f in e.methods)if(e.methods.hasOwnProperty(f)&&u[f]&&u[f](a))return!0;if(d&&e.classes){d=d.replace(/^\s+/g,"").replace(/\s+$/g,"").split(m);f=d.length;for(var k=0;k<f;k++)if(e.classes[d[k]])return!0}if(b&&e.styles)for(g in b=b.split(";"),e.styles)if(e.styles.hasOwnProperty(g))for(f=b.length;f--;)if(d=b[f].split(":"),d[0].replace(/\s/g,
			"").toLowerCase()===g&&(!0===e.styles[g]||1===e.styles[g]||wysihtml5.lang.array(e.styles[g]).contains(d[1].replace(/\s/g,"").toLowerCase())))return!0;if(e.attrs)for(h in e.attrs)if(e.attrs.hasOwnProperty(h)&&(b=wysihtml5.dom.getAttribute(a,h),"string"===typeof b&&-1<b.search(e.attrs[h])))return!0;return!1}function d(a,e,d,b){if(a=wysihtml5.lang.object(d).isFunction()?d:q[d])if(e=a(e,b),"string"===typeof e)return e;return!1}function k(a,e){var b=wysihtml5.lang.object(n.attributes||{}).clone(),b=wysihtml5.lang.object(b).merge(wysihtml5.lang.object(e||
		{}).clone()).get(),f={},g=wysihtml5.dom.getAttributes(a),h,k,m;for(h in b)if(/\*$/.test(h)){k=h.slice(0,-1);m=g;var l=[],p=void 0;for(p in m)m.hasOwnProperty(p)&&0===p.indexOf(k)&&l.push(p);m=l;l=0;for(p=m.length;l<p;l++)k=d(m[l],g[m[l]],b[h],a.nodeName),!1!==k&&(f[m[l]]=k)}else k=d(h,g[h],b[h],a.nodeName),!1!==k&&(f[h]=k);return f}var h={1:function(a,d){var f,g;f=n.tags;g=a.nodeName.toLowerCase();var h=a.scopeName,l;if(a._wysihtml5)return null;a._wysihtml5=1;if("wysihtml5-temp"===a.className)return null;
			h&&"HTML"!=h&&(g=h+":"+g);"outerHTML"in a&&(wysihtml5.browser.autoClosesUnclosedTags()||"P"!==a.nodeName||"</p>"===a.outerHTML.slice(-4).toLowerCase()||(g="div"));if(g in f){f=f[g];if(!f||f.remove)return null;if(f.unwrap)return!1;f="string"===typeof f?{rename_tag:f}:f}else if(a.firstChild)f={rename_tag:e};else return null;if(h=f.one_of_type){var p;a:{var h=n,q=f.one_of_type,u;if("SPAN"!==a.nodeName||d||"_wysihtml5-temp-placeholder"!==a.className&&"rangySelectionBoundary"!==a.className){for(p in q)if(q.hasOwnProperty(p)&&
				h.type_definitions&&h.type_definitions[p]&&(u=h.type_definitions[p],b(a,u))){p=!0;break a}p=!1}else p=!0}h=!p}if(h)if(f.remove_action){if("unwrap"===f.remove_action)return!1;if("rename"===f.remove_action)l=f.remove_action_rename_to||e;else return null}else return null;g=a.ownerDocument.createElement(l||f.rename_tag||g);var t=f;l={};var R=t.set_class,N=t.add_class,H=t.add_style,T=t.set_attributes;p=n.classes;h=0;q=[];u=[];var ca=[],ia=[],O;T&&(l=wysihtml5.lang.object(T).clone());l=wysihtml5.lang.object(l).merge(k(a,
				t.check_attributes)).get();R&&q.push(R);if(N)for(O in N)if(t=v[N[O]])t=t(wysihtml5.dom.getAttribute(a,O)),"string"===typeof t&&q.push(t);if(H)for(O in H)if(t=r[H[O]])newStyle=t(wysihtml5.dom.getAttribute(a,O)),"string"===typeof newStyle&&u.push(newStyle);if("string"===typeof p&&"any"===p&&a.getAttribute("class"))if(n.classes_blacklist){(ia=a.getAttribute("class"))&&(q=q.concat(ia.split(m)));for(N=q.length;h<N;h++)H=q[h],n.classes_blacklist[H]||ca.push(H);ca.length&&(l["class"]=wysihtml5.lang.array(ca).unique().join(" "))}else l["class"]=
				a.getAttribute("class");else{d||(p["_wysihtml5-temp-placeholder"]=1,p._rangySelectionBoundary=1,p["wysiwyg-tmp-selected-cell"]=1);(ia=a.getAttribute("class"))&&(q=q.concat(ia.split(m)));for(N=q.length;h<N;h++)H=q[h],p[H]&&ca.push(H);ca.length&&(l["class"]=wysihtml5.lang.array(ca).unique().join(" "))}l["class"]&&d&&(l["class"]=l["class"].replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(l["class"])&&delete l["class"]);u.length&&(l.style=wysihtml5.lang.array(u).unique().join(" "));for(O in l)try{g.setAttribute(O,
				l[O])}catch(ra){}l.src&&("undefined"!==typeof l.width&&g.setAttribute("width",l.width),"undefined"!==typeof l.height&&g.setAttribute("height",l.height));O=f;var W;if(O&&O.keep_styles)for(W in O.keep_styles)O.keep_styles.hasOwnProperty(W)&&(f="float"===W?a.style.styleFloat||a.style.cssFloat:a.style[W],O.keep_styles[W]instanceof RegExp&&!O.keep_styles[W].test(f)||("float"===W?g.style[a.style.styleFloat?"styleFloat":"cssFloat"]=f:a.style[W]&&(g.style[W]=f)));g.normalize&&g.normalize();return g},3:function(a){var e=
			a.nextSibling;if(e&&e.nodeType===wysihtml5.TEXT_NODE)e.data=a.data.replace(wysihtml5.INVISIBLE_SPACE_REG_EXP,"")+e.data.replace(wysihtml5.INVISIBLE_SPACE_REG_EXP,"");else return e=a.data.replace(wysihtml5.INVISIBLE_SPACE_REG_EXP,""),a.ownerDocument.createTextNode(e)},8:function(a){if(n.comments)return a.ownerDocument.createComment(a.nodeValue)}},e="span",m=/\s+/,l={tags:{},classes:{}},n={},p="ADDRESS BLOCKQUOTE CENTER DIR DIV DL FIELDSET FORM H1 H2 H3 H4 H5 H6 ISINDEX MENU NOFRAMES NOSCRIPT OL P PRE TABLE UL".split(" "),
		q={url:function(){var a=/^https?:\/\//i;return function(e){return e&&e.match(a)?e.replace(a,function(a){return a.toLowerCase()}):null}}(),src:function(){var a=/^(\/|https?:\/\/)/i;return function(e){return e&&e.match(a)?e.replace(a,function(a){return a.toLowerCase()}):null}}(),href:function(){var a=/^(#|\/|https?:\/\/|mailto:|tel:)/i;return function(e){return e&&e.match(a)?e.replace(a,function(a){return a.toLowerCase()}):null}}(),alt:function(){var a=/[^ a-z0-9_\-]/gi;return function(e,d){return e?
			e.replace(a,""):"IMG"===d?"":null}}(),numbers:function(){var a=/\D/g;return function(e){return(e=(e||"").replace(a,""))||null}}(),dimension:function(){var a=/\D*(\d+)(\.\d+)?\s?(%)?\D*/;return function(e){return(e=(e||"").replace(a,"$1$2$3"))||null}}(),any:function(){return function(a){return a?a:null}}()},r={align_text:function(){var a={left:"text-align: left;",right:"text-align: right;",center:"text-align: center;"};return function(e){return a[String(e).toLowerCase()]}}()},v={align_img:function(){var a=
		{left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(e){return a[String(e).toLowerCase()]}}(),align_text:function(){var a={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(e){return a[String(e).toLowerCase()]}}(),clear_br:function(){var a={left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(e){return a[String(e).toLowerCase()]}}(),
			size_font:function(){var a={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(e){return a[String(e).charAt(0)]}}()},u={has_visible_contet:function(){var a,e="img video picture br script noscript style table iframe object embed audio svg input button select textarea canvas".split(" ");
			return function(d){if((a=(d.innerText||d.textContent).replace(/\s/g,""))&&0<a.length)return!0;for(var b=e.length;b--;)if(d.querySelector(e[b]))return!0;return d.offsetWidth&&0<d.offsetWidth&&d.offsetHeight&&0<d.offsetHeight?!0:!1}}()},t={unwrap:function(a){wysihtml5.dom.unwrap(a)},remove:function(a){a.parentNode.removeChild(a)}};return function(a,e){wysihtml5.lang.object(n).merge(l).merge(e.rules).get();var d=e.context||a.ownerDocument||document,b=d.createDocumentFragment(),f="string"===typeof a,
		h=!1,k,m;!0===e.clearInternals&&(h=!0);d=f?wysihtml5.dom.getAsDom(a,d):a;if(n.selectors){var p=n.selectors,q;for(k in p)if(p.hasOwnProperty(k)){wysihtml5.lang.object(p[k]).isFunction()?m=p[k]:"string"===typeof p[k]&&t[p[k]]&&(m=t[p[k]]);q=d.querySelectorAll(k);for(var r=q.length;r--;)m(q[r])}}for(;d.firstChild;)m=d.firstChild,(k=g(m,e.cleanUp,h,e.uneditableClass))&&b.appendChild(k),m!==k&&d.removeChild(m);if(e.unjoinNbsps)for(h=wysihtml5.dom.getTextNodes(b),k=h.length;k--;)h[k].nodeValue=h[k].nodeValue.replace(/([\S\u00A0])\u00A0/gi,
		"$1 ");d.innerHTML="";d.appendChild(b);return f?wysihtml5.quirks.getCorrectInnerHTML(d):d}(a,f)};wysihtml5.dom.removeEmptyTextNodes=function(a){for(var f=wysihtml5.lang.array(a.childNodes).get(),g=f.length,b=0;b<g;b++)a=f[b],a.nodeType===wysihtml5.TEXT_NODE&&/^[\n\r]*$/.test(a.data)&&a.parentNode.removeChild(a)};
	wysihtml5.dom.renameElement=function(a,f){for(var g=a.ownerDocument.createElement(f),b;b=a.firstChild;)g.appendChild(b);wysihtml5.dom.copyAttributes(["align","className"]).from(a).to(g);a.parentNode&&a.parentNode.replaceChild(g,a);return g};wysihtml5.dom.replaceWithChildNodes=function(a){if(a.parentNode)if(a.firstChild){for(var f=a.ownerDocument.createDocumentFragment();a.firstChild;)f.appendChild(a.firstChild);a.parentNode.replaceChild(f,a)}else a.parentNode.removeChild(a)};
	(function(a){function f(b){return"block"===a.getStyle("display").from(b)}function g(a){var d=a.ownerDocument.createElement("br");a.appendChild(d)}a.resolveList=function(a,d){if(a.nodeName.match(/^(MENU|UL|OL)$/)){var k=a.ownerDocument,h=k.createDocumentFragment(),e=wysihtml5.dom.domNode(a).prev({ignoreBlankTexts:!0}),m=wysihtml5.dom.domNode(a).next({ignoreBlankTexts:!0}),l,n,p=a.lastElementChild||a.lastChild,q;if(d)for(e&&!f(e)&&"BR"!==e.nodeName&&g(h);n=a.firstElementChild||a.firstChild;){k=n.lastChild;
		for(q=n===p;e=n.firstChild;)l=e===k,l=(!q||m&&!f(m))&&l&&!f(e)&&"BR"!==e.nodeName,h.appendChild(e),l&&g(h);n.parentNode.removeChild(n)}else for(;n=a.firstElementChild||a.firstChild;){if(n.querySelector&&n.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;e=n.firstChild;)h.appendChild(e);else{for(m=k.createElement("p");e=n.firstChild;)m.appendChild(e);h.appendChild(m)}n.parentNode.removeChild(n)}a.parentNode.replaceChild(h,a)}}})(wysihtml5.dom);
	(function(a){var f=document,g="parent top opener frameElement frames localStorage globalStorage sessionStorage indexedDB".split(" "),b="open close openDialog showModalDialog alert confirm prompt openDatabase postMessage XMLHttpRequest XDomainRequest".split(" "),d=["referrer","write","open","close"];a.dom.Sandbox=Base.extend({constructor:function(d,b){this.callback=d||a.EMPTY_FUNCTION;this.config=a.lang.object({}).merge(b).get();this.config.className||(this.config.className="wysihtml5-sandbox");this.editableArea=
		this._createIframe()},insertInto:function(a){"string"===typeof a&&(a=f.getElementById(a));a.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var a=this.getIframe();a.parentNode.removeChild(a)},_readyError:function(){throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet");},_createIframe:function(){var d=this,b=f.createElement("iframe");b.className=this.config.className;
		a.dom.setAttributes({security:"restricted",allowtransparency:"true",frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(b);a.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(b.src="javascript:'<html></html>'");b.onload=function(){b.onreadystatechange=b.onload=null;d._onLoadIframe(b)};b.onreadystatechange=function(){/loaded|complete/.test(b.readyState)&&(b.onreadystatechange=b.onload=null,d._onLoadIframe(b))};return b},_onLoadIframe:function(k){if(a.dom.contains(f.documentElement,
			k)){var h=this,e=k.contentWindow,m=k.contentWindow.document,l=this._getHtml({charset:f.characterSet||f.charset||"utf-8",stylesheets:this.config.stylesheets});m.open("text/html","replace");m.write(l);m.close();this.getWindow=function(){return k.contentWindow};this.getDocument=function(){return k.contentWindow.document};e.onerror=function(a,e,d){throw Error("wysihtml5.Sandbox: "+a,e,d);};if(!a.browser.supportsSandboxedIframes()){var n,l=0;for(n=g.length;l<n;l++)this._unset(e,g[l]);l=0;for(n=b.length;l<
	n;l++)this._unset(e,b[l],a.EMPTY_FUNCTION);l=0;for(n=d.length;l<n;l++)this._unset(m,d[l]);this._unset(m,"cookie","",!0)}a.polyfills&&a.polyfills(e,m);this.loaded=!0;setTimeout(function(){h.callback(h)},0)}},_getHtml:function(d){var b=d.stylesheets,e="",f=0,g;if(b="string"===typeof b?[b]:b)for(g=b.length;f<g;f++)e+='<link rel="stylesheet" href="'+b[f]+'">';d.stylesheets=e;return a.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(d)},
		_unset:function(d,b,e,f){try{d[b]=e}catch(g){}try{d.__defineGetter__(b,function(){return e})}catch(n){}if(f)try{d.__defineSetter__(b,function(){})}catch(p){}if(!a.browser.crashesWhenDefineProperty(b))try{var q={get:function(){return e}};f&&(q.set=function(){});Object.defineProperty(d,b,q)}catch(r){}}})})(wysihtml5);
	(function(a){var f=document;a.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView||this.element.ownerDocument.parentWindow},getDocument:function(){return this.element.ownerDocument},constructor:function(f,b,d){this.callback=f||a.EMPTY_FUNCTION;this.config=a.lang.object({}).merge(b).get();this.config.className||(this.config.className="wysihtml5-sandbox");this.element=d?this._bindElement(d):this._createElement()},
		_createElement:function(){var a=f.createElement("div");a.className=this.config.className;this._loadElement(a);return a},_bindElement:function(a){a.className=a.className?a.className+" wysihtml5-sandbox":"wysihtml5-sandbox";this._loadElement(a,!0);return a},_loadElement:function(a,b){var d=this;if(!b){var f=this._getHtml();a.innerHTML=f}this.loaded=!0;setTimeout(function(){d.callback(d)},0)},_getHtml:function(a){return""}})})(wysihtml5);
	(function(){var a={className:"class"};wysihtml5.dom.setAttributes=function(f){return{on:function(g){for(var b in f)g.setAttribute(a[b]||b,f[b])}}}})();wysihtml5.dom.setStyles=function(a){return{on:function(f){f=f.style;if("string"===typeof a)f.cssText+=";"+a;else for(var g in a)"float"===g?(f.cssFloat=a[g],f.styleFloat=a[g]):f[g]=a[g]}}};
	(function(a){a.simulatePlaceholder=function(f,g,b,d){var k=d||"wysihtml5-placeholder";d=function(){var e=0<g.element.offsetWidth&&0<g.element.offsetHeight;g.hasPlaceholderSet()&&(g.clear(),g.element.focus(),e&&setTimeout(function(){var a=g.selection.getSelection();a.focusNode&&a.anchorNode||g.selection.selectNode(g.element.firstChild||g.element)},0));g.placeholderSet=!1;a.removeClass(g.element,k)};var h=function(){g.isEmpty()&&!g.placeholderSet&&(g.placeholderSet=!0,g.setValue(b),a.addClass(g.element,
		k))};f.on("set_placeholder",h).on("unset_placeholder",d).on("focus:composer",d).on("paste:composer",d).on("blur:composer",h);h()}})(wysihtml5.dom);(function(a){var f=document.documentElement;"textContent"in f?(a.setTextContent=function(a,b){a.textContent=b},a.getTextContent=function(a){return a.textContent}):"innerText"in f?(a.setTextContent=function(a,b){a.innerText=b},a.getTextContent=function(a){return a.innerText}):(a.setTextContent=function(a,b){a.nodeValue=b},a.getTextContent=function(a){return a.nodeValue})})(wysihtml5.dom);
	wysihtml5.dom.getAttribute=function(a,f){var g=!wysihtml5.browser.supportsGetAttributeCorrectly();f=f.toLowerCase();return"IMG"==a.nodeName&&"src"==f&&!0===wysihtml5.dom.isLoadedImage(a)?a.src:g&&"outerHTML"in a?-1!=a.outerHTML.toLowerCase().indexOf(" "+f+"=")?a.getAttribute(f):null:a.getAttribute(f)};
	wysihtml5.dom.getAttributes=function(a){var f=!wysihtml5.browser.supportsGetAttributeCorrectly(),g=a.nodeName,b=[],d;for(d in a.attributes)(a.attributes.hasOwnProperty&&a.attributes.hasOwnProperty(d)||!a.attributes.hasOwnProperty&&Object.prototype.hasOwnProperty.call(a.attributes,d))&&a.attributes[d].specified&&("IMG"==g&&"src"==a.attributes[d].name.toLowerCase()&&!0===wysihtml5.dom.isLoadedImage(a)?b.src=a.src:wysihtml5.lang.array(["rowspan","colspan"]).contains(a.attributes[d].name.toLowerCase())&&
	f?1!==a.attributes[d].value&&(b[a.attributes[d].name]=a.attributes[d].value):b[a.attributes[d].name]=a.attributes[d].value);return b};wysihtml5.dom.isLoadedImage=function(a){try{return a.complete&&!a.mozMatchesSelector(":-moz-broken")}catch(f){if(a.complete&&"complete"===a.readyState)return!0}};
	(function(a){function f(a,d){for(var b=[],f,g=0,h=a.length;g<h;g++)if(f=a[g].querySelectorAll(d))for(var k=f.length;k--;b.unshift(f[k]));return b}function g(a){a.parentNode.removeChild(a)}function b(a,d){a.parentNode.insertBefore(d,a.nextSibling)}var d=a.dom,k=function(a){this.el=a;this.isRowspan=this.isColspan=!1;this.isReal=this.lastRow=this.firstRow=this.lastCol=this.firstCol=!0;this.spanCollection=[];this.modified=!1},h=function(a,b){a?(this.cell=a,this.table=d.getParentElement(a,{query:"table"})):
	b&&(this.table=b,this.cell=this.table.querySelectorAll("th, td")[0])};h.prototype={addSpannedCellToMap:function(a,d,b,f,g,h){for(var r=[],v=b+(h?parseInt(h,10)-1:0),u=f+(g?parseInt(g,10)-1:0),t=b;t<=v;t++){"undefined"==typeof d[t]&&(d[t]=[]);for(var w=f;w<=u;w++)d[t][w]=new k(a),d[t][w].isColspan=g&&1<parseInt(g,10),d[t][w].isRowspan=h&&1<parseInt(h,10),d[t][w].firstCol=w==f,d[t][w].lastCol=w==u,d[t][w].firstRow=t==b,d[t][w].lastRow=t==v,d[t][w].isReal=w==f&&t==b,d[t][w].spanCollection=r,r.push(d[t][w])}},
		setCellAsModified:function(a){a.modified=!0;if(0<a.spanCollection.length)for(var d=0,b=a.spanCollection.length;d<b;d++)a.spanCollection[d].modified=!0},setTableMap:function(){var a=[],b=this.getTableRows(),f,g,h,q,r,v,u;for(f=0;f<b.length;f++)for(g=b[f],g=this.getRowCells(g),r=0,"undefined"==typeof a[f]&&(a[f]=[]),h=0;h<g.length;h++){for(q=g[h];"undefined"!=typeof a[f][r];)r++;v=d.getAttribute(q,"colspan");u=d.getAttribute(q,"rowspan");v||u?(this.addSpannedCellToMap(q,a,f,r,v,u),r+=v?parseInt(v,10):
			1):(a[f][r]=new k(q),r++)}return this.map=a},getRowCells:function(e){var d=this.table.querySelectorAll("table"),d=d?f(d,"th, td"):[];e=e.querySelectorAll("th, td");return 0<d.length?a.lang.array(e).without(d):e},getTableRows:function(){var e=this.table.querySelectorAll("table"),e=e?f(e,"tr"):[],d=this.table.querySelectorAll("tr");return 0<e.length?a.lang.array(d).without(e):d},getMapIndex:function(a){for(var d=this.map.length,b=this.map&&this.map[0]?this.map[0].length:0,f=0;f<d;f++)for(var g=0;g<
		b;g++)if(this.map[f][g].el===a)return{row:f,col:g};return!1},getElementAtIndex:function(a){this.setTableMap();return this.map[a.row]&&this.map[a.row][a.col]&&this.map[a.row][a.col].el?this.map[a.row][a.col].el:null},getMapElsTo:function(a){var d=[];this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(a);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,
			this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);if(null!=this.idx_start&&null!=this.idx_end){a=this.idx_start.row;for(var b=this.idx_end.row;a<=b;a++)for(var f=this.idx_start.col,g=this.idx_end.col;f<=g;f++)d.push(this.map[a][f].el)}return d},orderSelectionEnds:function(a){this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(a);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==
			this.idx_end.row&&this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(a,d,b){for(var f=this.table.ownerDocument,g=f.createDocumentFragment(),h,k=0;k<d;k++){h=f.createElement(a);if(b)for(var v in b)b.hasOwnProperty(v)&&
		h.setAttribute(v,b[v]);h.appendChild(document.createTextNode("\u00a0"));g.appendChild(h)}return g},correctColIndexForUnreals:function(a,d){for(var b=this.map[d],f=-1,g=0;g<a;g++)b[g].isReal&&f++;return f},getLastNewCellOnRow:function(a,d){for(var b=this.getRowCells(a),f,g,h=0,k=b.length;h<k;h++)if(f=b[h],g=this.getMapIndex(f),!1===g||"undefined"!=typeof d&&g.row!=d)return f;return null},removeEmptyTable:function(){var a=this.table.querySelectorAll("td, th");if(a&&0!=a.length)return!1;g(this.table);
			return!0},splitRowToCells:function(a){if(a.isColspan){var f=parseInt(d.getAttribute(a.el,"colspan")||1,10),g=a.el.tagName.toLowerCase();1<f&&(f=this.createCells(g,f-1),b(a.el,f));a.el.removeAttribute("colspan")}},getRealRowEl:function(a,b){var f=null,g=null;b=b||this.idx;for(var h=0,k=this.map[b.row].length;h<k;h++)if(g=this.map[b.row][h],g.isReal&&(f=d.getParentElement(g.el,{query:"tr"})))return f;null===f&&a&&(f=d.getParentElement(this.map[b.row][b.col].el,{query:"tr"})||null);return f},injectRowAt:function(a,
																																																																																																																																			   f,g,h,k){var q=this.getRealRowEl(!1,{row:a,col:f});g=this.createCells(h,g);q?(k=this.correctColIndexForUnreals(f,a),0<=k?b(this.getRowCells(q)[k],g):q.insertBefore(g,q.firstChild)):(q=this.table.ownerDocument.createElement("tr"),q.appendChild(g),b(d.getParentElement(k.el,{query:"tr"}),q))},canMerge:function(a){this.to=a;this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(this.to);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&
			this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);a=this.idx_start.row;for(var d=this.idx_end.row;a<=d;a++)for(var b=this.idx_start.col,f=this.idx_end.col;b<=f;b++)if(this.map[a][b].isColspan||this.map[a][b].isRowspan)return!1;return!0},decreaseCellSpan:function(a,b){var f=parseInt(d.getAttribute(a.el,b),10)-1;1<=f?a.el.setAttribute(b,f):
			(a.el.removeAttribute(b),"colspan"==b&&(a.isColspan=!1),"rowspan"==b&&(a.isRowspan=!1),a.firstCol=!0,a.lastCol=!0,a.firstRow=!0,a.lastRow=!0,a.isReal=!0)},removeSurplusLines:function(){var a,b,f,h,k,q,r;this.setTableMap();if(this.map){f=0;for(h=this.map.length;f<h;f++){a=this.map[f];r=!0;k=0;for(q=a.length;k<q;k++)if(b=a[k],!(d.getAttribute(b.el,"rowspan")&&1<parseInt(d.getAttribute(b.el,"rowspan"),10)&&!0!==b.firstRow)){r=!1;break}if(r)for(k=0;k<q;k++)this.decreaseCellSpan(a[k],"rowspan")}b=this.getTableRows();
			f=0;for(h=b.length;f<h;f++)a=b[f],0==a.childNodes.length&&/^\s*$/.test(a.textContent||a.innerText)&&g(a)}},fillMissingCells:function(){var a=0,d=0,f=null;this.setTableMap();if(this.map){a=this.map.length;for(f=0;f<a;f++)this.map[f].length>d&&(d=this.map[f].length);for(var g=0;g<a;g++)for(var h=0;h<d;h++)this.map[g]&&!this.map[g][h]&&0<h&&(this.map[g][h]=new k(this.createCells("td",1)),(f=this.map[g][h-1])&&f.el&&f.el.parent&&b(this.map[g][h-1].el,this.map[g][h].el))}},rectify:function(){if(this.removeEmptyTable())return!1;
			this.removeSurplusLines();this.fillMissingCells();return!0},unmerge:function(){if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell))){var a=this.map[this.idx.row][this.idx.col],b=d.getAttribute(a.el,"colspan")?parseInt(d.getAttribute(a.el,"colspan"),10):1,f=a.el.tagName.toLowerCase();if(a.isRowspan){var g=parseInt(d.getAttribute(a.el,"rowspan"),10);if(1<g)for(var h=1,g=g-1;h<=g;h++)this.injectRowAt(this.idx.row+h,this.idx.col,b,f,a);a.el.removeAttribute("rowspan")}this.splitRowToCells(a)}},
		merge:function(a){if(this.rectify())if(this.canMerge(a)){a=this.idx_end.row-this.idx_start.row+1;for(var d=this.idx_end.col-this.idx_start.col+1,b=this.idx_start.row,f=this.idx_end.row;b<=f;b++)for(var h=this.idx_start.col,k=this.idx_end.col;h<=k;h++)b==this.idx_start.row&&h==this.idx_start.col?(1<a&&this.map[b][h].el.setAttribute("rowspan",a),1<d&&this.map[b][h].el.setAttribute("colspan",d)):(/^\s*<br\/?>\s*$/.test(this.map[b][h].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=
			" "+this.map[b][h].el.innerHTML),g(this.map[b][h].el));this.rectify()}else window.console&&console.log("Do not know how to merge allready merged cells.")},collapseCellToNextRow:function(a){var f=this.getMapIndex(a.el),g=f.row+1,h={row:g,col:f.col};g<this.map.length&&(f=this.getRealRowEl(!1,h),null!==f&&(h=this.correctColIndexForUnreals(h.col,h.row),0<=h?b(this.getRowCells(f)[h],a.el):(g=this.getLastNewCellOnRow(f,g),null!==g?b(g,a.el):f.insertBefore(a.el,f.firstChild)),2<parseInt(d.getAttribute(a.el,
			"rowspan"),10)?a.el.setAttribute("rowspan",parseInt(d.getAttribute(a.el,"rowspan"),10)-1):a.el.removeAttribute("rowspan")))},removeRowCell:function(a){a.isReal?a.isRowspan?this.collapseCellToNextRow(a):g(a.el):2<parseInt(d.getAttribute(a.el,"rowspan"),10)?a.el.setAttribute("rowspan",parseInt(d.getAttribute(a.el,"rowspan"),10)-1):a.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var a=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var d=this.map[this.idx.row],
																																																																																																																												  b=0,f=d.length;b<f;b++)d[b].isReal&&a.push(d[b].el);return a},getColumnElementsByCell:function(){var a=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var d=0,b=this.map.length;d<b;d++)this.map[d][this.idx.col]&&this.map[d][this.idx.col].isReal&&a.push(this.map[d][this.idx.col].el);return a},removeRow:function(){var a=d.getParentElement(this.cell,{query:"tr"});if(a){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var b=this.map[this.idx.row],
																																																																																																																																																																																																																																																					f=0,h=b.length;f<h;f++)b[f].modified||(this.setCellAsModified(b[f]),this.removeRowCell(b[f]));g(a)}},removeColCell:function(a){a.isColspan?2<parseInt(d.getAttribute(a.el,"colspan"),10)?a.el.setAttribute("colspan",parseInt(d.getAttribute(a.el,"colspan"),10)-1):a.el.removeAttribute("colspan"):a.isReal&&g(a.el)},removeColumn:function(){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var a=0,d=this.map.length;a<d;a++)this.map[a][this.idx.col].modified||(this.setCellAsModified(this.map[a][this.idx.col]),
			this.removeColCell(this.map[a][this.idx.col]))},remove:function(a){if(this.rectify()){switch(a){case "row":this.removeRow();break;case "column":this.removeColumn()}this.rectify()}},addRow:function(a){var f=this.table.ownerDocument;this.setTableMap();this.idx=this.getMapIndex(this.cell);"below"==a&&d.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(d.getAttribute(this.cell,"rowspan"),10)-1);if(!1!==this.idx){for(var g=this.map[this.idx.row],f=f.createElement("tr"),h=0,k=g.length;h<
		k;h++)g[h].modified||(this.setCellAsModified(g[h]),this.addRowCell(g[h],f,a));switch(a){case "below":b(this.getRealRowEl(!0),f);break;case "above":(a=d.getParentElement(this.map[this.idx.row][this.idx.col].el,{query:"tr"}))&&a.parentNode.insertBefore(f,a)}}},addRowCell:function(a,b,f){var g=a.isColspan?{colspan:d.getAttribute(a.el,"colspan")}:null;a.isReal?"above"!=f&&a.isRowspan?a.el.setAttribute("rowspan",parseInt(d.getAttribute(a.el,"rowspan"),10)+1):b.appendChild(this.createCells("td",1,g)):"above"!=
		f&&a.isRowspan&&a.lastRow?b.appendChild(this.createCells("td",1,g)):c.isRowspan&&a.el.attr("rowspan",parseInt(d.getAttribute(a.el,"rowspan"),10)+1)},add:function(a){this.rectify()&&("below"!=a&&"above"!=a||this.addRow(a),"before"!=a&&"after"!=a||this.addColumn(a))},addColCell:function(a,f,g){var h,k=a.el.tagName.toLowerCase();switch(g){case "before":h=!a.isColspan||a.firstCol;break;case "after":h=!a.isColspan||a.lastCol||a.isColspan&&c.el==this.cell}if(h){switch(g){case "before":a.el.parentNode.insertBefore(this.createCells(k,
			1),a.el);break;case "after":b(a.el,this.createCells(k,1))}a.isRowspan&&this.handleCellAddWithRowspan(a,f+1,g)}else a.el.setAttribute("colspan",parseInt(d.getAttribute(a.el,"colspan"),10)+1)},addColumn:function(a){var b;this.setTableMap();this.idx=this.getMapIndex(this.cell);"after"==a&&d.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(d.getAttribute(this.cell,"colspan"),10)-1);if(!1!==this.idx)for(var f=0,g=this.map.length;f<g;f++)b=this.map[f],b[this.idx.col]&&(b=b[this.idx.col],
		b.modified||(this.setCellAsModified(b),this.addColCell(b,f,a)))},handleCellAddWithRowspan:function(a,f,g){var h=parseInt(d.getAttribute(this.cell,"rowspan"),10)-1,k=d.getParentElement(a.el,{query:"tr"});a=a.el.tagName.toLowerCase();for(var q,r,v=this.table.ownerDocument,u=0;u<h;u++){q=this.correctColIndexForUnreals(this.idx.col,f+u);a:{for(k=k.nextSibling;1!=k.nodeType;)if(k=k.nextSibling,"tr"==k.tagName.toLowerCase())break a;k=null}if(k)if(0<q)switch(g){case "before":r=this.getRowCells(k);0<q&&this.map[f+
		u][this.idx.col].el!=r[q]&&q==r.length-1?b(r[q],this.createCells(a,1)):r[q].parentNode.insertBefore(this.createCells(a,1),r[q]);break;case "after":b(this.getRowCells(k)[q],this.createCells(a,1))}else k.insertBefore(this.createCells(a,1),k.firstChild);else q=v.createElement("tr"),q.appendChild(this.createCells(a,1)),this.table.appendChild(q)}}};d.table={getCellsBetween:function(a,d){return(new h(a)).getMapElsTo(d)},addCells:function(a,d){(new h(a)).add(d)},removeCells:function(a,d){(new h(a)).remove(d)},
		mergeCellsBetween:function(a,d){(new h(a)).merge(d)},unmergeCell:function(a){(new h(a)).unmerge()},orderSelectionEnds:function(a,d){return(new h(a)).orderSelectionEnds(d)},indexOf:function(a){var d=new h(a);d.setTableMap();return d.getMapIndex(a)},findCell:function(a,d){return(new h(null,a)).getElementAtIndex(d)},findRowByCell:function(a){return(new h(a)).getRowElementsByCell()},findColumnByCell:function(a){return(new h(a)).getColumnElementsByCell()},canMerge:function(a,d){return(new h(a)).canMerge(d)}}})(wysihtml5);
	wysihtml5.dom.query=function(a,f){var g=[],b;a.nodeType&&(a=[a]);for(var d=0,k=a.length;d<k;d++)if(b=a[d].querySelectorAll(f))for(var h=b.length;h--;g.unshift(b[h]));return g};
	wysihtml5.dom.compareDocumentPosition=function(){return document.documentElement.compareDocumentPosition?function(a,f){return a.compareDocumentPosition(f)}:function(a,f){if(a===f)return 0;if(a===f.ownerDocument)return 20;if(a.ownerDocument===f)return 10;if((9===a.nodeType?a:a.ownerDocument)!==(9===f.nodeType?f:f.ownerDocument))return 1;if(2===a.nodeType&&a.childNodes&&-1!==wysihtml5.lang.array(a.childNodes).indexOf(f))return 20;if(2===f.nodeType&&f.childNodes&&-1!==wysihtml5.lang.array(f.childNodes).indexOf(a))return 10;
		for(var g=a,b=[],d=null;g;){if(g==f)return 10;b.push(g);g=g.parentNode}g=f;for(d=null;g;){if(g==a)return 20;var k=wysihtml5.lang.array(b).indexOf(g);if(-1!==k)return g=b[k],b=wysihtml5.lang.array(g.childNodes).indexOf(b[k-1]),d=wysihtml5.lang.array(g.childNodes).indexOf(d),b>d?2:4;d=g;g=g.parentNode}return 1}}();wysihtml5.dom.unwrap=function(a){var f=[];if(a.parentNode){for(;a.lastChild;)f.unshift(a.lastChild),wysihtml5.dom.insert(a.lastChild).after(a);a.parentNode.removeChild(a)}return f};
	wysihtml5.dom.getPastedHtml=function(a){var f;a.clipboardData&&(wysihtml5.lang.array(a.clipboardData.types).contains("text/html")?f=a.clipboardData.getData("text/html"):wysihtml5.lang.array(a.clipboardData.types).contains("text/plain")&&(f=wysihtml5.lang.string(a.clipboardData.getData("text/plain")).escapeHTML(!0,!0)));return f};
	wysihtml5.dom.getPastedHtmlWithDiv=function(a,f){var g=a.selection.getBookmark(),b=a.element.ownerDocument,d=b.createElement("DIV"),k=a.getScrollPos();b.body.appendChild(d);d.style.width="1px";d.style.height="1px";d.style.overflow="hidden";d.style.position="absolute";d.style.top=k.y+"px";d.style.left=k.x+"px";d.setAttribute("contenteditable","true");d.focus();setTimeout(function(){var b;a.selection.setBookmark(g);(b=d.innerHTML)&&/^<br\/?>$/i.test(b.trim())&&(b=!1);f(b);d.parentNode.removeChild(d)},
		0)};wysihtml5.dom.removeInvisibleSpaces=function(a){a=wysihtml5.dom.getTextNodes(a);for(var f=a.length;f--;)a[f].nodeValue=a[f].nodeValue.replace(wysihtml5.INVISIBLE_SPACE_REG_EXP,"")};
	wysihtml5.quirks.cleanPastedHTML=function(){return function(a,f){var g={color:wysihtml5.dom.getStyle("color").from(f.referenceNode),fontSize:wysihtml5.dom.getStyle("font-size").from(f.referenceNode)},b;a:{b=f.rules;var d;if(b){for(var k=0,h=b.length;k<h;k++)if(b[k].condition||(d=b[k].set),b[k].condition&&b[k].condition.test(a)){b=b[k].set;break a}b=d}else b=null}b=wysihtml5.lang.object(b||{}).clone(!0);var e,m;for(e in b.tags)if(b.tags.hasOwnProperty(e)&&b.tags[e].keep_styles)for(m in b.tags[e].keep_styles)b.tags[e].keep_styles.hasOwnProperty(m)&&
	g[m]&&(d=b.tags[e].keep_styles,k=m,h=wysihtml5.lang.string(g[m]).trim().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),d[k]=new RegExp("^((?!^"+h+"$).)*$","i"));return wysihtml5.dom.parse(a,{rules:b,cleanUp:!0,context:f.referenceNode.ownerDocument,uneditableClass:f.uneditableClass,clearInternals:!0,unjoinNbsps:!0})}}();
	wysihtml5.quirks.ensureProperClearing=function(){var a=function(){var a=this;setTimeout(function(){var g=a.innerHTML.toLowerCase();if("<p>&nbsp;</p>"==g||"<p>&nbsp;</p><p>&nbsp;</p>"==g)a.innerHTML=""},0)};return function(f){wysihtml5.dom.observe(f.element,["cut","keydown"],a)}}();
	(function(a){a.quirks.getCorrectInnerHTML=function(f){var g=f.innerHTML;if(-1===g.indexOf("%7E"))return g;f=f.querySelectorAll("[href*='~'], [src*='~']");var b,d,k,h;h=0;for(k=f.length;h<k;h++)b=f[h].href||f[h].src,d=a.lang.string(b).replace("~").by("%7E"),g=a.lang.string(g).replace(d).by(b);return g}})(wysihtml5);
	(function(a){a.quirks.redraw=function(f){a.dom.addClass(f,"wysihtml5-quirks-redraw");a.dom.removeClass(f,"wysihtml5-quirks-redraw");try{var g=f.ownerDocument;g.execCommand("italic",!1,null);g.execCommand("italic",!1,null)}catch(b){}}})(wysihtml5);
	wysihtml5.quirks.tableCellsSelection=function(a,f){function g(){if(a){var d=a.querySelectorAll("."+m);if(0<d.length)for(var e=0;e<d.length;e++)h.removeClass(d[e],m)}}function b(a){for(var d=0;d<a.length;d++)h.addClass(a[d],m)}function d(d){var k=null;(d=h.getParentElement(d.target,{query:"td, th"},!1,a))&&e.table&&e.start&&(k=h.getParentElement(d,{query:"table"},!1,a))&&k===e.table&&(g(),k=e.end,e.end=d,e.cells=h.table.getCellsBetween(e.start,d),1<e.cells.length&&f.composer.selection.deselect(),b(e.cells),
	e.end!==k&&f.fire("tableselectchange").fire("tableselectchange:composer"))}function k(e){a.removeEventListener("mousemove",d);a.removeEventListener("mouseup",k);f.fire("tableselect").fire("tableselect:composer");setTimeout(function(){a.ownerDocument.addEventListener("click",l)},0)}var h=wysihtml5.dom,e={table:null,start:null,end:null,cells:null,select:function(d,g){e.start=d;e.end=g;e.table=h.getParentElement(e.start,{query:"table"},!1,a);selectedCells=h.table.getCellsBetween(e.start,e.end);b(selectedCells);
		a.ownerDocument.addEventListener("click",l);f.fire("tableselect").fire("tableselect:composer")}},m="wysiwyg-tmp-selected-cell",l=function(d){a.ownerDocument.removeEventListener("click",l);h.getParentElement(d.target,{query:"table"},!1,a)!=e.table&&(g(),e.table=null,e.start=null,e.end=null,f.fire("tableunselect").fire("tableunselect:composer"))};a.addEventListener("mousedown",function(b){if(b=wysihtml5.dom.getParentElement(b.target,{query:"td, th"},!1,a))e.start=b,e.end=b,e.cells=[b],e.table=h.getParentElement(e.start,
		{query:"table"},!1,a),e.table&&(g(),h.addClass(b,m),a.addEventListener("mousemove",d),a.addEventListener("mouseup",k),f.fire("tableselectstart").fire("tableselectstart:composer"))});return e};
	(function(a){function f(a){var b,f;for(b in g)if(g.hasOwnProperty(b)&&(f=g[b],f.regex.test(a)))return f}var g={rgba:{regex:/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,name:"rgba"},rgb:{regex:/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,name:"rgb"},hex6:{regex:/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,name:"hex",radix:16},hex3:{regex:/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,name:"hex",radix:16}},b=function(a){return new RegExp("(^|\\s|;)"+
		a+"\\s*:\\s*[^;$]+","gi")};a.quirks.styleParser={getColorParseMethod:f,getColorFormat:function(a){return(a=f(a))?a.name:void 0},parseColor:function(d,k){var h,e,m,l;h=d;if(k){h=b(k);if(!(h=d.match(h)))return!1;h=h.pop().split(":")[1];h=a.lang.string(h).trim()}if(!(e=f(h))||!(m=h.match(e.regex)))return!1;l=e.radix||10;if(e===g.hex3)return m.shift(),m.push(1),a.lang.array(m).map(function(a,d){return 3>d?parseInt(a,l)*l+parseInt(a,l):parseFloat(a)});m.shift();m[3]||m.push(1);return a.lang.array(m).map(function(a,
																																																																																																																																		 d){return 3>d?parseInt(a,l):parseFloat(a)})},unparseColor:function(a,b){return"hex"===b?(a[0].toString(16)+a[1].toString(16)+a[2].toString(16)).toUpperCase():"hash"===b?"#"+(a[0].toString(16)+a[1].toString(16)+a[2].toString(16)).toUpperCase():"rgb"===b?"rgb("+a[0]+","+a[1]+","+a[2]+")":"rgba"===b?"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")":"csv"===b?a[0]+","+a[1]+","+a[2]+","+a[3]:a[3]&&1!==a[3]?"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")":"rgb("+a[0]+","+a[1]+","+a[2]+")"},parseFontSize:function(d){return(d=
		d.match(b("font-size")))?a.lang.string(d[d.length-1].split(":")[1]).trim():!1}}})(wysihtml5);
	(function(a){function f(a,b){for(var f=0;b!==a;)if(f++,b=b.parentNode,!b)throw Error("not a descendant of ancestor!");return f}function g(d){var b=document.createElement("span"),f=function(a){d.removeEventListener("mouseup",f);d.removeEventListener("keydown",f);d.removeEventListener("touchstart",f);d.removeEventListener("focus",f);d.removeEventListener("blur",f);d.removeEventListener("paste",e);d.removeEventListener("drop",e);d.removeEventListener("beforepaste",e);b&&b.parentNode&&b.parentNode.removeChild(b)},
		e=function(a){b&&b.parentNode&&setTimeout(f,0)};b.appendChild(document.createTextNode(a.INVISIBLE_SPACE));b.className="_wysihtml5-temp-caret-fix";b.style.display="block";b.style.minWidth="1px";b.style.height="0px";d.addEventListener("mouseup",f);d.addEventListener("keydown",f);d.addEventListener("touchstart",f);d.addEventListener("focus",f);d.addEventListener("blur",f);d.addEventListener("paste",e);d.addEventListener("drop",e);d.addEventListener("beforepaste",e);return b}var b=a.dom;a.Selection=Base.extend({constructor:function(a,
																																																																																																																																							  b,f){window.rangy.init();this.editor=a;this.composer=a.composer;this.doc=this.composer.doc;this.win=this.composer.win;this.contain=b;this.unselectableClass=f||!1},getBookmark:function(){var a=this.getRange();return a&&a.cloneRange()},setBookmark:function(a){a&&this.setSelection(a)},setBefore:function(a){var b=rangy.createRange(this.doc);b.setStartBefore(a);b.setEndBefore(a);return this.setSelection(b)},createTemporaryCaretSpaceAfter:function(d){var b=this.doc.createElement("span"),f=this.doc.createTextNode(a.INVISIBLE_SPACE),
		e=function(d){this.contain.removeEventListener("mouseup",e);this.contain.removeEventListener("keydown",l);this.contain.removeEventListener("touchstart",e);this.contain.removeEventListener("focus",e);this.contain.removeEventListener("blur",e);this.contain.removeEventListener("paste",g);this.contain.removeEventListener("drop",g);this.contain.removeEventListener("beforepaste",g);b&&b.parentNode&&(b.innerHTML=b.innerHTML.replace(a.INVISIBLE_SPACE_REG_EXP,""),/[^\s]+/.test(b.innerHTML)?(d=b.lastChild,
			a.dom.unwrap(b),this.setAfter(d)):b.parentNode.removeChild(b))}.bind(this),g=function(a){b&&b.parentNode&&setTimeout(e,0)},l=function(a){8===a.which||91===a.which||17===a.which||86===a.which&&(a.ctrlKey||a.metaKey)||e()};b.className="_wysihtml5-temp-caret-fix";b.style.position="absolute";b.style.display="block";b.style.minWidth="1px";b.style.zIndex="99999";b.appendChild(f);d.parentNode.insertBefore(b,d.nextSibling);this.setBefore(f);this.contain.addEventListener("mouseup",e);this.contain.addEventListener("keydown",
		l);this.contain.addEventListener("touchstart",e);this.contain.addEventListener("focus",e);this.contain.addEventListener("blur",e);this.contain.addEventListener("paste",g);this.contain.addEventListener("drop",g);this.contain.addEventListener("beforepaste",g);return b},setAfter:function(d,b,f){var e=this.win,g=rangy.createRange(this.doc),l=function(){var f=d.parentNode,f=f?f.childNodes[f.childNodes.length-1]:null;if(!n||f===d&&1===d.nodeType&&"block"===e.getComputedStyle(d).display)if(b){var g=this.doc.createTextNode(a.INVISIBLE_SPACE);
		d.parentNode.insertBefore(g,d.nextSibling);this.selectNode(g);setTimeout(function(){g&&g.parentNode&&g.parentNode.removeChild(g)},0)}else this.createTemporaryCaretSpaceAfter(d)}.bind(this),n;g.setStartAfter(d);g.setEndAfter(d);if(document.activeElement&&document.activeElement===this.composer.element)n=this.setSelection(g),l(),f&&f(n);else{var p=this.composer.getScrollPos();this.composer.element.focus();this.composer.setScrollPos(p);setTimeout(function(){n=this.setSelection(g);l();f&&f(n)}.bind(this),
		0)}},selectNode:function(d,f){var g=rangy.createRange(this.doc),e=d.nodeType===a.ELEMENT_NODE,m="canHaveHTML"in d?d.canHaveHTML:"IMG"!==d.nodeName,l=e?d.innerHTML:d.data,l=""===l||l===a.INVISIBLE_SPACE,n=b.getStyle("display").from(d),n="block"===n||"list-item"===n;if(l&&e&&m&&!f)try{d.innerHTML=a.INVISIBLE_SPACE}catch(p){}m?g.selectNodeContents(d):g.selectNode(d);m&&l&&e?g.collapse(n):m&&l&&(g.setStartAfter(d),g.setEndAfter(d));this.setSelection(g)},getSelectedNode:function(a){if(a&&this.doc.selection&&
		"Control"===this.doc.selection.type&&(a=this.doc.selection.createRange())&&a.length)return a.item(0);a=this.getSelection(this.doc);return a.focusNode===a.anchorNode?a.focusNode:(a=this.getRange(this.doc))?a.commonAncestorContainer:this.doc.body},fixSelBorders:function(){var a=this.getRange();if(!a.canSurroundContents())for(var b=a.commonAncestorContainer,g=f(b,a.startContainer),e=f(b,a.endContainer);!a.canSurroundContents();)g>e?(a.setStartBefore(a.startContainer),g=f(b,a.startContainer)):(a.setEndAfter(a.endContainer),
		e=f(b,a.endContainer));this.setSelection(a)},getSelectedOwnNodes:function(a){a=this.getOwnRanges();for(var b=[],f=0,e=a.length;f<e;f++)b.push(a[f].commonAncestorContainer||this.doc.body);return b},findNodesInSelection:function(d){for(var b=this.getOwnRanges(),f=[],e,g=0,l=b.length;g<l;g++)e=b[g].getNodes([1],function(e){return a.lang.array(d).contains(e.nodeName)}),f=f.concat(e);return f},filterElements:function(a){for(var b=this.getOwnRanges(),f=[],e,g=0,l=b.length;g<l;g++)e=b[g].getNodes([1],function(e){return a(e,
		b[g])}),f=f.concat(e);return f},containsUneditable:function(){for(var a=this.getOwnUneditables(),b=this.getSelection(),f=0,e=a.length;f<e;f++)if(b.containsNode(a[f]))return!0;return!1},deleteContents:function(){var d=this.getRange(),b,f,e;if(this.unselectableClass)for((b=a.dom.getParentElement(d.startContainer,{query:"."+this.unselectableClass},!1,this.contain))&&d.setStartBefore(b),(f=a.dom.getParentElement(d.endContainer,{query:"."+this.unselectableClass},!1,this.contain))&&d.setEndAfter(f),b=d.getNodes([1],
		function(d){return a.dom.hasClass(d,this.unselectableClass)}.bind(this)),f=b.length;f--;)try{e=new CustomEvent("wysihtml5:uneditable:delete"),b[f].dispatchEvent(e)}catch(g){}d.deleteContents();this.setSelection(d)},getPreviousNode:function(d,b){var f;d||(d=this.getSelection().anchorNode);if(d===this.contain)return!1;var e=d.previousSibling;if(e===this.contain)return!1;e&&3!==e.nodeType&&1!==e.nodeType?e=this.getPreviousNode(e,b):e&&3===e.nodeType&&/^\s*$/.test(e.textContent)?e=this.getPreviousNode(e,
		b):b&&e&&1===e.nodeType?(f=a.dom.getStyle("display").from(e),a.lang.array(["BR","HR","IMG"]).contains(e.nodeName)||a.lang.array(["block","inline-block","flex","list-item","table"]).contains(f)||!/^[\s]*$/.test(e.innerHTML)||(e=this.getPreviousNode(e,b))):e||d===this.contain||(f=d.parentNode,f!==this.contain&&(e=this.getPreviousNode(f,b)));return e!==this.contain?e:!1},getSelectionParentsByTag:function(d){d=this.getSelectedOwnNodes();for(var b,f=[],e=0,g=d.length;e<g;e++)(b=d[e].nodeName&&"LI"===d[e].nodeName?
		d[e]:a.dom.getParentElement(d[e],{query:"li"},!1,this.contain))&&f.push(b);return f.length?f:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var a=this.getRange(),b=a.startContainer,a=a.startOffset,f=rangy.createRange(this.doc);f.selectNodeContents(b);f.setStart(b,a);return f}},caretIsLastInSelection:function(){rangy.createRange(this.doc);this.getSelection();var a=this.getRangeToNodeEnd().cloneContents().textContent;return/^\s*$/.test(a)},caretIsFirstInSelection:function(){var d=rangy.createRange(this.doc),
		b=this.getSelection(),f=this.getRange(),e=f.startContainer;if(e){if(e.nodeType===a.TEXT_NODE)return this.isCollapsed()&&e.nodeType===a.TEXT_NODE&&/^\s*$/.test(e.data.substr(0,f.startOffset));d.selectNodeContents(this.getRange().commonAncestorContainer);d.collapse(!0);return this.isCollapsed()&&(d.startContainer===b.anchorNode||d.endContainer===b.anchorNode)&&d.startOffset===b.anchorOffset}},caretIsInTheBeginnig:function(d){var b=this.getSelection(),f=b.anchorNode,b=b.anchorOffset;if(d&&f)return 0===
		b&&(f.nodeName&&f.nodeName===d.toUpperCase()||a.dom.getParentElement(f.parentNode,{query:d},1));if(f)return 0===b&&!this.getPreviousNode(f,!0)},getBeforeSelection:function(d){var b=this.getSelection(),f=b.isBackwards()?b.focusNode:b.anchorNode,b=b.isBackwards()?b.focusOffset:b.anchorOffset,e=this.createRange(),g;if(g=a.dom.getParentElement(f,{query:"._wysihtml5-temp-caret-fix"},1))f=g.parentNode,b=Array.prototype.indexOf.call(f.childNodes,g);if(f){if(0<b){if(3===f.nodeType)return e.setStart(f,0),
		e.setEnd(f,b),{type:"text",range:e,offset:b,node:f};e.setStartBefore(f.childNodes[0]);f=f.childNodes[b-1];e.setEndAfter(f);return{type:"element",range:e,offset:b,node:f}}e.setStartAndEnd(f,0);return d&&(d=this.getPreviousNode(f,!0),g=null,d&&(g=1===d.nodeType&&a.dom.hasClass(d,this.unselectableClass)?d:a.dom.domNode(d).lastLeafNode()),g)?{type:"leafnode",range:e,offset:b,node:g}:{type:"none",range:e,offset:b,node:f}}return null},executeAndRestoreRangy:function(a,b){var f=rangy.saveSelection(this.win);
		if(f)try{a()}catch(e){setTimeout(function(){throw e;},0)}else a();rangy.restoreSelection(f)},executeAndRestore:function(d,f){var g=this.doc.body,e=f&&g.scrollTop,m=f&&g.scrollLeft,l='<span class="_wysihtml5-temp-placeholder">'+a.INVISIBLE_SPACE+"</span>",n=this.getRange(!0),p,q,r;if(n){n.collapsed||(r=n.cloneRange(),p=r.createContextualFragment(l),r.collapse(!1),r.insertNode(p),r.detach());l=n.createContextualFragment(l);n.insertNode(l);p&&(p=this.contain.querySelectorAll("._wysihtml5-temp-placeholder"),
		n.setStartBefore(p[0]),n.setEndAfter(p[p.length-1]));this.setSelection(n);try{d(n.startContainer,n.endContainer)}catch(v){setTimeout(function(){throw v;},0)}if((p=this.contain.querySelectorAll("._wysihtml5-temp-placeholder"))&&p.length)for(n=rangy.createRange(this.doc),l=p[0].nextSibling,1<p.length&&(q=p[p.length-1].previousSibling),q&&l?n.setStartBefore(l):(q=this.doc.createTextNode(a.INVISIBLE_SPACE),b.insert(q).after(p[0]),n.setStartBefore(q)),n.setEndAfter(q),this.setSelection(n),q=p.length;q--;)p[q].parentNode.removeChild(p[q]);
	else this.contain.focus();f&&(g.scrollTop=e,g.scrollLeft=m);try{p.parentNode.removeChild(p)}catch(u){}}else d(g,g)},set:function(a,b){var f=rangy.createRange(this.doc);f.setStart(a,b||0);this.setSelection(f)},insertHTML:function(a){rangy.createRange(this.doc);var b=this.doc.createElement("DIV"),f=this.doc.createDocumentFragment();b.innerHTML=a;for(a=b.lastChild;b.firstChild;)f.appendChild(b.firstChild);this.insertNode(f);a&&this.setAfter(a)},insertNode:function(a){var b=this.getRange();b&&b.insertNode(a)},
		canAppendChild:function(a){var b,f=this.getRange();(a=a||f.startContainer)&&(b=(a.tagName||a.nodeName).toLowerCase());return-1==="area base br col command embed hr img input keygen link meta param source track wbr".split(" ").indexOf(b)},splitElementAtCaret:function(d,b){var f=this.getSelection(),e,g;if(0<f.rangeCount){f=f.getRangeAt(0).cloneRange();f.setEndAfter(d);e=f.extractContents();g=e.childNodes;for(var l=g.length;l--;)a.dom.domNode(g[l]).is.visible()||e.removeChild(g[l]);d.parentNode.insertBefore(e,
			d.nextSibling);b?(e=b.firstChild||b,g=b.lastChild||b,d.parentNode.insertBefore(b,d.nextSibling),e&&g&&(f.setStartBefore(e),f.setEndAfter(g),this.setSelection(f))):(f.setStartAfter(d),f.setEndAfter(d));a.dom.domNode(d).is.visible()||(""===a.dom.getTextContent(d)?d.parentNode.removeChild(d):d.parentNode.replaceChild(this.doc.createTextNode(" "),d))}},surround:function(a){var b=this.getOwnRanges(),f,e=[];if(0==b.length)return e;for(var g=b.length;g--;){f=this.doc.createElement(a.nodeName);e.push(f);
			a.className&&(f.className=a.className);a.cssStyle&&f.setAttribute("style",a.cssStyle);try{b[g].surroundContents(f),this.selectNode(f)}catch(l){f.appendChild(b[g].extractContents()),b[g].insertNode(f)}}return e},deblockAndSurround:function(d){var b=this.doc.createElement("div"),f=rangy.createRange(this.doc),e;b.className=d.className;this.composer.commands.exec("formatBlock",d);e=this.contain.querySelectorAll("."+d.className);if(e[0])for(e[0].parentNode.insertBefore(b,e[0]),f.setStartBefore(e[0]),f.setEndAfter(e[e.length-
		1]),f=f.extractContents();f.firstChild;)if(e=f.firstChild,1==e.nodeType&&a.dom.hasClass(e,d.className)){for(;e.firstChild;)b.appendChild(e.firstChild);"BR"!==e.nodeName&&b.appendChild(this.doc.createElement("br"));f.removeChild(e)}else b.appendChild(e);else b=null;return b},scrollIntoView:function(){var d=this.doc,b=d.documentElement.scrollHeight>d.documentElement.offsetHeight,f;(f=d._wysihtml5ScrollIntoViewElement)||(f=d.createElement("span"),f.innerHTML=a.INVISIBLE_SPACE);f=d._wysihtml5ScrollIntoViewElement=
			f;if(b){this.insertNode(f);var b=f,e=0;if(b.parentNode){do e+=b.offsetTop||0,b=b.offsetParent;while(b)}b=e;f.parentNode.removeChild(f);b>=d.body.scrollTop+d.documentElement.offsetHeight-5&&(d.body.scrollTop=b)}},selectLine:function(){a.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},_selectLine_W3C:function(){var a=this.win.getSelection();a.modify("move","left","lineboundary");a.modify("extend","right","lineboundary")},toLineBoundary:function(d,
																																																																																																																																 b){b="undefined"===typeof b?!1:b;if(a.browser.supportsSelectionModify()){var f=this.win.getSelection();f.modify("extend",d,"lineboundary");b&&("left"===d?f.collapseToStart():"right"===d&&f.collapseToEnd())}},_selectLine_MSIE:function(){var a=this.doc.selection.createRange(),b=a.boundingTop,f=this.doc.body.scrollWidth,e;if(a.moveToPoint){0===b&&(e=this.doc.createElement("span"),this.insertNode(e),b=e.offsetTop,e.parentNode.removeChild(e));b+=1;for(e=-10;e<f;e+=2)try{a.moveToPoint(e,b);break}catch(g){}for(e=
																																																																																																																																																																																																																																																																  this.doc.selection.createRange();0<=f;f--)try{e.moveToPoint(f,b);break}catch(l){}a.setEndPoint("EndToEnd",e);a.select()}},getText:function(){var a=this.getSelection();return a?a.toString():""},getNodes:function(a,b){var f=this.getRange();return f?f.getNodes(Array.isArray(a)?a:[a],b):[]},getOwnNodes:function(a,b,f){for(var e=this.getOwnRanges(),g=[],l=0,n=e.length;l<n;l++)e[l]&&(f&&e[l].splitBoundaries(),g=g.concat(e[l].getNodes(Array.isArray(a)?a:[a],b)));return g},fixRangeOverflow:function(a){if(this.contain&&
			this.contain.firstChild&&a){var b=a.compareNode(this.contain);2!==b?(1===b&&a.setStartBefore(this.contain.firstChild),0===b&&a.setEndAfter(this.contain.lastChild),3===b&&(a.setStartBefore(this.contain.firstChild),a.setEndAfter(this.contain.lastChild))):this._detectInlineRangeProblems(a)&&(b=a.endContainer.previousElementSibling)&&a.setEnd(b,this._endOffsetForNode(b))}},_endOffsetForNode:function(a){var b=document.createRange();b.selectNodeContents(a);return b.endOffset},_detectInlineRangeProblems:function(a){var f=
			b.compareDocumentPosition(a.startContainer,a.endContainer);return 0==a.endOffset&&f&4},getRange:function(a){var b=this.getSelection(),b=b&&b.rangeCount&&b.getRangeAt(0);!0!==a&&this.fixRangeOverflow(b);return b},getOwnUneditables:function(){var d=b.query(this.contain,"."+this.unselectableClass),f=b.query(d,"."+this.unselectableClass);return a.lang.array(d).without(f)},getOwnRanges:function(){var a=[],b=this.getRange();b&&a.push(b);if(this.unselectableClass&&this.contain&&b){var f=this.getOwnUneditables(),
			e;if(0<f.length)for(var g=0,l=f.length;g<l;g++)for(var b=[],n=0,p=a.length;n<p;n++){if(a[n])switch(a[n].compareNode(f[g])){case 2:break;case 3:e=a[n].cloneRange();e.setEndBefore(f[g]);b.push(e);e=a[n].cloneRange();e.setStartAfter(f[g]);b.push(e);break;default:b.push(a[n])}a=b}}return a},getSelection:function(){return rangy.getSelection(this.win)},setSelection:function(a){var b=rangy.getSelection(this.win);b.setSingleRange(a);return b&&b.anchorNode&&b.focusNode?b:null},selectAll:function(){var b=this.createRange(),
			f=this.composer,h=this,e=g(this.composer.element),m=g(this.composer.element),l,n=function(){b.setStart(f.element,0);b.setEnd(f.element,f.element.childNodes.length);l=h.setSelection(b)},p=function(){return!l||l.nativeSelection&&l.nativeSelection.type&&("Caret"===l.nativeSelection.type||"None"===l.nativeSelection.type)};a.dom.removeInvisibleSpaces(this.composer.element);n();this.composer.element.firstChild&&p()&&(this.composer.element.appendChild(e),n(),p()&&(e.parentNode.removeChild(e),this.composer.element.insertBefore(m,
			this.composer.element.firstChild),n(),p()&&(this.composer.element.appendChild(e),n())))},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},getHtml:function(){return this.getSelection().toHtml()},getPlainText:function(){return this.getSelection().toString()},isEndToEndInNode:function(b){var f=this.getRange(),g=f.commonAncestorContainer,e=f.startContainer,m=f.endContainer;g.nodeType===a.TEXT_NODE&&(g=g.parentNode);if(e.nodeType===
			a.TEXT_NODE&&!/^\s*$/.test(e.data.substr(f.startOffset))||m.nodeType===a.TEXT_NODE&&!/^\s*$/.test(m.data.substr(f.endOffset)))return!1;for(;e&&e!==g;){if(e.nodeType!==a.TEXT_NODE&&!a.dom.contains(g,e)||a.dom.domNode(e).prev({ignoreBlankTexts:!0}))return!1;e=e.parentNode}for(;m&&m!==g;){if(m.nodeType!==a.TEXT_NODE&&!a.dom.contains(g,m)||a.dom.domNode(m).next({ignoreBlankTexts:!0}))return!1;m=m.parentNode}return a.lang.array(b).contains(g.nodeName)?g:!1},isInThisEditable:function(){var b=this.getSelection(),
			f=b.focusNode,b=b.anchorNode;f&&1!==f.nodeType&&(f=f.parentNode);b&&1!==b.nodeType&&(b=b.parentNode);return b&&f&&(a.dom.contains(this.composer.element,f)||this.composer.element===f)&&(a.dom.contains(this.composer.element,b)||this.composer.element===b)},deselect:function(){var a=this.getSelection();a&&a.removeAllRanges()}})})(wysihtml5);
	(function(a,f){function g(a,e,d){a.getAttribute("style")?(b(a,d),a.getAttribute("style")&&!/^\s*$/.test(a.getAttribute("style"))?a.setAttribute("style",e+";"+a.getAttribute("style")):a.setAttribute("style",e)):a.setAttribute("style",e)}function b(a,b){var e,d=[];if(a.getAttribute("style")){e=a.getAttribute("style").split(";");for(var f=e.length;f--;)e[f].match(b)||/^\s*$/.test(e[f])||d.push(e[f]);d.length?a.setAttribute("style",d.join(";")):a.removeAttribute("style")}}function d(a,b){var e=[],d=b.split(";"),
		f=a.getAttribute("style");if(f){f=f.replace(/\s/gi,"").toLowerCase();e.push(new RegExp("(^|\\s|;)"+b.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var g=d.length;0<g--;)/^\s*$/.test(d[g])||e.push(new RegExp("(^|\\s|;)"+d[g].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));
		d=0;for(g=e.length;d<g;d++)if(f.match(e[d]))return e[d]}return!1}function k(b,e,g,h){for(var k=b.length;k--;){var m;m=b[k];var l=e,n=h;m=g?d(m,g):n?a.dom.hasClass(m,n):f.dom.arrayContains(l,m.tagName.toLowerCase());if(!m)return!1}return b.length?!0:!1}function h(a,b){return f.dom.isCharacterDataNode(a)?0==b?!!a.previousSibling:b==a.length?!!a.nextSibling:!0:0<b&&b<a.childNodes.length}function e(a,b,d,g){var h;f.dom.isCharacterDataNode(b)&&(0==d?(d=f.dom.getNodeIndex(b),b=b.parentNode):d==b.length?
		(d=f.dom.getNodeIndex(b)+1,b=b.parentNode):h=f.dom.splitDataNode(b,d));if(!(h||g&&b===g)){h=b.cloneNode(!1);h.id&&h.removeAttribute("id");for(var k;k=b.childNodes[d];)h.appendChild(k);f.dom.insertAfter(h,b)}return b==a?h:e(a,h.parentNode,f.dom.getNodeIndex(h),g)}function m(b){this.firstTextNode=(this.isElementMerge=b.nodeType==a.ELEMENT_NODE)?b.lastChild:b;this.textNodes=[this.firstTextNode]}function l(a,b,e,d,f,g,h){this.tagNames=a||["span"];this.cssClass=b||(!1===b?!1:"");this.similarClassRegExp=
		e;this.cssStyle=f||"";this.similarStyleRegExp=g;this.normalize=d;this.applyToAnyTagName=!1;this.container=h}var n=/\s+/g;m.prototype={doMerge:function(){for(var a=[],b,e,d=0,f=this.textNodes.length;d<f;++d)b=this.textNodes[d],e=b.parentNode,a[d]=b.data,d&&(e.removeChild(b),e.hasChildNodes()||e.parentNode.removeChild(e));return this.firstTextNode.data=a=a.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=
		0,e=this.textNodes.length;b<e;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};l.prototype={getAncestorWithClass:function(b){for(var e;b;){if(this.cssClass)if(e=this.cssClass,b.className){var d=b.className.match(this.similarClassRegExp)||[];e=d[d.length-1]===e}else e=!1;else e=""!==this.cssStyle?!1:!0;if(b.nodeType==a.ELEMENT_NODE&&"false"!=b.getAttribute("contenteditable")&&f.dom.arrayContains(this.tagNames,b.tagName.toLowerCase())&&e)return b;b=b.parentNode}return!1},getAncestorWithStyle:function(b){for(var e;b;){if(this.cssStyle){e=
		b;var d=this.similarStyleRegExp;e.getAttribute&&e.getAttribute("style")?(e.getAttribute("style").match(d),e=e.getAttribute("style").match(d)?!0:!1):e=!1}else e=!1;if(b.nodeType==a.ELEMENT_NODE&&"false"!=b.getAttribute("contenteditable")&&f.dom.arrayContains(this.tagNames,b.tagName.toLowerCase())&&e)return b;b=b.parentNode}return!1},getMatchingAncestor:function(a){var b=this.getAncestorWithClass(a),e=!1;b?this.cssStyle&&(e="class"):(b=this.getAncestorWithStyle(a))&&(e="style");return{element:b,type:e}},
		postApply:function(a,b){for(var e=a[0],d=a[a.length-1],f=[],g,h=e,k=d,l=0,n=d.length,B,z,D=0,G=a.length;D<G;++D)B=a[D],z=null,B&&B.parentNode&&(z=this.getAdjacentMergeableTextNode(B.parentNode,!1)),z?(g||(g=new m(z),f.push(g)),g.textNodes.push(B),B===e&&(h=g.firstTextNode,l=h.length),B===d&&(k=g.firstTextNode,n=g.getLength())):g=null;d&&d.parentNode&&(e=this.getAdjacentMergeableTextNode(d.parentNode,!0))&&(g||(g=new m(d),f.push(g)),g.textNodes.push(e));if(f.length){D=0;for(G=f.length;D<G;++D)f[D].doMerge();
			b.setStart(h,l);b.setEnd(k,n)}},getAdjacentMergeableTextNode:function(b,e){var d=b.nodeType==a.TEXT_NODE,f=d?b.parentNode:b,g=e?"nextSibling":"previousSibling";if(d){if((d=b[g])&&d.nodeType==a.TEXT_NODE)return d}else if((d=f[g])&&this.areElementsMergeable(b,d))return d[e?"firstChild":"lastChild"];return null},areElementsMergeable:function(a,b){var e;if(e=f.dom.arrayContains(this.tagNames,(a.tagName||"").toLowerCase())&&f.dom.arrayContains(this.tagNames,(b.tagName||"").toLowerCase()))e=a.className.replace(n,
				" ")==b.className.replace(n," ");if(e)a:if(a.attributes.length!=b.attributes.length)e=!1;else{e=0;for(var d=a.attributes.length,g,h;e<d;++e)if(g=a.attributes[e],h=g.name,"class"!=h&&(h=b.attributes.getNamedItem(h),g.specified!=h.specified||g.specified&&g.nodeValue!==h.nodeValue)){e=!1;break a}e=!0}return e},createContainer:function(a){a=a.createElement(this.tagNames[0]);this.cssClass&&(a.className=this.cssClass);this.cssStyle&&a.setAttribute("style",this.cssStyle);return a},applyToTextNode:function(a){var b=
			a.parentNode;1==b.childNodes.length&&f.dom.arrayContains(this.tagNames,b.tagName.toLowerCase())?(this.cssClass&&(a=this.cssClass,b.className?(b.className&&(b.className=b.className.replace(this.similarClassRegExp,"")),b.className+=" "+a):b.className=a),this.cssStyle&&g(b,this.cssStyle,this.similarStyleRegExp)):(b=this.createContainer(f.dom.getDocument(a)),a.parentNode.insertBefore(b,a),b.appendChild(a))},isRemovable:function(b){return f.dom.arrayContains(this.tagNames,b.tagName.toLowerCase())&&""===
			a.lang.string(b.className).trim()&&(!b.getAttribute("style")||""===a.lang.string(b.getAttribute("style")).trim())},undoToTextNode:function(a,f,k,m){a=k?!1:!0;k=k||m;m=!1;if(!f.containsNode(k)){var l=f.cloneRange();l.selectNode(k);l.isPointInRange(f.endContainer,f.endOffset)&&h(f.endContainer,f.endOffset)&&(e(k,f.endContainer,f.endOffset,this.container),f.setEndAfter(k));l.isPointInRange(f.startContainer,f.startOffset)&&h(f.startContainer,f.startOffset)&&(k=e(k,f.startContainer,f.startOffset,this.container))}!a&&
		this.similarClassRegExp&&k.className&&(k.className=k.className.replace(this.similarClassRegExp,""));a&&this.similarStyleRegExp&&(f=k,a=this.cssStyle,m=this.similarStyleRegExp,(l=d(f,a))?(b(f,l),f="remove"):(g(f,a,m),f="change"),m="change"===f);if(this.isRemovable(k)&&!m){for(f=k.parentNode;k.firstChild;)f.insertBefore(k.firstChild,k);f.removeChild(k)}},applyToRange:function(b){for(var e,d=b.length;d--;){e=b[d].getNodes([a.TEXT_NODE]);if(!e.length)try{var f=this.createContainer(b[d].endContainer.ownerDocument);
			b[d].surroundContents(f);this.selectNode(b[d],f);break}catch(g){}b[d].splitBoundaries();e=b[d].getNodes([a.TEXT_NODE]);if(e.length){for(var h,k=0,m=e.length;k<m;++k)h=e[k],this.getMatchingAncestor(h).element||this.applyToTextNode(h);b[d].setStart(e[0],0);h=e[e.length-1];b[d].setEnd(h,h.length);this.normalize&&this.postApply(e,b[d])}}},undoToRange:function(b){for(var e,d,f,g=b.length;g--;){e=b[g].getNodes([a.TEXT_NODE]);e.length?(b[g].splitBoundaries(),e=b[g].getNodes([a.TEXT_NODE])):(e=b[g].endContainer.ownerDocument.createTextNode(a.INVISIBLE_SPACE),
			b[g].insertNode(e),b[g].selectNode(e),e=[e]);for(var h=0,k=e.length;h<k;++h)b[g].isValid()&&(d=e[h],f=this.getMatchingAncestor(d),"style"===f.type?this.undoToTextNode(d,b[g],!1,f.element):f.element&&this.undoToTextNode(d,b[g],f.element));1==k?this.selectNode(b[g],e[0]):(b[g].setStart(e[0],0),d=e[e.length-1],b[g].setEnd(d,d.length),this.normalize&&this.postApply(e,b[g]))}},selectNode:function(b,e){var d=e.nodeType===a.ELEMENT_NODE,f="canHaveHTML"in e?e.canHaveHTML:!0,g=d?e.innerHTML:e.data;if((g=""===
				g||g===a.INVISIBLE_SPACE)&&d&&f)try{e.innerHTML=a.INVISIBLE_SPACE}catch(h){}b.selectNodeContents(e);g&&d?b.collapse(!1):g&&(b.setStartAfter(e),b.setEndAfter(e))},getTextSelectedByRange:function(a,b){var e=b.cloneRange();e.selectNodeContents(a);var d=e.intersection(b),d=d?d.toString():"";e.detach();return d},isAppliedToRange:function(b){for(var e=[],d="full",f,g,h=b.length;h--;){g=b[h].getNodes([a.TEXT_NODE]);if(!g.length)return(f=this.getMatchingAncestor(b[h].startContainer).element)?{elements:[f],
			coverage:d}:!1;for(var k=0,m=g.length,l;k<m;++k)l=this.getTextSelectedByRange(g[k],b[h]),(f=this.getMatchingAncestor(g[k]).element)&&""!=l?(e.push(f),1===a.dom.getTextNodes(f,!0).length?d="full":"full"===d&&(d="inline")):f||(d="partial")}return e.length?{elements:e,coverage:d}:!1},toggleRange:function(a){var b=this.isAppliedToRange(a);b?"full"===b.coverage?this.undoToRange(a):"inline"===b.coverage?(b=k(b.elements,this.tagNames,this.cssStyle,this.cssClass),this.undoToRange(a),b||this.applyToRange(a)):
			(k(b.elements,this.tagNames,this.cssStyle,this.cssClass)||this.undoToRange(a),this.applyToRange(a)):this.applyToRange(a)}};a.selection.HTMLApplier=l})(wysihtml5,rangy);
	wysihtml5.Commands=Base.extend({constructor:function(a){this.editor=a;this.composer=a.composer;this.doc=this.composer.doc},support:function(a){return wysihtml5.browser.supportsCommand(this.doc,a)},exec:function(a,f){var g=wysihtml5.commands[a],b=wysihtml5.lang.array(arguments).get(),d=g&&g.exec,k=null;this.composer.hasPlaceholderSet()&&!wysihtml5.lang.array(["styleWithCSS","enableObjectResizing","enableInlineTableEditing"]).contains(a)&&(this.composer.element.innerHTML="",this.composer.selection.selectNode(this.composer.element));
		this.editor.fire("beforecommand:composer");if(d)b.unshift(this.composer),k=d.apply(g,b);else try{k=this.doc.execCommand(a,!1,f)}catch(h){}this.editor.fire("aftercommand:composer");return k},remove:function(a,f){var g=wysihtml5.commands[a],b=wysihtml5.lang.array(arguments).get(),d=g&&g.remove;if(d)return b.unshift(this.composer),d.apply(g,b)},state:function(a,f){var g=wysihtml5.commands[a],b=wysihtml5.lang.array(arguments).get(),d=g&&g.state;if(d)return b.unshift(this.composer),d.apply(g,b);try{return this.doc.queryCommandState(a)}catch(k){return!1}},
		stateValue:function(a){var f=wysihtml5.commands[a],g=wysihtml5.lang.array(arguments).get(),b=f&&f.stateValue;return b?(g.unshift(this.composer),b.apply(f,g)):!1}});(function(a){var f={nodeName:"B",toggle:!0};a.commands.bold={exec:function(g,b){a.commands.formatInline.exec(g,b,f)},state:function(g,b){return a.commands.formatInline.state(g,b,f)}}})(wysihtml5);
	(function(a){var f={nodeName:"A",toggle:!1};a.commands.createLink={exec:function(g,b,d){d=a.lang.object({}).merge(f).merge({attribute:d}).get();if(g.selection.isCollapsed()&&!this.state(g,b)){var k=g.doc.createTextNode(d.attribute.href);g.selection.insertNode(k);g.selection.selectNode(k)}a.commands.formatInline.exec(g,b,d)},state:function(g,b){return a.commands.formatInline.state(g,b,f)}}})(wysihtml5);
	(function(a){var f={nodeName:"A"};a.commands.removeLink={exec:function(g,b){a.commands.formatInline.remove(g,b,f)},state:function(g,b){return a.commands.formatInline.state(g,b,f)}}})(wysihtml5);(function(a){var f=/wysiwyg-font-size-[0-9a-z\-]+/g;a.commands.fontSize={exec:function(g,b,d){a.commands.formatInline.exec(g,b,{className:"wysiwyg-font-size-"+d,classRegExp:f,toggle:!0})},state:function(f,b,d){return a.commands.formatInline.state(f,b,{className:"wysiwyg-font-size-"+d})}}})(wysihtml5);
	(function(a){a.commands.fontSizeStyle={exec:function(f,g,b){b=b.size||b;/^\s*$/.test(b)||a.commands.formatInline.exec(f,g,{styleProperty:"fontSize",styleValue:b,toggle:!1})},state:function(f,g,b){return a.commands.formatInline.state(f,g,{styleProperty:"fontSize",styleValue:b||void 0})},remove:function(f,g){return a.commands.formatInline.remove(f,g,{styleProperty:"fontSize"})},stateValue:function(f,g){var b;(b=this.state(f,g))&&a.lang.object(b).isArray()&&(b=b[0]);return b&&(b=b.getAttribute("style"))?
		a.quirks.styleParser.parseFontSize(b):!1}}})(wysihtml5);(function(a){var f=/wysiwyg-color-[0-9a-z]+/g;a.commands.foreColor={exec:function(g,b,d){a.commands.formatInline.exec(g,b,{className:"wysiwyg-color-"+d,classRegExp:f,toggle:!0})},state:function(f,b,d){return a.commands.formatInline.state(f,b,{className:"wysiwyg-color-"+d})}}})(wysihtml5);
	(function(a){a.commands.foreColorStyle={exec:function(f,g,b){b&&(b=a.quirks.styleParser.parseColor("color:"+(b.color||b),"color"))&&(b=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):"rgba("+b.join(", "))+")",a.commands.formatInline.exec(f,g,{styleProperty:"color",styleValue:b}))},state:function(f,g,b){b=b?a.quirks.styleParser.parseColor("color:"+(b.color||b),"color"):null;var d;b&&(d=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):"rgba("+b.join(", "))+")");return a.commands.formatInline.state(f,g,{styleProperty:"color",
		styleValue:d})},remove:function(f,g){return a.commands.formatInline.remove(f,g,{styleProperty:"color"})},stateValue:function(f,g,b){f=this.state(f,g);g=!1;f&&a.lang.object(f).isArray()&&(f=f[0]);return f&&(f=f.getAttribute("style"))?(g=a.quirks.styleParser.parseColor(f,"color"),a.quirks.styleParser.unparseColor(g,b)):!1}}})(wysihtml5);
	(function(a){a.commands.bgColorStyle={exec:function(f,g,b){if(b=a.quirks.styleParser.parseColor("background-color:"+(b.color||b),"background-color"))b=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):"rgba("+b.join(", "))+")",a.commands.formatInline.exec(f,g,{styleProperty:"backgroundColor",styleValue:b})},state:function(f,g,b){b=b?a.quirks.styleParser.parseColor("background-color:"+(b.color||b),"background-color"):null;var d;b&&(d=(1===b[3]?"rgb("+[b[0],b[1],b[2]].join(", "):"rgba("+b.join(", "))+")");
		return a.commands.formatInline.state(f,g,{styleProperty:"backgroundColor",styleValue:d})},remove:function(f,g){return a.commands.formatInline.remove(f,g,{styleProperty:"backgroundColor"})},stateValue:function(f,g,b){f=this.state(f,g);g=!1;f&&a.lang.object(f).isArray()&&(f=f[0]);return f&&(f=f.getAttribute("style"))?(g=a.quirks.styleParser.parseColor(f,"background-color"),a.quirks.styleParser.unparseColor(g,b)):!1}}})(wysihtml5);
	(function(a){function f(b,e,d){b||(b=d.doc.createElement(e.nodeName||(d.config.useLineBreaks?"DIV":"P")),b.appendChild(d.doc.createTextNode(a.INVISIBLE_SPACE)));e.nodeName&&b.nodeName!==e.nodeName&&(b=k.renameElement(b,e.nodeName));e.classRegExp&&(b.className=b.className.replace(e.classRegExp,""));e.className&&b.classList.add(e.className);e.styleProperty&&"undefined"!==typeof e.styleValue&&(b.style[a.browser.fixStyleKey(e.styleProperty)]=e.styleValue);return b}function g(b){b=b.querySelectorAll("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote")||
		[];for(var e=b.length;e--;)b[e].nextSibling&&1===b[e].nextSibling.nodeType&&"BR"===b[e].nextSibling.nodeName||""!==(b[e].innerHTML||b[e].nodeValue||"").trim()&&b[e].parentNode.insertBefore(b[e].ownerDocument.createElement("BR"),b[e].nextSibling),a.dom.unwrap(b[e])}function b(b,e,d,k){var n,p,q,r=e?a.lang.object(e).clone(!0):null;r&&(r.nodeName=r.nodeName||d||(k.config.useLineBreaks?"DIV":"P"));var v;b.startContainer&&1===b.startContainer.nodeType&&b.startContainer===b.endContainer?b.startContainer.firstChild===
	b.startContainer.lastChild&&1===b.endOffset&&b.startContainer!==k.element&&(b.setStartBefore(b.startContainer),b.setEndAfter(b.endContainer)):b.startContainer&&1===b.startContainer.nodeType&&3===b.endContainer.nodeType?b.startContainer.firstChild===b.endContainer&&1===b.endOffset&&b.startContainer!==k.element&&b.setEndAfter(b.startContainer):b.endContainer&&1===b.endContainer.nodeType&&3===b.startContainer.nodeType?b.endContainer.firstChild===b.startContainer&&1===b.endOffset&&b.endContainer!==k.element&&
	b.setStartBefore(b.endContainer):b.startContainer&&3===b.startContainer.nodeType&&b.startContainer===b.endContainer&&b.startContainer.parentNode&&b.startContainer.parentNode.firstChild===b.startContainer&&b.endOffset==b.endContainer.length&&0===b.startOffset&&(v=b.startContainer.parentNode,v!==k.element&&(b.setStartBefore(v),b.setEndAfter(v)));b=b.cloneRange();p=b.startContainer;var u=b.extractContents();v=k.doc.createDocumentFragment();var t=r?{nodeName:r.nodeName||null,className:r.classRegExp?null:
	r.className||null,classRegExp:r.classRegExp||null,styleProperty:r.styleProperty||null}:null,t=t?a.dom.getParentElement(p,t,null,k.element):null;d=!r||"BLOCKQUOTE"===d&&r.nodeName&&"BLOCKQUOTE"===r.nodeName;if(!t){for(var t=k.element,w=p,A=null;w&&t&&w!==t;)1===w.nodeType&&w.matches(d?"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote":"h1, h2, h3, h4, h5, h6, p, pre")&&(A=w),w=w.parentNode;t=A}d=t;if(e&&e.nodeName&&"BLOCKQUOTE"===e.nodeName)e=f(null,e,k),e.appendChild(u),v.appendChild(e),e=[e];else{if(u.firstChild)for(;u.firstChild;)if(1==
		u.firstChild.nodeType&&u.firstChild.matches("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"))if(e)f(u.firstChild,e,k),u.firstChild.matches("h1, h2, h3, h4, h5, h6, p, pre")&&g(u.firstChild),v.appendChild(u.firstChild);else{g(u.firstChild);t=a.dom.unwrap(u.firstChild);w=0;for(A=t.length;w<A;w++)v.appendChild(t[w]);0<v.childNodes.length&&v.appendChild(k.doc.createElement("BR"))}else if(e){for(t=f(null,r,k);u.firstChild&&(1!==u.firstChild.nodeType||!u.firstChild.matches("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"));)1==
	u.firstChild.nodeType&&t.matches("h1, h2, h3, h4, h5, h6, p, pre")&&g(u.firstChild),t.appendChild(u.firstChild);v.appendChild(t)}else 1==u.firstChild.nodeType&&g(u.firstChild),v.appendChild(u.firstChild);else v.appendChild(f(null,e,k));e=a.lang.array(v.childNodes).get()}if(d)k.selection.splitElementAtCaret(d,v);else{r=k.element;u=p;for(p=null;u&&r&&u!==r;)1===u.nodeType&&u.matches("b, big, i, small, tt, abbr, acronym, cite, code, dfn, em, kbd, strong, samp, var, a, bdo, br, q, span, sub, sup, button, label, textarea, input, select, u")&&
	(n=u,null===p?q=p=u.cloneNode(!1):(d=u.cloneNode(!1),d.appendChild(p),p=d)),u=u.parentNode;if(p&&q&&n){if(1===v.childNodes.length){for(;v.firstChild.firstChild;)q.appendChild(v.firstChild.firstChild);v.firstChild.appendChild(p)}k.selection.splitElementAtCaret(n,v)}else b.insertNode(v)}return e}function d(b,e){var d=a.dom.getParentElement(b,{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"},null,e.element);return d?d.nodeName:null}var k=a.dom;a.commands.formatBlock={exec:function(f,e,g){var l=
		[],n,p;"string"===typeof g&&(g={nodeName:g.toUpperCase()});if(g&&g.toggle&&(n=this.state(f,e,g))){p=rangy.saveSelection(f.win);e=0;for(var q=n.length;e<q;e++){var r=n[e],v=g,u=f,t=void 0;v.styleProperty&&(r.style[a.browser.fixStyleKey(v.styleProperty)]="");v.className&&r.classList.remove(v.className);v.classRegExp&&(r.className=r.className.replace(v.classRegExp,""));null!==r.getAttribute("class")&&""===r.getAttribute("class").trim()&&r.removeAttribute("class");v.nodeName&&r.nodeName===v.nodeName&&
	((t=r.getAttribute("style"))&&""!==t.trim()?r=k.renameElement(r,u.config.useLineBreaks?"DIV":"P"):k.unwrap(r));null!==r.getAttribute("style")&&""===r.getAttribute("style").trim()&&r.removeAttribute("style")}}if(!n)for(f.selection.isCollapsed()&&((e=a.dom.getParentElement(f.selection.getOwnRanges()[0].startContainer,{query:"h1, h2, h3, h4, h5, h6, p, pre, "+(g&&g.nodeName?g.nodeName.toLowerCase():"div")},null,f.element))?(p=rangy.saveSelection(f.win),n=f.selection.createRange(),n.selectNode(e),f.selection.setSelection(n)):
	f.isEmpty()||(p=rangy.saveSelection(f.win),f.selection.selectLine())),n=f.selection.getOwnRanges(),e=n.length;e--;)l=l.concat(b(n[e],g,d(n[e].startContainer,f),f));n=f.element;g=n.querySelectorAll("h1, h2, h3, h4, h5, h6, p, pre, div, blockquote");n=n.querySelectorAll(f.config.classNames.uneditableContainer);g=a.lang.array(g).without(n);for(n=g.length;n--;)""===g[n].innerHTML.replace(/[\uFEFF]/g,"")&&g[n].parentNode.removeChild(g[n]);for(g=l.length;g--;)l[g].parentNode||l.splice(g,1);p?rangy.restoreSelection(p):
		(n=f.selection.createRange(),n.setStartBefore(l[0]),n.setEndAfter(l[l.length-1]),f.selection.setSelection(n));a.dom.removeInvisibleSpaces(f.element)},state:function(b,e,d){"string"===typeof d&&(d={query:d});e=b.selection.filterElements(function(b){return a.dom.domNode(b).test(d||{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"})}.bind(this));for(var f=b.selection.getSelectedOwnNodes(),g,p=0,q=f.length;p<q;p++)(g=k.getParentElement(f[p],d||{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"},
		null,b.element))&&-1===e.indexOf(g)&&e.push(g);return 0===e.length?!1:e}}})(wysihtml5);
	(function(a){a.commands.formatCode={exec:function(f,g,b){var d=this.state(f)[0],k,h;d?f.selection.executeAndRestore(function(){k=d.querySelector("code");a.dom.replaceWithChildNodes(d);k&&a.dom.replaceWithChildNodes(k)}):(g=f.selection.getRange(),h=g.extractContents(),d=f.doc.createElement("pre"),k=f.doc.createElement("code"),b&&(k.className=b),d.appendChild(k),k.appendChild(h),g.insertNode(d),f.selection.selectNode(d))},state:function(f){return(f=f.selection.getSelectedNode())&&f.nodeName&&"PRE"==
	f.nodeName&&f.firstChild&&f.firstChild.nodeName&&"CODE"==f.firstChild.nodeName?[f]:(f=a.dom.getParentElement(f,{query:"pre code"}))?[f.parentNode]:!1}}})(wysihtml5);
	(function(a){function f(a){return!a.getAttribute("style")||/^\s*$/.test(a.getAttribute("style"))}function g(b,e){var d,f;if(1!==b.nodeType||1!==e.nodeType||b.nodeName!==e.nodeName)return!1;d=b.className.trim().replace(/\s+/g," ").split(" ");f=e.className.trim().replace(/\s+/g," ").split(" ");if(0<a.lang.array(d).without(f).length)return!1;d=a.dom.getAttributes(b);f=a.dom.getAttributes(e);return d.length===f.length&&a.lang.object(a.lang.object(d).difference(f)).isEmpty()?!0:!1}function b(b,e){var d=
		b.ownerDocument.createElement(e&&e.nodeName||"SPAN");e.classRegExp&&(d.className=d.className.replace(e.classRegExp,""));e.className&&d.classList.add(e.className);e.styleProperty&&"undefined"!==typeof e.styleValue&&(d.style[a.browser.fixStyleKey(e.styleProperty)]=e.styleValue);if(e.attribute)if("object"===typeof e.attribute)for(var f in e.attribute)e.attribute.hasOwnProperty(f)&&d.setAttribute(f,e.attribute[f]);else"undefined"!==typeof e.attributeValue&&d.setAttribute(e.attribute,e.attributeValue);
		return d}function d(b,e){var d,g;e.className&&(!1!==e.toggle&&b.classList.contains(e.className)?b.classList.remove(e.className):b.classList.add(e.className),/^\s*$/.test(b.className)&&b.removeAttribute("class"));e.styleProperty&&(!1!==e.toggle&&b.style[a.browser.fixStyleKey(e.styleProperty)].trim().replace(/, /g,",")===e.styleValue?b.style[a.browser.fixStyleKey(e.styleProperty)]="":b.style[a.browser.fixStyleKey(e.styleProperty)]=e.styleValue);f(b)&&b.removeAttribute("style");if(e.attribute){"object"===
	typeof e.attribute?d=e.attribute:(d={},d[e.attribute]=e.attributeValue||"");var h=e.toggle,k=a.dom.getAttributes(b),l;a:{for(l in d)if(d.hasOwnProperty(l)&&(void 0===typeof k[l]||k[l]!==d[l])){l=!1;break a}l=!0}a.lang.object(k).difference(d);if(l&&!1!==h)for(g in d)d.hasOwnProperty(g)&&b.removeAttribute(g);else for(g in d)d.hasOwnProperty(g)&&b.setAttribute(g,d[g])}g=(g=e.nodeName?M[e.nodeName.toLowerCase()]||e.nodeName.toLowerCase():null)?a.dom.domNode(b).test({query:g}):!1;if(!e.nodeName||"SPAN"===
		e.nodeName||g){if(g=(!1!==e.toggle&&g||!e.nodeName&&"SPAN"===b.nodeName)&&/^\s*$/.test(b.className)&&f(b))g=a.dom.getAttributes(b),g=a.lang.object(g).isEmpty();g&&a.dom.unwrap(b)}}function k(b,e){var d=[];b.isCollapsed()||(d=d.concat(b.getOwnNodes([3],function(b){return!a.dom.domNode(b).is.emptyTextNode()},e)));return d}function h(b,e,d,f){e=f?e:{nodeName:e.nodeName||null,className:e.classRegExp?null:e.className||null,classRegExp:e.classRegExp||null,styleProperty:e.styleProperty||null};do{if(f=1===
			b.nodeType){f=b;var g=e,h=void 0;g.nodeName?(g=M[g.nodeName.toLowerCase()]||g.nodeName.toLowerCase(),f=a.dom.domNode(f).test({query:g})):(h=a.lang.object(g).clone(),h.query="b, big, i, small, tt, abbr, acronym, cite, code, dfn, em, kbd, strong, samp, var, a, bdo, br, q, span, sub, sup, button, label, textarea, input, select, u",f=a.dom.domNode(f).test(h))}if(f)return b;b=b.parentNode}while(b&&b!==d);return null}function e(b,e){var d=document.documentElement||document.body,f=d.scrollTop,g=d.scrollLeft;
		rangy.getSelection(b.win);rangy.getSelection(b.win).removeAllRanges();try{rangy.getSelection(b.win).addRange(e)}catch(h){}b.doc.activeElement&&a.dom.contains(b.element,b.doc.activeElement)||(b.element.focus(),d.scrollTop=f,d.scrollLeft=g,rangy.getSelection(b.win).addRange(e))}function m(a,b){var d=rangy.createRange(b.doc),f=a[a.length-1];a[0]&&f&&(d.setStart(a[0],0),d.setEnd(f,f.length),e(b,d))}function l(a,b,d,f){var g=rangy.createRange(a.doc);b&&(g.setStart(b,d),g.setEnd(b,"undefined"!==typeof f?
		f:d),e(a,g))}function n(a,b,e){var d=k(a.selection),f=[],g=!1,l;if(a.selection.isInThisEditable()){if(0===d.length&&a.selection.isCollapsed()){l=a.selection.getSelection().anchorNode;if(!l)return{nodes:[],partial:!1};3===l.nodeType&&(d=[l])}d.length||(l=a.selection.getOwnRanges()[0])&&(d=[l.endContainer]);for(var m=0,n=d.length;m<n;m++)(l=h(d[m],b,a.element,e))?f.push(l):g=!0}return{nodes:f,partial:g}}function p(a){var b,e;return a&&(b=a.anchorNode,e=a.anchorOffset,b&&3===b.nodeType&&0<e&&e<b.data.length)?
		(a=b.data[e-1],b=b.data[e],/\w/.test(a)&&/\w/.test(b)):!1}function q(b){var e,d,f,g;e=[];if(b&&(e=b.anchorNode,b=f=g=b.anchorOffset,d=e.ownerDocument,d=rangy.createRange(d),e&&3===e.nodeType)){for(;0<f&&/\w/.test(e.data[f-1]);)f--;for(;g<e.data.length&&/\w/.test(e.data[g]);)g++;d.setStartAndEnd(e,f,g);d.splitBoundaries();e=d.getNodes([3],function(b){return!a.dom.domNode(b).is.emptyTextNode()});return{wordOffset:b-f,range:d,textNode:e[0]}}return!1}function r(a){for(var b=a.length;b--;)if(a[b]&&a[b].parentNode){if(a[b].nextSibling&&
		g(a[b],a[b].nextSibling)){for(var e=a[b],d=a[b].nextSibling;d.firstChild;)e.appendChild(d.firstChild);d.parentNode.removeChild(d)}if(a[b].previousSibling&&g(a[b],a[b].previousSibling)){e=a[b].previousSibling;for(d=a[b];d.firstChild;)e.appendChild(d.firstChild);d.parentNode.removeChild(d)}}}function v(a,b,e){0<b.length&&m(b,a);r(n(a,e).nodes);0<b.length&&m(b,a)}function u(a,b,e,d){l(a,b,e);r(n(a,d).nodes);l(a,b,e)}function t(a,e){var d=b(a,e);a.parentNode.insertBefore(d,a);d.appendChild(a)}function w(b,
																																																																																																																																 e,f){e=h(b,f,e.element);var g;e&&(g=e.cloneNode(!1),a.dom.domNode(b).escapeParent(e,g),d(g,f))}function A(a){a="string"===typeof a?{nodeName:a}:a;a.nodeName&&(a.nodeName=a.nodeName.toUpperCase());return a}var M={b:"b, strong",strong:"b, strong",em:"em, i",i:"em, i"};a.commands.formatInline={exec:function(e,f,g){g=A(g);e.element.normalize();f=k(e.selection,!0);var l=n(e,g);if(0<l.nodes.length){var m=n(e,g,!0),r=e.selection.getSelection();if(f.length){if(m.partial||!1===g.toggle)for(m=f.length;m--;)h(f[m],
		g,e.element)&&w(f[m],e,g),h(f[m],g,e.element)||t(f[m],g);else for(m=f.length;m--;)w(f[m],e,g);v(e,f,g)}else if(!1!==g.toggle)if(p(r))f=q(r),w(f.textNode,e,g),u(e,f.textNode,f.wordOffset,g);else{if(f=e.doc.createTextNode(a.INVISIBLE_SPACE),m=l.nodes[0].cloneNode(!1),m.appendChild(f),e.selection.splitElementAtCaret(l.nodes[0],m),d(m,g),v(e,[f],g),f=e.selection.getSelection(),f.anchorNode&&f.focusNode)try{f.collapseToEnd()}catch(S){}}else for(m=l.nodes.length;m--;)d(l.nodes[m],g)}else if(l=g,g=e.selection.getSelection(),
			f.length){for(g=f.length;g--;)t(f[g],l);v(e,f,l)}else if(p(g))f=q(g),t(f.textNode,l),u(e,f.textNode,f.wordOffset,l);else if(f=e.selection.getOwnRanges()[0])l=b(f.endContainer,l),f.surroundContents(l),e.selection.selectNode(l);e.element.normalize()},remove:function(b,e,d){d=A(d);b.element.normalize();e=k(b.selection,!0);var f=n(b,d);if(0<f.nodes.length){var g,l;l=b.selection.getSelection();if(e.length){for(l=e.length;l--;)f=e[l],(g=h(f,d,b.element))&&a.dom.domNode(f).escapeParent(g);v(b,e,d)}else{e=
		l.anchorNode;g=l.anchorOffset;for(l=f.nodes.length;l--;)a.dom.unwrap(f.nodes[l]);u(b,e,g,d)}}b.element.normalize()},state:function(a,b,e){e=A(e);a=n(a,e,!0).nodes;return 0===a.length?!1:a}}})(wysihtml5);(function(a){var f={nodeName:"BLOCKQUOTE",toggle:!0};a.commands.insertBlockQuote={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);
	(function(a){a.commands.insertHTML={exec:function(a,g,b){a.commands.support(g)?a.doc.execCommand(g,!1,b):a.selection.insertHTML(b)},state:function(){return!1}}})(wysihtml5);
	(function(a){a.commands.insertImage={exec:function(f,g,b){b="object"===typeof b?b:{src:b};var d=f.doc;if((g=this.state(f))&&!b.src)f.selection.setBefore(g),b=g.parentNode,b.removeChild(g),a.dom.removeEmptyTextNodes(b),"A"!==b.nodeName||b.firstChild||(f.selection.setAfter(b),b.parentNode.removeChild(b)),a.quirks.redraw(f.element);else if(g)for(var k in b)b.hasOwnProperty(k)&&g.setAttribute("className"===k?"class":k,b[k]);else{g=d.createElement("IMG");for(var h in b)g.setAttribute("className"===h?"class":
		h,b[h]);f.selection.insertNode(g);a.browser.hasProblemsSettingCaretAfterImg()?(b=d.createTextNode(a.INVISIBLE_SPACE),f.selection.insertNode(b),f.selection.setAfter(b)):f.selection.setAfter(g)}},state:function(f){var g;if(!a.dom.hasElementWithTagName(f.doc,"IMG"))return!1;g=f.selection.getSelectedNode();if(!g)return!1;if("IMG"===g.nodeName)return g;if(g.nodeType!==a.ELEMENT_NODE)return!1;g=f.selection.getText();if(g=a.lang.string(g).trim())return!1;f=f.selection.getNodes(a.ELEMENT_NODE,function(a){return"IMG"===
		a.nodeName});return 1!==f.length?!1:f[0]}}})(wysihtml5);(function(a){var f="<br>"+(a.browser.needsSpaceAfterLineBreak()?" ":"");a.commands.insertLineBreak={exec:function(g,b){g.commands.support(b)?(g.doc.execCommand(b,!1,null),a.browser.autoScrollsToCaret()||g.selection.scrollIntoView()):g.commands.exec("insertHTML",f)},state:function(){return!1}}})(wysihtml5);
	(function(a){a.commands.insertOrderedList={exec:function(f,g){a.commands.insertList.exec(f,g,"OL")},state:function(f,g){return a.commands.insertList.state(f,g,"OL")}}})(wysihtml5);(function(a){a.commands.insertUnorderedList={exec:function(f,g){a.commands.insertList.exec(f,g,"UL")},state:function(f,g){return a.commands.insertList.state(f,g,"UL")}}})(wysihtml5);
	wysihtml5.commands.insertList=function(a){var f=function(a,b){if(a&&a.nodeName){"string"===typeof b&&(b=[b]);for(var d=b.length;d--;)if(a.nodeName===b[d])return!0}return!1},g=function(b,d,g){var h={el:null,other:!1};if(b){var k=a.dom.getParentElement(b,{query:"li"},!1,g.element),q="UL"===d?"OL":"UL";f(b,d)?h.el=b:f(b,q)?h={el:b,other:!0}:k&&(f(k.parentNode,d)?h.el=k.parentNode:f(k.parentNode,q)&&(h={el:k.parentNode,other:!0}))}h.el&&!g.element.contains(h.el)&&(h.el=null);return h},b=function(b,d,
																																																																																																																													 f){var g="UL"===d?"OL":"UL",h,q;f.selection.executeAndRestoreRangy(function(){h=k(g,f);if(h.length)for(var r=h.length;r--;)a.dom.renameElement(h[r],d.toLowerCase());else{q=k(["OL","UL"],f);for(r=q.length;r--;)a.dom.resolveList(q[r],f.config.useLineBreaks);a.dom.resolveList(b,f.config.useLineBreaks)}})},d=function(b,d,f){var g="UL"===d?"OL":"UL";f.selection.executeAndRestoreRangy(function(){for(var h=[b].concat(k(g,f)),q=h.length;q--;)a.dom.renameElement(h[q],d.toLowerCase())})},k=function(a,b){for(var d=
		b.selection.getOwnRanges(),g=[],h=d.length;h--;)g=g.concat(d[h].getNodes([1],function(b){return f(b,a)}));return g},h=function(b,d){d.selection.executeAndRestoreRangy(function(){var f="_wysihtml5-temp-"+(new Date).getTime(),g=d.selection.deblockAndSurround({nodeName:"div",className:f});g.innerHTML=g.innerHTML.replace(a.INVISIBLE_SPACE_REG_EXP,"");g&&(f=a.lang.array(["","<br>",a.INVISIBLE_SPACE]).contains(g.innerHTML),g=a.dom.convertToList(g,b.toLowerCase(),d.parent.config.classNames.uneditableContainer),
	f&&d.selection.selectNode(g.querySelector("li"),!0))})};return{exec:function(a,f,k){f=a.doc;var n="OL"===k?"insertOrderedList":"insertUnorderedList",p=a.selection.getSelectedNode(),p=g(p,k,a);p.el?p.other?d(p.el,k,a):b(p.el,k,a):a.commands.support(n)?f.execCommand(n,!1,null):h(k,a)},state:function(a,b,d){b=a.selection.getSelectedNode();a=g(b,d,a);return a.el&&!a.other?a.el:!1}}}(wysihtml5);
	(function(a){var f={nodeName:"I",toggle:!0};a.commands.italic={exec:function(g,b){a.commands.formatInline.exec(g,b,f)},state:function(g,b){return a.commands.formatInline.state(g,b,f)}}})(wysihtml5);(function(a){var f={className:"wysiwyg-text-align-center",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};a.commands.justifyCenter={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);
	(function(a){var f={className:"wysiwyg-text-align-left",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};a.commands.justifyLeft={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);
	(function(a){var f={className:"wysiwyg-text-align-right",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};a.commands.justifyRight={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);
	(function(a){var f={className:"wysiwyg-text-align-justify",classRegExp:/wysiwyg-text-align-[0-9a-z]+/g,toggle:!0};a.commands.justifyFull={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);
	(function(a){var f={styleProperty:"textAlign",styleValue:"right",toggle:!0};a.commands.alignRightStyle={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);
	(function(a){var f={styleProperty:"textAlign",styleValue:"left",toggle:!0};a.commands.alignLeftStyle={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);
	(function(a){var f={styleProperty:"textAlign",styleValue:"center",toggle:!0};a.commands.alignCenterStyle={exec:function(g,b){return a.commands.formatBlock.exec(g,"formatBlock",f)},state:function(g,b){return a.commands.formatBlock.state(g,"formatBlock",f)}}})(wysihtml5);(function(a){a.commands.redo={exec:function(a){return a.undoManager.redo()},state:function(a){return!1}}})(wysihtml5);
	(function(a){var f={nodeName:"U",toggle:!0};a.commands.underline={exec:function(g,b){a.commands.formatInline.exec(g,b,f)},state:function(g,b){return a.commands.formatInline.state(g,b,f)}}})(wysihtml5);(function(a){a.commands.undo={exec:function(a){return a.undoManager.undo()},state:function(a){return!1}}})(wysihtml5);
	(function(a){a.commands.createTable={exec:function(a,g,b){var d,k;if(b&&b.cols&&b.rows&&0<parseInt(b.cols,10)&&0<parseInt(b.rows,10)){k=b.tableStyle?'<table style="'+b.tableStyle+'">':"<table>";k+="<tbody>";for(d=0;d<b.rows;d++){k+="<tr>";for(g=0;g<b.cols;g++)k+="<td><br></td>";k+="</tr>"}a.commands.exec("insertHTML",k+"</tbody></table>")}},state:function(a,g){return!1}}})(wysihtml5);
	(function(a){a.commands.mergeTableCells={exec:function(f,g){f.tableSelection&&f.tableSelection.start&&f.tableSelection.end&&(this.state(f,g)?a.dom.table.unmergeCell(f.tableSelection.start):a.dom.table.mergeCellsBetween(f.tableSelection.start,f.tableSelection.end))},state:function(f,g){if(f.tableSelection){var b=f.tableSelection.start,d=f.tableSelection.end;if(b&&d&&b==d&&(a.dom.getAttribute(b,"colspan")&&1<parseInt(a.dom.getAttribute(b,"colspan"),10)||a.dom.getAttribute(b,"rowspan")&&1<parseInt(a.dom.getAttribute(b,
			"rowspan"),10)))return[b]}return!1}}})(wysihtml5);(function(a){a.commands.addTableCells={exec:function(f,g,b){if(f.tableSelection&&f.tableSelection.start&&f.tableSelection.end){var d=a.dom.table.orderSelectionEnds(f.tableSelection.start,f.tableSelection.end);"before"==b||"above"==b?a.dom.table.addCells(d.start,b):"after"!=b&&"below"!=b||a.dom.table.addCells(d.end,b);setTimeout(function(){f.tableSelection.select(d.start,d.end)},0)}},state:function(a,g){return!1}}})(wysihtml5);
	(function(a){a.commands.deleteTableCells={exec:function(f,g,b){if(f.tableSelection&&f.tableSelection.start&&f.tableSelection.end){g=a.dom.table.orderSelectionEnds(f.tableSelection.start,f.tableSelection.end);var d=a.dom.table.indexOf(g.start),k,h=f.tableSelection.table;a.dom.table.removeCells(g.start,b);setTimeout(function(){k=a.dom.table.findCell(h,d);k||("row"==b&&(k=a.dom.table.findCell(h,{row:d.row-1,col:d.col})),"column"==b&&(k=a.dom.table.findCell(h,{row:d.row,col:d.col-1})));k&&f.tableSelection.select(k,
		k)},0)}},state:function(a,g){return!1}}})(wysihtml5);
	(function(a){a.commands.indentList={exec:function(a,g,b){return(g=a.selection.getSelectionParentsByTag("LI"))?this.tryToPushLiLevel(g,a.selection):!1},state:function(a,g){return!1},tryToPushLiLevel:function(f,g){var b,d,k,h,e,m=!1;g.executeAndRestoreRangy(function(){for(var g=f.length;g--;)h=f[g],b="OL"===h.parentNode.nodeName?"OL":"UL",d=h.ownerDocument.createElement(b),e=(k=a.dom.domNode(h).prev({nodeTypes:[a.ELEMENT_NODE]}))?k.querySelector("ul, ol"):null,k&&(e?e.appendChild(h):(d.appendChild(h),
		k.appendChild(d)),m=!0)});return m}}})(wysihtml5);
	(function(a){a.commands.outdentList={exec:function(a,g,b){return(g=a.selection.getSelectionParentsByTag("LI"))?this.tryToPullLiLevel(g,a):!1},state:function(a,g){return!1},tryToPullLiLevel:function(f,g){var b,d,k,h,e,m=!1,l=this;g.selection.executeAndRestoreRangy(function(){for(var n=f.length;n--;)if(h=f[n],h.parentNode&&(b=h.parentNode,"OL"===b.tagName||"UL"===b.tagName)){m=!0;d=a.dom.getParentElement(b.parentNode,{query:"ol, ul"},!1,g.element);k=a.dom.getParentElement(b.parentNode,{query:"li"},
		!1,g.element);if(d&&k)h.nextSibling&&(e=l.getAfterList(b,h),h.appendChild(e)),d.insertBefore(h,k.nextSibling);else{h.nextSibling&&(e=l.getAfterList(b,h),h.appendChild(e));for(var p=h.childNodes.length;p--;)b.parentNode.insertBefore(h.childNodes[p],b.nextSibling);b.parentNode.insertBefore(document.createElement("br"),b.nextSibling);h.parentNode.removeChild(h)}0===b.childNodes.length&&b.parentNode.removeChild(b)}});return m},getAfterList:function(a,g){for(var b=document.createElement(a.nodeName);g.nextSibling;)b.appendChild(g.nextSibling);
		return b}}})(wysihtml5);(function(a){var f={nodeName:"SUB",toggle:!0};a.commands.subscript={exec:function(g,b){a.commands.formatInline.exec(g,b,f)},state:function(g,b){return a.commands.formatInline.state(g,b,f)}}})(wysihtml5);(function(a){var f={nodeName:"SUP",toggle:!0};a.commands.superscript={exec:function(g,b){a.commands.formatInline.exec(g,b,f)},state:function(g,b){return a.commands.formatInline.state(g,b,f)}}})(wysihtml5);
	(function(a){var f=a.dom;a.UndoManager=a.lang.Dispatcher.extend({constructor:function(a){this.editor=a;this.composer=a.composer;this.element=this.composer.element;this.position=0;this.historyStr=[];this.historyDom=[];this.transact();this._observe()},_observe:function(){var a=this;this.composer.sandbox.getDocument();var b;f.observe(this.element,"keydown",function(b){if(!b.altKey&&(b.ctrlKey||b.metaKey)){var f=b.keyCode,h=90===f&&b.shiftKey||89===f;90!==f||b.shiftKey?h&&(a.redo(),b.preventDefault()):
		(a.undo(),b.preventDefault())}});f.observe(this.element,"keydown",function(d){d=d.keyCode;d!==b&&(b=d,8!==d&&46!==d||a.transact())});this.editor.on("newword:composer",function(){a.transact()}).on("beforecommand:composer",function(){a.transact()})},transact:function(){var f=this.historyStr[this.position-1],b=this.composer.getValue(!1,!1),d=0<this.element.offsetWidth&&0<this.element.offsetHeight,k,h;b!==f&&(25<(this.historyStr.length=this.historyDom.length=this.position)&&(this.historyStr.shift(),this.historyDom.shift(),
		this.position--),this.position++,d&&(f=(k=this.composer.selection.getRange())&&k.startContainer?k.startContainer:this.element,d=k&&k.startOffset?k.startOffset:0,f.nodeType===a.ELEMENT_NODE?k=f:(k=f.parentNode,h=this.getChildNodeIndex(k,f)),k.setAttribute("data-wysihtml5-selection-offset",d),"undefined"!==typeof h&&k.setAttribute("data-wysihtml5-selection-node",h)),h=this.element.cloneNode(!!b),this.historyDom.push(h),this.historyStr.push(b),k&&(k.removeAttribute("data-wysihtml5-selection-offset"),
		k.removeAttribute("data-wysihtml5-selection-node")))},undo:function(){this.transact();this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return 1<this.position},redoPossible:function(){return this.position<this.historyStr.length},set:function(a){this.element.innerHTML="";for(var b=0,d=a.childNodes,f=a.childNodes.length;b<
	f;b++)this.element.appendChild(d[b].cloneNode(!0));a.hasAttribute("data-wysihtml5-selection-offset")?(b=a.getAttribute("data-wysihtml5-selection-offset"),d=a.getAttribute("data-wysihtml5-selection-node"),a=this.element):(a=this.element.querySelector("[data-wysihtml5-selection-offset]")||this.element,b=a.getAttribute("data-wysihtml5-selection-offset"),d=a.getAttribute("data-wysihtml5-selection-node"),a.removeAttribute("data-wysihtml5-selection-offset"),a.removeAttribute("data-wysihtml5-selection-node"));
		null!==d&&(a=this.getChildNodeByIndex(a,+d));this.composer.selection.set(a,b)},getChildNodeIndex:function(a,b){for(var d=0,f=a.childNodes,h=f.length;d<h;d++)if(f[d]===b)return d},getChildNodeByIndex:function(a,b){return a.childNodes[b]}})})(wysihtml5);
	wysihtml5.views.View=Base.extend({constructor:function(a,f,g){this.parent=a;this.element=f;this.config=g;this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var a=this;this.parent.on("beforeload",function(){a.parent.on("change_view",function(f){f===a.name?(a.parent.currentView=a,a.show(),setTimeout(function(){a.focus()},0)):a.hide()})})},focus:function(){if(!this.element||!this.element.ownerDocument||this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element&&
	this.element.focus()}catch(a){}},hide:function(){this.element.style.display="none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}});
	(function(a){var f=a.dom,g=a.browser;a.views.Composer=a.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(a,d,f){this.base(a,d,f);this.config.noTextarea?this.editableArea=d:this.textarea=this.parent.textarea;this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=g.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(b,d){var f=this.isEmpty()?"":a.quirks.getCorrectInnerHTML(this.element);
		!1!==b&&(f=this.parent.parse(f,!1===d?!1:!0));return f},setValue:function(a,d){d&&(a=this.parent.parse(a));try{this.element.innerHTML=a}catch(f){this.element.innerText=a}},cleanUp:function(){var a;this.selection&&(a=rangy.saveSelection(this.win));this.parent.parse(this.element);a&&rangy.restoreSelection(a)},show:function(){this.editableArea.style.display=this._displayStyle||"";this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=
		f.getStyle("display").from(this.editableArea);"none"===this._displayStyle&&(this._displayStyle=null);this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer");this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer");this.element.setAttribute("contentEditable","true")},focus:function(b){a.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear();this.base();var d=this.element.lastChild;b&&d&&this.selection&&
	("BR"===d.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},getScrollPos:function(){if(this.doc&&this.win){var a={};a.y="undefined"!==typeof this.win.pageYOffset?this.win.pageYOffset:(this.doc.documentElement||this.doc.body.parentNode||this.doc.body).scrollTop;a.x="undefined"!==typeof this.win.pageXOffset?this.win.pageXOffset:(this.doc.documentElement||this.doc.body.parentNode||this.doc.body).scrollLeft;return a}},setScrollPos:function(a){a&&
	"undefined"!==typeof a.x&&"undefined"!==typeof a.y&&this.win.scrollTo(a.x,a.y)},getTextContent:function(){return f.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var a=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(a)||""===a||"<br>"===a||"<p></p>"===a||"<p><br></p>"===
		a||this.hasPlaceholderSet()},_initContentEditableArea:function(){var a=this;this.config.noTextarea?this.sandbox=new f.ContentEditableArea(function(){a._create()},{className:this.config.classNames.sandbox},this.editableArea):(this.sandbox=new f.ContentEditableArea(function(){a._create()},{className:this.config.classNames.sandbox}),this.editableArea=this.sandbox.getContentEditable(),f.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var a=
		this;this.sandbox=new f.Sandbox(function(){a._create()},{stylesheets:this.config.stylesheets,className:this.config.classNames.sandbox});this.editableArea=this.sandbox.getIframe();var d=this.textarea.element;f.insert(this.editableArea).after(d);this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var a=document.createElement("input");a.type="hidden";a.name="_wysihtml5_mode";a.value=1;f.insert(a).after(this.textarea.element)}},_create:function(){var b=this;
		this.doc=this.sandbox.getDocument();this.win=this.sandbox.getWindow();this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body;this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=this.textarea.getValue(!0,!1));this.selection=new a.Selection(this.parent,this.element,this.config.classNames.uneditableContainer);this.commands=new a.Commands(this.parent);this.config.noTextarea||f.copyAttributes("className spellcheck title lang dir accessKey".split(" ")).from(this.textarea.element).to(this.element);
		f.addClass(this.element,this.config.classNames.composer);this.config.style&&!this.config.contentEditableMode&&this.style();this.observe();var d=this.config.name;d&&(f.addClass(this.element,d),this.config.contentEditableMode||f.addClass(this.editableArea,d));this.enable();!this.config.noTextarea&&this.textarea.element.disabled&&this.disable();(d="string"===typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&
		f.simulatePlaceholder(this.parent,this,d,this.config.classNames.placeholder);this.commands.exec("styleWithCSS",!1);this._initAutoLinking();this._initObjectResizing();this._initUndoManager();this._initLineBreaking();this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||g.isIos()||setTimeout(function(){b.focus(!0)},100);g.clearsContentEditableCorrectly()||a.quirks.ensureProperClearing(this);this.initSync&&this.config.sync&&
		this.initSync();this.config.noTextarea||this.textarea.hide();this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var b=this,d=g.canDisableAutoLinking(),k=g.doesAutoLinkingInContentEditable();d&&this.commands.exec("autoUrlDetect",!1);if(this.config.autoLink){if(!k||k&&d)this.parent.on("newword:composer",function(){if(f.getTextContent(b.element).match(f.autoLink.URL_REG_EXP)){for(var e=b.selection.getSelectedNode(),d=b.element.querySelectorAll("."+b.config.classNames.uneditableContainer),
																																																																																																							  g=!1,h=d.length;h--;)a.dom.contains(d[h],e)&&(g=!0);g||f.autoLink(e,[b.config.classNames.uneditableContainer])}}),f.observe(this.element,"blur",function(){f.autoLink(b.element,[b.config.classNames.uneditableContainer])});var h=this.sandbox.getDocument().getElementsByTagName("a"),e=f.autoLink.URL_REG_EXP,m=function(b){b=a.lang.string(f.getTextContent(b)).trim();"www."===b.substr(0,4)&&(b="http://"+b);return b};f.observe(this.element,"keydown",function(a){if(h.length){a=b.selection.getSelectedNode(a.target.ownerDocument);
		var d=f.getParentElement(a,{query:"a"},4),g;d&&(g=m(d),setTimeout(function(){var a=m(d);a!==g&&a.match(e)&&d.setAttribute("href",a)},0))}})}},_initObjectResizing:function(){this.commands.exec("enableObjectResizing",!0);if(g.supportsEvent("resizeend")){var b=["width","height"],d=b.length,k=this.element;f.observe(k,"resizeend",function(f){f=f.target||f.srcElement;var e=f.style,g=0,l;if("IMG"===f.nodeName){for(;g<d;g++)l=b[g],e[l]&&(f.setAttribute(l,parseInt(e[l],10)),e[l]="");a.quirks.redraw(k)}})}},
		_initUndoManager:function(){this.undoManager=new a.UndoManager(this.parent)},_initLineBreaking:function(){function b(a){var b=f.getParentElement(a,{query:"p, div"},2);b&&f.contains(d.element,b)&&d.selection.executeAndRestore(function(){d.config.useLineBreaks?f.replaceWithChildNodes(b):"P"!==b.nodeName&&f.renameElement(b,"p")})}var d=this;this.config.useLineBreaks||f.observe(this.element,["focus","keydown"],function(){if(d.isEmpty()){var a=d.doc.createElement("P");d.element.innerHTML="";d.element.appendChild(a);
			g.displaysCaretInEmptyContentEditableCorrectly()?d.selection.selectNode(a,!0):(a.innerHTML="<br>",d.selection.setBefore(a.firstChild))}});f.observe(this.element,"keydown",function(g){var h=g.keyCode;if(!g.shiftKey&&(h===a.ENTER_KEY||h===a.BACKSPACE_KEY)){var e=f.getParentElement(d.selection.getSelectedNode(),{query:"li, p, h1, h2, h3, h4, h5, h6"},4);e?setTimeout(function(){var g=d.selection.getSelectedNode(),k;if("LI"===e.nodeName){if(!g)return;(k=f.getParentElement(g,{query:"ul, ol, menu"},2))||
		b(g)}h===a.ENTER_KEY&&e.nodeName.match(/^H[1-6]$/)&&b(g)},0):d.config.useLineBreaks&&h===a.ENTER_KEY&&!a.browser.insertsLineBreaksOnReturn()&&(g.preventDefault(),d.commands.exec("insertLineBreak"))}})}})})(wysihtml5);
	(function(a){var f=a.dom,g=document,b=window,d=g.createElement("div"),k="background-color color cursor font-family font-size font-style font-variant font-weight line-height letter-spacing text-align text-decoration text-indent text-rendering word-break word-wrap word-spacing".split(" "),h="background-color border-collapse border-bottom-color border-bottom-style border-bottom-width border-left-color border-left-style border-left-width border-right-color border-right-style border-right-width border-top-color border-top-style border-top-width clear display float margin-bottom margin-left margin-right margin-top outline-color outline-offset outline-width outline-style padding-left padding-right padding-top padding-bottom position top left right bottom z-index vertical-align text-align -webkit-box-sizing -moz-box-sizing -ms-box-sizing box-sizing -webkit-box-shadow -moz-box-shadow -ms-box-shadow box-shadow -webkit-border-top-right-radius -moz-border-radius-topright border-top-right-radius -webkit-border-bottom-right-radius -moz-border-radius-bottomright border-bottom-right-radius -webkit-border-bottom-left-radius -moz-border-radius-bottomleft border-bottom-left-radius -webkit-border-top-left-radius -moz-border-radius-topleft border-top-left-radius width height".split(" "),
		e=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",a.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],m=function(a){if(a.setActive)try{a.setActive()}catch(e){}else{var d=a.style,h=g.documentElement.scrollTop||
			g.body.scrollTop,k=g.documentElement.scrollLeft||g.body.scrollLeft,d={position:d.position,top:d.top,left:d.left,WebkitUserSelect:d.WebkitUserSelect};f.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(a);a.focus();f.setStyles(d).on(a);b.scrollTo&&b.scrollTo(k,h)}};a.views.Composer.prototype.style=function(){var b=this,n=g.querySelector(":focus"),p=this.textarea.element,q=p.hasAttribute("placeholder"),r=q&&p.getAttribute("placeholder"),v=p.style.display,u=p.disabled,
		t;this.focusStylesHost=d.cloneNode(!1);this.blurStylesHost=d.cloneNode(!1);this.disabledStylesHost=d.cloneNode(!1);q&&p.removeAttribute("placeholder");p===n&&p.blur();p.disabled=!1;p.style.display=t="none";if(p.getAttribute("rows")&&"auto"===f.getStyle("height").from(p)||p.getAttribute("cols")&&"auto"===f.getStyle("width").from(p))p.style.display=t=v;f.copyStyles(h).from(p).to(this.editableArea).andTo(this.blurStylesHost);f.copyStyles(k).from(p).to(this.element).andTo(this.blurStylesHost);f.insertCSS(e).into(this.element.ownerDocument);
		p.disabled=!0;f.copyStyles(h).from(p).to(this.disabledStylesHost);f.copyStyles(k).from(p).to(this.disabledStylesHost);p.disabled=u;p.style.display=v;m(p);p.style.display=t;f.copyStyles(h).from(p).to(this.focusStylesHost);f.copyStyles(k).from(p).to(this.focusStylesHost);p.style.display=v;f.copyStyles(["display"]).from(p).to(this.editableArea);var w=a.lang.array(h).without(["display"]);n?n.focus():p.blur();q&&p.setAttribute("placeholder",r);this.parent.on("focus:composer",function(){f.copyStyles(w).from(b.focusStylesHost).to(b.editableArea);
			f.copyStyles(k).from(b.focusStylesHost).to(b.element)});this.parent.on("blur:composer",function(){f.copyStyles(w).from(b.blurStylesHost).to(b.editableArea);f.copyStyles(k).from(b.blurStylesHost).to(b.element)});this.parent.observe("disable:composer",function(){f.copyStyles(w).from(b.disabledStylesHost).to(b.editableArea);f.copyStyles(k).from(b.disabledStylesHost).to(b.element)});this.parent.observe("enable:composer",function(){f.copyStyles(w).from(b.blurStylesHost).to(b.editableArea);f.copyStyles(k).from(b.blurStylesHost).to(b.element)});
		return this}})(wysihtml5);
	(function(a){var f=a.dom,g=a.browser,b={66:"bold",73:"italic",85:"underline"},d=function(a,b,e){for(var d=0,f=b.length;d<f;d++)a.addEventListener(b[d],e,!1)},k=function(b,e){if(b.selection.caretIsLastInSelection()){var d=b.selection.getSelection(),f=d.anchorNode;if(f&&1===f.nodeType&&(a.dom.getParentElement(f,{query:"td, th"},!1,b.element)||e)&&(d=f.childNodes[d.anchorOffset])&&1===d.nodeType&"BR"===d.nodeName)return d.parentNode.removeChild(d),!0}return!1},h=function(b){var e=b.selection,d=e.getPreviousNode();
		if(e.caretIsFirstInSelection()&&d&&1===d.nodeType&&/block/.test(b.win.getComputedStyle(d).display)){if(/^\s*$/.test(d.textContent||d.innerText))return d.parentNode.removeChild(d),!0;if(d.lastChild){var f=d.lastChild,g=e.getSelectedNode();if(curNode=(b=a.dom.domNode(d).commonAncestor(g,b.element))?a.dom.getParentElement(g,{query:"h1, h2, h3, h4, h5, h6, p, pre, div, blockquote"},!1,b):null){for(;curNode.firstChild;)d.appendChild(curNode.firstChild);e.setAfter(f);return!0}if(3===g.nodeType)return d.appendChild(g),
			e.setAfter(f),!0}}return!1},e=function(a,b){var e=b.selection;if(e.isCollapsed())if(h(b))a.preventDefault();else if(k(b))a.preventDefault();else{var d;if((e=b.selection.getBeforeSelection(!0))&&("element"===e.type||"leafnode"===e.type)&&1===e.node.nodeType&&e.node.classList.contains(b.config.classNames.uneditableContainer)){if(!k(b,!0)){try{d=new CustomEvent("wysihtml5:uneditable:delete"),e.node.dispatchEvent(d)}catch(f){}e.node.parentNode.removeChild(e.node)}d=!0}else d=!1;d&&a.preventDefault()}else e.containsUneditable()&&
	(a.preventDefault(),e.deleteContents())},m=function(a,b,e){if(!a.selection.isCollapsed())a.selection.deleteContents();else if(a.selection.caretIsInTheBeginnig("li"))if(e){if(a.commands.exec("outdentList"))return}else if(a.commands.exec("indentList"))return;a.commands.exec("insertHTML","&emsp;")},l=function(a){this.domNodeRemovedInterval&&clearInterval(domNodeRemovedInterval);this.parent.fire("destroy:composer")},n=function(a){this.parent.fire("beforeinteraction",a).fire("beforeinteraction:composer",
		a);setTimeout(function(){this.parent.fire("interaction",a).fire("interaction:composer",a)}.bind(this),0)},p=function(a){this.parent.fire("focus",a).fire("focus:composer",a);setTimeout(function(){this.focusState=this.getValue(!1,!1)}.bind(this),0)},q=function(a){if(this.focusState!==this.getValue(!1,!1)){var b=a;"function"==typeof Object.create&&(b=Object.create(a,{type:{value:"change"}}));this.parent.fire("change",b).fire("change:composer",b)}this.parent.fire("blur",a).fire("blur:composer",a)},r=
		function(a){this.parent.fire(a.type,a).fire(a.type+":composer",a);"paste"===a.type&&setTimeout(function(){this.parent.fire("newword:composer")}.bind(this),0)},v=function(a){this.config.copyedFromMarking&&(a.clipboardData&&(a.clipboardData.setData("text/html",this.config.copyedFromMarking+this.selection.getHtml()),a.clipboardData.setData("text/plain",this.selection.getPlainText()),a.preventDefault()),this.parent.fire(a.type,a).fire(a.type+":composer",a))},u=function(b){b=b.keyCode;b!==a.SPACE_KEY&&
	b!==a.ENTER_KEY||this.parent.fire("newword:composer")},t=function(b){if(!g.canSelectImagesInContentEditable()){b=b.target;var e=this.element.querySelectorAll("img"),d=this.element.querySelectorAll("."+this.config.classNames.uneditableContainer+" img"),e=a.lang.array(e).without(d);"IMG"===b.nodeName&&a.lang.array(e).contains(b)&&this.selection.selectNode(b)}},w=function(a){var b={IMG:"Image: ",A:"Link: "};a=a.target;var e=a.nodeName;"A"!==e&&"IMG"!==e||a.hasAttribute("title")||(b=b[e]+(a.getAttribute("href")||
		a.getAttribute("src")),a.setAttribute("title",b))},A=function(b){this.config.classNames.uneditableContainer&&(b=a.dom.getParentElement(b.target,{query:"."+this.config.classNames.uneditableContainer},!1,this.element))&&this.selection.setAfter(b)},M=function(a){g.canSelectImagesInContentEditable()||setTimeout(function(){this.selection.getSelection().removeAllRanges()}.bind(this),0)},J=function(d){var f=d.keyCode,g=b[f],h;(d.ctrlKey||d.metaKey)&&65===f?(this.selection.selectAll(),d.preventDefault()):
		((d.ctrlKey||d.metaKey)&&!d.altKey&&g&&(this.commands.exec(g),d.preventDefault()),f===a.BACKSPACE_KEY&&e(d,this),(f===a.BACKSPACE_KEY||f===a.DELETE_KEY)&&(g=this.selection.getSelectedNode(!0))&&"IMG"===g.nodeName&&(d.preventDefault(),h=g.parentNode,h.removeChild(g),"A"!==h.nodeName||h.firstChild||h.parentNode.removeChild(h),setTimeout(function(){a.quirks.redraw(this.element)}.bind(this),0)),this.config.handleTabKey&&f===a.TAB_KEY&&(d.preventDefault(),m(this,this.element,d.shiftKey)))},B=function(){var b=
		function(){this.doc.execCommand("enableObjectResizing",!1,"false");this.doc.execCommand("enableInlineTableEditing",!1,"false")},e=function(){b.call(this);for(var a=this.sandbox.getIframe(),d=["focus","mouseup","mouseover"],f=e,g=0,h=d.length;g<h;g++)a.removeEventListener(d[g],f,!1)}.bind(this);this.doc.execCommand&&a.browser.supportsCommand(this.doc,"enableObjectResizing")&&a.browser.supportsCommand(this.doc,"enableInlineTableEditing")&&(this.sandbox.getIframe?d(this.sandbox.getIframe(),["focus",
		"mouseup","mouseover"],e):setTimeout(function(){b.call(this)}.bind(this),0));this.tableSelection=a.quirks.tableCellsSelection(this.element,this.parent)};a.views.Composer.prototype.observe=function(){var a=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),b=g.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?this.element:this.sandbox.getWindow();this.focusState=this.getValue(!1,!1);a.addEventListener(["DOMNodeRemoved"],l.bind(this),!1);g.supportsMutationEvents()||
	(this.domNodeRemovedInterval=setInterval(function(){f.contains(document.documentElement,a)||l.call(this)},250));this.config.handleTables&&B.call(this);d(b,["drop","paste","mouseup","focus","keyup"],n.bind(this));b.addEventListener("focus",p.bind(this),!1);b.addEventListener("blur",q.bind(this),!1);d(this.element,["drop","paste","beforepaste"],r.bind(this),!1);this.element.addEventListener("copy",v.bind(this),!1);this.element.addEventListener("mousedown",t.bind(this),!1);this.element.addEventListener("mouseover",
		w.bind(this),!1);this.element.addEventListener("click",A.bind(this),!1);this.element.addEventListener("drop",M.bind(this),!1);this.element.addEventListener("keyup",u.bind(this),!1);this.element.addEventListener("keydown",J.bind(this),!1);this.element.addEventListener("dragenter",function(){this.parent.fire("unset_placeholder")}.bind(this),!1)}})(wysihtml5);
	(function(a){a.views.Synchronizer=Base.extend({constructor:function(a,g,b){this.editor=a;this.textarea=g;this.composer=b;this._observe()},fromComposerToTextarea:function(f){this.textarea.setValue(a.lang.string(this.composer.getValue(!1,!1)).trim(),f)},fromTextareaToComposer:function(a){var g=this.textarea.getValue(!1,!1);g?this.composer.setValue(g,a):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(a){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(a):
		this.fromComposerToTextarea(a)},_observe:function(){var f,g=this,b=this.textarea.element.form,d=function(){f=setInterval(function(){g.fromComposerToTextarea()},400)},k=function(){clearInterval(f);f=null};d();b&&(a.dom.observe(b,"submit",function(){g.sync(!0)}),a.dom.observe(b,"reset",function(){setTimeout(function(){g.fromTextareaToComposer()},0)}));this.editor.on("change_view",function(a){"composer"!==a||f?"textarea"===a&&(g.fromComposerToTextarea(!0),k()):(g.fromTextareaToComposer(!0),d())});this.editor.on("destroy:composer",
		k)}})})(wysihtml5);
	(function(a){a.views.SourceView=Base.extend({constructor:function(a,g){this.editor=a;this.composer=g;this._observe()},switchToTextarea:function(a){var g=this.composer.win.getComputedStyle(this.composer.element),b=parseFloat(g.width),g=Math.max(parseFloat(g.height),100);this.textarea||(this.textarea=this.composer.doc.createElement("textarea"),this.textarea.className="wysihtml5-source-view");this.textarea.style.width=b+"px";this.textarea.style.height=g+"px";this.textarea.value=this.editor.getValue(a,!0);
		this.composer.element.parentNode.insertBefore(this.textarea,this.composer.element);this.editor.currentView="source";this.composer.element.style.display="none"},switchToComposer:function(a){var g=this.textarea.value;g?this.composer.setValue(g,a):(this.composer.clear(),this.editor.fire("set_placeholder"));this.textarea.parentNode.removeChild(this.textarea);this.editor.currentView=this.composer;this.composer.element.style.display=""},_observe:function(){this.editor.on("change_view",function(a){"composer"===
	a?this.switchToComposer(!0):"textarea"===a&&this.switchToTextarea(!0)}.bind(this))}})})(wysihtml5);
	wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(a,f,g){this.base(a,f,g);this._observe()},clear:function(){this.element.value=""},getValue:function(a){var f=this.isEmpty()?"":this.element.value;!1!==a&&(f=this.parent.parse(f));return f},setValue:function(a,f){f&&(a=this.parent.parse(a));this.element.value=a},cleanUp:function(){var a=this.parent.parse(this.element.value);this.element.value=a},hasPlaceholderSet:function(){var a=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),
		f=this.element.getAttribute("placeholder")||null,g=this.element.value;return a&&!g||g===f},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var a=this.element,f=this.parent,g={focusin:"focus",focusout:"blur"},b=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];f.on("beforeload",function(){wysihtml5.dom.observe(a,b,function(a){a=g[a.type]||a.type;f.fire(a).fire(a+":textarea")});
		wysihtml5.dom.observe(a,["paste","drop"],function(){setTimeout(function(){f.fire("paste").fire("paste:textarea")},0)})})}});
	(function(a){var f={name:void 0,style:!0,toolbar:void 0,showToolbarAfterInit:!0,showToolbarDialogsOnSelection:!0,autoLink:!0,handleTables:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},pasteParserRulesets:null,parser:a.dom.parse,useLineBreaks:!0,stylesheets:[],placeholderText:void 0,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,classNames:{composer:"wysihtml5-editor",body:"wysihtml5-supported",sandbox:"wysihtml5-sandbox",placeholder:"wysihtml5-placeholder",
		uneditableContainer:"wysihtml5-uneditable-container"},copyedFromMarking:'<meta name="copied-from" content="wysihtml5">'};a.Editor=a.lang.Dispatcher.extend({constructor:function(g,b){this.editableElement="string"===typeof g?document.getElementById(g):g;this.config=a.lang.object({}).merge(f).merge(b).get();this._isCompatible=a.browser.supported();b&&b.classNames&&a.lang.object(this.config.classNames).merge(b.classNames);"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=
		!0,this.config.noTextarea=!0);this.config.noTextarea||(this.currentView=this.textarea=new a.views.Textarea(this,this.editableElement,this.config));if(!this._isCompatible||!this.config.supportTouchDevices&&a.browser.isTouchDevice()){var d=this;setTimeout(function(){d.fire("beforeload").fire("load")},0)}else a.dom.addClass(document.body,this.config.classNames.body),this.currentView=this.composer=new a.views.Composer(this,this.editableElement,this.config),"function"===typeof this.config.parser&&this._initParser(),
		this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea?this.sourceView=new a.views.SourceView(this,this.composer):this.synchronizer=new a.views.Synchronizer(this,this.textarea,this.composer);this.config.toolbar&&(this.toolbar=new a.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit))},isCompatible:function(){return this._isCompatible},clear:function(){this.currentView.clear();return this},getValue:function(a,b){return this.currentView.getValue(a,
		b)},setValue:function(a,b){this.fire("unset_placeholder");if(!a)return this.clear();this.currentView.setValue(a,b);return this},cleanUp:function(){this.currentView.cleanUp()},focus:function(a){this.currentView.focus(a);return this},disable:function(){this.currentView.disable();return this},enable:function(){this.currentView.enable();return this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(f,b){var d=
		this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null,d=this.config.parser(f,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:d,uneditableClass:this.config.classNames.uneditableContainer,clearInternals:b});"object"===typeof f&&a.quirks.redraw(f);return d},_initParser:function(){var f;if(a.browser.supportsModernPaste())this.on("paste:composer",function(b){b.preventDefault();(f=a.dom.getPastedHtml(b))&&this._cleanAndPaste(f)}.bind(this));else this.on("beforepaste:composer",
		function(b){b.preventDefault();var d=this.composer.getScrollPos();a.dom.getPastedHtmlWithDiv(this.composer,function(a){a&&this._cleanAndPaste(a);this.composer.setScrollPos(d)}.bind(this))}.bind(this))},_cleanAndPaste:function(f){f=a.quirks.cleanPastedHTML(f,{referenceNode:this.composer.element,rules:this.config.pasteParserRulesets||[{set:this.config.parserRules}],uneditableClass:this.config.classNames.uneditableContainer});this.composer.selection.deleteContents();this.composer.selection.insertHTML(f)}})})(wysihtml5);
	(function(a){var f=a.dom;a.toolbar.Dialog=a.lang.Dispatcher.extend({constructor:function(a,b){this.link=a;this.container=b},_observe:function(){if(!this._observed){var g=this,b=function(a){var b=g._serialize();g.fire("save",b);g.hide();a.preventDefault();a.stopPropagation()};f.observe(g.link,"click",function(){f.hasClass(g.link,"wysihtml5-command-dialog-opened")&&setTimeout(function(){g.hide()},0)});f.observe(this.container,"keydown",function(d){var f=d.keyCode;f===a.ENTER_KEY&&b(d);f===a.ESCAPE_KEY&&
	g.cancel()});f.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",b);f.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(a){g.cancel();a.preventDefault();a.stopPropagation()});this._observed=!0}},_serialize:function(){for(var a={},b=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),d=b.length,f=0;f<d;f++)a[b[f].getAttribute("data-wysihtml5-dialog-field")]=b[f].value;return a},_interpolate:function(a){for(var b,d,f=document.querySelector(":focus"),
																																																																																																																								 h=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),e=h.length,m=0;m<e;m++)b=h[m],b===f||a&&"hidden"===b.type||(d=b.getAttribute("data-wysihtml5-dialog-field"),d=this.elementToChange&&"boolean"!==typeof this.elementToChange?this.elementToChange.getAttribute(d)||"":b.defaultValue,b.value=d)},update:function(a){this.elementToChange=a?a:this.elementToChange;this._interpolate()},show:function(a){var b=this.container.querySelector("input, select, textarea");this._observe();this.update(a);
		f.addClass(this.link,"wysihtml5-command-dialog-opened");this.container.style.display="";this.isOpen=!0;this.fire("show");if(b&&!a)try{b.focus()}catch(d){}},_hide:function(a){this.elementToChange=null;f.removeClass(this.link,"wysihtml5-command-dialog-opened");this.container.style.display="none";this.isOpen=!1},hide:function(){this._hide();this.fire("hide")},cancel:function(){this._hide();this.fire("cancel")}})})(wysihtml5);
	(function(a){var f=a.dom,g={position:"relative"},b={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},d={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},k={"x-webkit-speech":"",speech:""};a.toolbar.Speech=function(h,e){var m=document.createElement("input");if(a.browser.supportsSpeechApiOn(m)){var l=h.editor.textarea.element.getAttribute("lang");l&&(k.lang=l);l=document.createElement("div");
		a.lang.object(b).merge({width:e.offsetWidth+"px",height:e.offsetHeight+"px"});f.insert(m).into(l);f.insert(l).into(e);f.setStyles(d).on(m);f.setAttributes(k).on(m);f.setStyles(b).on(l);f.setStyles(g).on(e);f.observe(m,"onwebkitspeechchange"in m?"webkitspeechchange":"speechchange",function(){h.execCommand("insertText",m.value);m.value=""});f.observe(m,"click",function(a){f.hasClass(e,"wysihtml5-command-disabled")&&a.preventDefault();a.stopPropagation()})}else e.style.display="none"}})(wysihtml5);
	(function(a){function f(b,d){var f=b.commands.state(d.name,d.value);!d.dialog.multiselect&&a.lang.object(f).isArray()&&(f=1===f.length?f[0]:!0);return f}var g="wysihtml5-command-disabled",b="wysihtml5-commands-disabled",d="wysihtml5-command-active",k="wysihtml5-action-active",h=a.dom;a.toolbar.Toolbar=Base.extend({constructor:function(e,f,h){this.editor=e;this.container="string"===typeof f?document.getElementById(f):f;this.composer=e.composer;this._getLinks("command");this._getLinks("action");this._observe();
		h&&this.show();null!=e.config.classNameCommandDisabled&&(g=e.config.classNameCommandDisabled);null!=e.config.classNameCommandsDisabled&&(b=e.config.classNameCommandsDisabled);null!=e.config.classNameCommandActive&&(d=e.config.classNameCommandActive);null!=e.config.classNameActionActive&&(k=e.config.classNameActionActive);e=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]");f=e.length;for(h=0;h<f;h++)new a.toolbar.Speech(this,e[h])},_getLinks:function(b){for(var d=this[b+"Links"]=
		a.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+b+"]")).get(),f=d.length,g=0,h=this[b+"Mapping"]={},k,r,v,u,t,w;g<f;g++)k=d[g],v=k.getAttribute("data-wysihtml5-"+b),u=k.getAttribute("data-wysihtml5-"+b+"-value"),w=k.getAttribute("data-wysihtml5-"+b+"-blank-value"),r=this.container.querySelector("[data-wysihtml5-"+b+"-group='"+v+"']"),t=this._getDialog(k,v),h[v+":"+u]={link:k,group:r,name:v,value:u,tracksBlankValue:w,dialog:t,state:!1}},_getDialog:function(b,d){var f=this,g=this.container.querySelector("[data-wysihtml5-dialog='"+
		d+"']"),h,k;g&&(h=a.toolbar["Dialog_"+d]?new a.toolbar["Dialog_"+d](b,g):new a.toolbar.Dialog(b,g),h.on("show",function(){k=f.composer.selection.getBookmark();f.editor.fire("show:dialog",{command:d,dialogContainer:g,commandLink:b})}),h.on("save",function(a){k&&f.composer.selection.setBookmark(k);f._execCommand(d,a);f.editor.fire("save:dialog",{command:d,dialogContainer:g,commandLink:b});f._hideAllDialogs();f._preventInstantFocus();k=void 0}),h.on("cancel",function(){k&&f.composer.selection.setBookmark(k);
		f.editor.fire("cancel:dialog",{command:d,dialogContainer:g,commandLink:b});k=void 0;f._preventInstantFocus()}),h.on("hide",function(){f.editor.fire("hide:dialog",{command:d,dialogContainer:g,commandLink:b});k=void 0}));return h},execCommand:function(a,b){this.commandsDisabled||this._execCommand(a,b)},_execCommand:function(a,b){this.editor.focus(!1);this.composer.commands.exec(a,b);this._updateLinkStates()},execAction:function(a){var b=this.editor;"change_view"===a&&(b.currentView===b.textarea||"source"===
	b.currentView?b.fire("change_view","composer"):b.fire("change_view","textarea"));"showSource"==a&&b.fire("showSource")},_observe:function(){for(var d=this,g=this.editor,k=this.container,n=this.commandLinks.concat(this.actionLinks),p=n.length,q=0;q<p;q++)if("A"===n[q].nodeName)h.setAttributes({href:"javascript:;",unselectable:"on"}).on(n[q]);else h.setAttributes({unselectable:"on"}).on(n[q]);h.delegate(k,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(a){a.preventDefault()});
		h.delegate(k,"[data-wysihtml5-command]","click",function(a){var b;b=this.getAttribute("data-wysihtml5-command");var g=this.getAttribute("data-wysihtml5-command-value"),h=d.commandMapping[b+":"+g];g||!h.dialog?d.execCommand(b,g):(b=f(d.composer,h),h.dialog.show(b));a.preventDefault()});h.delegate(k,"[data-wysihtml5-action]","click",function(a){var b=this.getAttribute("data-wysihtml5-action");d.execAction(b);a.preventDefault()});g.on("interaction:composer",function(a){d.preventFocus||d._updateLinkStates()});
		this.container.ownerDocument.addEventListener("click",function(b){a.dom.contains(d.container,b.target)||a.dom.contains(d.composer.element,b.target)||(d._updateLinkStates(),d._preventInstantFocus())},!1);this.editor.config.handleTables&&(g.on("tableselect:composer",function(){d.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""}),g.on("tableunselect:composer",function(){d.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"}));
		g.on("change_view",function(a){setTimeout(function(){d.commandsDisabled="composer"!==a;d._updateLinkStates();d.commandsDisabled?h.addClass(k,b):h.removeClass(k,b)},0)})},_hideAllDialogs:function(){var a=this.commandMapping,b;for(b in a)a[b].dialog&&a[b].dialog.hide()},_preventInstantFocus:function(){this.preventFocus=!0;setTimeout(function(){this.preventFocus=!1}.bind(this),0)},_updateLinkStates:function(){var a,b,l,n,p=this.commandMapping,q=this.composer,r=this.actionMapping;for(a in p)if(l=p[a],
			this.commandsDisabled?(b=!1,h.removeClass(l.link,d),l.group&&h.removeClass(l.group,d),l.dialog&&l.dialog.hide()):(b=this.composer.commands.state(l.name,l.value),h.removeClass(l.link,g),l.group&&h.removeClass(l.group,g)),l.state!==b||l.tracksBlankValue)(l.state=b)?l.tracksBlankValue?h.removeClass(l.link,d):(h.addClass(l.link,d),l.group&&h.addClass(l.group,d),!l.dialog||"undefined"!==typeof l.value&&null!==l.value||(b&&"object"===typeof b?(b=f(q,l),l.state=b,n=l.dialog.container.dataset?l.dialog.container.dataset.showdialogonselection:
		!1,q.config.showToolbarDialogsOnSelection||n?l.dialog.show(b):l.dialog.update(b)):l.dialog.hide())):l.tracksBlankValue?h.addClass(l.link,d):(h.removeClass(l.link,d),l.group&&h.removeClass(l.group,d),l.dialog&&!l.value&&l.dialog.hide());for(a in r)b=r[a],"change_view"===b.name&&(b.state=this.editor.currentView===this.editor.textarea||"source"===this.editor.currentView,b.state?h.addClass(b.link,k):h.removeClass(b.link,k))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display=
		"none"}})})(wysihtml5);(function(a){a.toolbar.Dialog_createTable=a.toolbar.Dialog.extend({show:function(a){this.base(a)}})})(wysihtml5);
	(function(a){a.toolbar.Dialog_foreColorStyle=a.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var a={},g=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),b=g.length,d=0;d<b;d++)a[g[d].getAttribute("data-wysihtml5-dialog-field")]=g[d].value;return a},_interpolate:function(f){for(var g,b,d=a.quirks.styleParser,k=document.querySelector(":focus"),h=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),e=h.length,m=0,l=(g=(g=this.elementToChange?a.lang.object(this.elementToChange).isArray()?
		this.elementToChange[0]:this.elementToChange:null)?g.getAttribute("style"):null)?d.parseColor(g,"color"):null;m<e;m++)g=h[m],g===k||f&&"hidden"===g.type||"color"!==g.getAttribute("data-wysihtml5-dialog-field")||(b=(g.dataset.colormode||"rgb").toLowerCase(),b="hex"===b?"hash":b,g.value=l?d.unparseColor(l,b):d.unparseColor([0,0,0],b))}})})(wysihtml5);
	(function(a){a.toolbar.Dialog_fontSizeStyle=a.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(f){f=document.querySelector(":focus");var g=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),b=this.elementToChange?a.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,b=(b=b?b.getAttribute("style"):null)?a.quirks.styleParser.parseFontSize(b):
		null;g&&g!==f&&b&&!/^\s*$/.test(b)&&(g.value=b)}})})(wysihtml5);

	return wysihtml5;
}

window.addEventListener("load", init);
document.readyState === "complete" && init();

})();
